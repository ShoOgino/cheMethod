  /** {@inheritDoc} */
  @Override
  public void onUploadClicked() {
    String host = view.getHost();
    if (host.isEmpty()) {
      view.setMessage(constant.hostValidationError());
      return;
    }
    view.setEncoding(FormPanel.ENCODING_MULTIPART);

    StringBuilder queryParametersBuilder = new StringBuilder();

    String csrfToken = appContext.getProperties().get("X-CSRF-Token");
    if (!isNullOrEmpty(csrfToken)) {
      queryParametersBuilder.append("&X-CSRF-Token=").append(csrfToken);
    }

    securityTokenProvider
        .getSecurityToken()
        .then(
            token -> {
              String action = restContext + "/ssh";
              if (!isNullOrEmpty(token)) {
                queryParametersBuilder.append("&token=").append(token);
              }

              String queryParameters = queryParametersBuilder.toString();
              if (!isNullOrEmpty(queryParameters)) {
                action += queryParameters.replaceFirst("&", "?");
              }

              view.setAction(action);
              view.submit();
            });
  }

