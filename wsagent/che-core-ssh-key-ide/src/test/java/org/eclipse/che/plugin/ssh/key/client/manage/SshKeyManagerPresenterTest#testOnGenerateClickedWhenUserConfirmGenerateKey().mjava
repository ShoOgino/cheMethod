  @Test
  public void testOnGenerateClickedWhenUserConfirmGenerateKey() {
    when(dialogFactory.createInputDialog(
            anyString(), anyString(), (InputCallback) anyObject(), (CancelCallback) anyObject()))
        .thenReturn(inputDialog);

    presenter.onGenerateClicked();

    verify(dialogFactory)
        .createInputDialog(
            anyString(), anyString(), inputCallbackCaptor.capture(), (CancelCallback) anyObject());
    InputCallback inputCallback = inputCallbackCaptor.getValue();
    inputCallback.accepted(GITHUB_HOST);

    verify(service)
        .generatePair(Matchers.eq(SshKeyManagerPresenter.VCS_SSH_SERVICE), eq(GITHUB_HOST));
  }

