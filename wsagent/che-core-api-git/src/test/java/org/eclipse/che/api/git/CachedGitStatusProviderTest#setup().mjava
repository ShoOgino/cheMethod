  @BeforeMethod
  public void setup() throws Exception {
    when(projectManager.getClosest(anyString())).thenReturn(Optional.of(registeredProject));
    String projectName = projectPath.getName(projectPath.getNameCount() - 1).toString();
    when(registeredProject.getPath()).thenReturn("/" + projectName);
    when(registeredProject.getName()).thenReturn(projectName);
    Path path = mock(Path.class);
    when(path.toString()).thenReturn(projectPath.toString());
    when(pathTransformer.transform("/" + projectName)).thenReturn(path);
    when(gitConnectionFactory.getConnection(projectPath.toString())).thenReturn(gitConnection);
    when(gitConnection.status(singletonList(NORMALIZED_PATH))).thenReturn(statusDto);
    when(rootDirPathProvider.get()).thenReturn("/" + projectPath.subpath(0, 2).toString());

    gitStatusProvider =
        new CachedGitStatusProvider(
            gitConnectionFactory,
            pathTransformer,
            projectManager,
            rootDirPathProvider,
            eventService);
  }

