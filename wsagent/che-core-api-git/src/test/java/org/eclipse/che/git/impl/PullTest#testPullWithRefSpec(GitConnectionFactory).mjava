  @Test(
    dataProvider = "GitConnectionFactory",
    dataProviderClass = GitConnectionFactoryProvider.class
  )
  public void testPullWithRefSpec(GitConnectionFactory connectionFactory)
      throws ServerException, URISyntaxException, IOException, UnauthorizedException {
    // given
    // create new repository clone of default
    GitConnection connection = connectToGitRepositoryWithContent(connectionFactory, repository);
    GitConnection connection2 = connectionFactory.getConnection(remoteRepo.getAbsolutePath());

    connection2.clone(CloneParams.create(connection.getWorkingDir().getAbsolutePath()));
    // add new branch
    connection.checkout(CheckoutParams.create("b1").withCreateNew(true));
    addFile(connection, "newfile1", "new file1 content");
    connection.add(AddParams.create(singletonList(".")));
    connection.commit(CommitParams.create("Test commit"));
    int branchesBefore = connection2.branchList(null).size();
    // when
    connection2.pull(
        PullParams.create("origin").withRefSpec("refs/heads/b1:refs/heads/b1").withTimeout(-1));
    int branchesAfter = connection2.branchList(null).size();
    assertEquals(branchesAfter, branchesBefore + 1);
  }

