  @Test(
    dataProvider = "GitConnectionFactory",
    dataProviderClass = org.eclipse.che.git.impl.GitConnectionFactoryProvider.class
  )
  public void testDiffNameOnlyWithCommits(GitConnectionFactory connectionFactory)
      throws GitException, IOException {
    //given
    GitConnection connection = connectToInitializedGitRepository(connectionFactory, repository);
    makeCommitInMaster(connection);

    connection.add(AddParams.create(singletonList("aaa")));
    connection.rm(RmParams.create(singletonList("README.txt")));
    connection.commit(CommitParams.create("testDiffNameStatusWithCommits"));

    //when
    List<String> diff =
        readDiff(
            DiffParams.create()
                .withFileFilter(null)
                .withType(DiffType.NAME_ONLY)
                .withNoRenames(false)
                .withRenameLimit(0)
                .withCommitA("HEAD^1")
                .withCommitB("HEAD"),
            connection);

    //then
    assertEquals(diff.size(), 2);
    assertTrue(diff.contains("README.txt"));
    assertTrue(diff.contains("aaa"));
  }

