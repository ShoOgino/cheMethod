  @Test(
    dataProvider = "GitConnectionFactory",
    dataProviderClass = org.eclipse.che.git.impl.GitConnectionFactoryProvider.class
  )
  public void testCommitWithAddAll(GitConnectionFactory connectionFactory)
      throws GitException, IOException {
    //given
    GitConnection connection = connectToInitializedGitRepository(connectionFactory, repository);
    addFile(connection, "README.txt", CONTENT);
    connection.add(AddParams.create(ImmutableList.of("README.txt")));
    connection.commit(CommitParams.create("Initial addd"));

    //when
    //change existing README
    addFile(connection, "README.txt", "not secret");

    //then
    CommitParams commitParams =
        CommitParams.create("Other commit message").withAmend(false).withAll(true);
    Revision revision = connection.commit(commitParams);
    assertEquals(revision.getMessage(), commitParams.getMessage());
  }

