  @Test(
      dataProvider = "GitConnectionFactory",
      dataProviderClass = org.eclipse.che.git.impl.GitConnectionFactoryProvider.class,
      expectedExceptions = GitException.class,
      expectedExceptionsMessageRegExp = "A branch named 'new' exists in more than one remote repos")
  public void shouldThrowExceptionIfTheBranchIsPresentInSeveralRemotes(
      GitConnectionFactory connectionFactory)
      throws GitException, IOException, UnauthorizedException {
    // given
    GitConnection connection = connectToInitializedGitRepository(connectionFactory, repository);

    GitConnection remote1 = connectToGitRepositoryWithContent(connectionFactory, repository1);
    remote1.checkout(CheckoutParams.create("new").withCreateNew(true));

    GitConnection remote2 = connectToGitRepositoryWithContent(connectionFactory, repository2);
    remote2.checkout(CheckoutParams.create("new").withCreateNew(true));

    connection.remoteAdd(
        RemoteAddParams.create("origin", remote1.getWorkingDir().getAbsolutePath()));
    connection.remoteAdd(RemoteAddParams.create("aaa", remote2.getWorkingDir().getAbsolutePath()));

    connection.fetch(FetchParams.create("origin"));
    connection.fetch(FetchParams.create("aaa"));

    // when
    connection.checkout(CheckoutParams.create("new"));
  }

