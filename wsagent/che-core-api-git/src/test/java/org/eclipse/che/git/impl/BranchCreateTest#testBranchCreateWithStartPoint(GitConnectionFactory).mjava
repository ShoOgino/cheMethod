  @Test(
      dataProvider = "GitConnectionFactory",
      dataProviderClass = org.eclipse.che.git.impl.GitConnectionFactoryProvider.class)
  public void testBranchCreateWithStartPoint(GitConnectionFactory connectionFactory)
      throws GitException, IOException {
    // given
    GitConnection connection = connectToInitializedGitRepository(connectionFactory, repository);
    addFile(connection, "newfile1", "file 1 content");
    connection.add(AddParams.create(singletonList(".")));
    connection.commit(CommitParams.create("Commit message"));

    // change content
    addFile(connection, "newfile1", "new file 1 content");
    connection.commit(CommitParams.create("Commit message").withAll(true));

    // get list of master branch commits
    List<Revision> revCommitList = connection.log(LogParams.create()).getCommits();
    int beforeCheckoutCommitsCount = revCommitList.size();

    // when
    // create new branch to 2nd commit
    Branch branch = connection.branchCreate("new-branch", revCommitList.get(1).getId());
    // then
    connection.checkout(CheckoutParams.create(branch.getDisplayName()));

    int afterCheckoutCommitsCount = connection.log(LogParams.create()).getCommits().size();
    assertEquals(afterCheckoutCommitsCount, beforeCheckoutCommitsCount - 1);
  }

