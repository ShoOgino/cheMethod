    @Test(dataProvider = "GitConnectionFactory", dataProviderClass = org.eclipse.che.git.impl.GitConnectionFactoryProvider.class,
          expectedExceptions = GitException.class)
    public void testCommitWithNotStagedChanges(GitConnectionFactory connectionFactory) throws GitException, IOException {
        //given
        GitConnection connection = connectToGitRepositoryWithContent(connectionFactory, repository);
        //Prepare unstaged deletion
        addFile(connection, "FileToDelete.txt", "content");
        connection.add(newDto(AddRequest.class).withFilepattern(ImmutableList.of("FileToDelete.txt")));
        connection.commit(newDto(CommitRequest.class).withMessage("File to delete"));
        new File(connection.getWorkingDir().getAbsolutePath(), "FileToDelete.txt").delete();
        //Prepare unstaged new file
        addFile(connection, "newFile", "content");
        //Prepare unstaged editing
        write(new File(connection.getWorkingDir(), "README.txt").toPath(), "new content".getBytes());

        //when
        connection.commit(newDto(CommitRequest.class)).withMessage("test commit");
    }

