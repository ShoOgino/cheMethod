  @Test(
    dataProvider = "GitConnectionFactory",
    dataProviderClass = org.eclipse.che.git.impl.GitConnectionFactoryProvider.class,
    expectedExceptions = GitException.class,
    expectedExceptionsMessageRegExp = "No changes added to commit"
  )
  public void testCommitWithNotStagedChanges(GitConnectionFactory connectionFactory)
      throws GitException, IOException {
    //given
    GitConnection connection = connectToGitRepositoryWithContent(connectionFactory, repository);
    //Prepare unstaged deletion
    addFile(connection, "FileToDelete.txt", "content");
    connection.add(AddParams.create(ImmutableList.of("FileToDelete.txt")));
    connection.commit(CommitParams.create("File to delete"));
    new File(connection.getWorkingDir().getAbsolutePath(), "FileToDelete.txt").delete();
    //Prepare unstaged new file
    addFile(connection, "newFile", "content");
    //Prepare unstaged editing
    write(new File(connection.getWorkingDir(), "README.txt").toPath(), "new content".getBytes());

    //when
    connection.commit(CommitParams.create("test commit"));
  }

