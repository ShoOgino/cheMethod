  @Test(
    dataProvider = "GitConnectionFactory",
    dataProviderClass = org.eclipse.che.git.impl.GitConnectionFactoryProvider.class
  )
  public void testPushRemote(GitConnectionFactory connectionFactory)
      throws GitException, IOException, URISyntaxException, UnauthorizedException {
    // given
    GitConnection connection = connectToInitializedGitRepository(connectionFactory, repository);
    GitConnection remoteConnection =
        connectToInitializedGitRepository(connectionFactory, remoteRepo);
    addFile(connection, "README", "README");
    connection.add(AddParams.create(singletonList(".")));
    connection.commit(CommitParams.create("Init commit."));
    // make push
    int branchesBefore = remoteConnection.branchList(null).size();
    // when
    connection.push(
        PushParams.create(remoteRepo.getAbsolutePath())
            .withRefSpec(singletonList("refs/heads/master:refs/heads/test"))
            .withTimeout(-1));
    // then
    int branchesAfter = remoteConnection.branchList(null).size();
    assertEquals(branchesAfter - 1, branchesBefore);
  }

