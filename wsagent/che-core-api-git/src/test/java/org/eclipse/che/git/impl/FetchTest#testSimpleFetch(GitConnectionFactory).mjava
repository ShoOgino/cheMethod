  @Test(
    dataProvider = "GitConnectionFactory",
    dataProviderClass = GitConnectionFactoryProvider.class
  )
  public void testSimpleFetch(GitConnectionFactory connectionFactory)
      throws ServerException, IOException, UnauthorizedException, URISyntaxException {

    // given
    GitConnection connection = connectToInitializedGitRepository(connectionFactory, repository);
    GitConnection fetchConnection =
        connectionFactory.getConnection(fetchTestRepo.getAbsolutePath());

    addFile(connection, "README", "readme content");
    connection.add(AddParams.create(singletonList(".")));
    connection.commit(CommitParams.create("fetch test"));
    // clone default repo into fetchRepo
    fetchConnection.clone(
        CloneParams.create(connection.getWorkingDir().getAbsolutePath())
            .withWorkingDir(fetchConnection.getWorkingDir().getAbsolutePath()));

    // add new File into defaultRepository
    addFile(connection, "newfile1", "newfile1 content");
    // add file to index and make commit
    connection.add(AddParams.create(singletonList(".")));
    connection.commit(CommitParams.create("fetch test"));

    // when
    fetchConnection.fetch(FetchParams.create(repository.getAbsolutePath()));

    // then
    // make merge with FETCH_HEAD
    fetchConnection.merge("FETCH_HEAD");
    assertTrue(new File(fetchTestRepo, "newfile1").exists());
  }

