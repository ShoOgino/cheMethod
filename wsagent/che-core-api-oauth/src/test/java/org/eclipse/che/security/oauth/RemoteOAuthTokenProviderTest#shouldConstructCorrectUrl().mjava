  @Test
  public void shouldConstructCorrectUrl() throws Exception {
    // given
    OAuthToken expected = DtoFactory.newDto(OAuthToken.class).withScope("scope").withToken("token");
    when(httpJsonResponse.asDto(any(Class.class))).thenReturn(expected);
    when(httpJsonRequest.request()).thenReturn(httpJsonResponse);
    // when
    tokenProvider.getToken("google", "id");
    // then
    ArgumentCaptor<Link> argumentCaptor = ArgumentCaptor.forClass(Link.class);
    verify(httpJsonRequestFactory).fromLink(argumentCaptor.capture());
    Link link = argumentCaptor.getValue();
    assertEquals(link.getMethod(), "GET");
    assertEquals(link.getHref(), "http://dev.box.com/api/oauth/token?oauth_provider=google");
    assertEquals(link.getParameters().size(), 0);
  }

