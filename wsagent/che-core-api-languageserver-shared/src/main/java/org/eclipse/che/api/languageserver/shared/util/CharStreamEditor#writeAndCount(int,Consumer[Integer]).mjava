  private void writeAndCount(int ch, Consumer<Integer> dest) {
    dest.accept(ch);
    if (ch == '\r') {
      // we recognize \r\n, \n
    } else if (ch == '\n') {
      currentWriteLine++;
      currentWriteChar = 0;
    } else {
      currentWriteChar++;
    }
  }

