  private boolean readLine() throws IOException {
    currentLineStart = nextLineStart;
    StringBuilder buf = new StringBuilder();
    int ch = in.read();
    nextLineStart++;
    while (ch >= 0 && ch != '\n') {
      if (ch != '\r') {
        buf.append((char) ch);
      }
      ch = in.read();
      nextLineStart++;
    }
    currentLine = buf.toString();
    currentLineIndex++;
    return ch == -1;
  }

