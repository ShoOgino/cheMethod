  @Override
  public ServerCapabilities getCapabilities(String fileUri) throws LanguageServerException {
    return getApplicableLanguageServers(fileUri)
        .stream()
        .flatMap(Collection::stream)
        .map(s -> s.getInitializeResult().getCapabilities())
        .reduce(
            null,
            (left, right) ->
                left == null ? right : new ServerCapabilitiesOverlay(left, right).compute());
  }

