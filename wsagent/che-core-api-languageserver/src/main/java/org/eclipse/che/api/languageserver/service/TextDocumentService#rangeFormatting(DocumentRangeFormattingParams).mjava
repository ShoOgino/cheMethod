    private List<TextEditDto> rangeFormatting(DocumentRangeFormattingParams documentRangeFormattingParams) {
        try {
            String uri = prefixURI(documentRangeFormattingParams.getTextDocument().getUri());
            documentRangeFormattingParams.getTextDocument().setUri(uri);
            InitializedLanguageServer server = languageServerRegistry.getApplicableLanguageServers(uri).stream().flatMap(Collection::stream)
                            .filter(s -> truish(s.getInitializeResult().getCapabilities().getDocumentRangeFormattingProvider())).findFirst()
                            .get();
            return server == null ? Collections.emptyList()
                            : server.getServer().getTextDocumentService().rangeFormatting(documentRangeFormattingParams).get().stream()
                                            .map(TextEditDto::new).collect(Collectors.toList());
        } catch (InterruptedException | ExecutionException | LanguageServerException e) {
            throw new JsonRpcException(-27000, e.getMessage());
        }
    }

