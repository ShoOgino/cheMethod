    private ServerCapabilities compute() {

      ServerCapabilities result = new ServerCapabilities();
      result.setCodeActionProvider(or(ServerCapabilities::getCodeActionProvider));
      result.setCodeLensProvider(getCodeLensProvider());
      result.setCompletionProvider(getCompletionProvider());
      result.setDefinitionProvider(or(ServerCapabilities::getDefinitionProvider));
      result.setDocumentFormattingProvider(or(ServerCapabilities::getDocumentFormattingProvider));
      result.setDocumentHighlightProvider(or(ServerCapabilities::getDocumentHighlightProvider));
      result.setDocumentOnTypeFormattingProvider(getDocumentOnTypeFormattingProvider());
      result.setDocumentRangeFormattingProvider(
          or(ServerCapabilities::getDocumentRangeFormattingProvider));
      result.setDocumentSymbolProvider(or(ServerCapabilities::getDocumentSymbolProvider));
      result.setHoverProvider(or(ServerCapabilities::getHoverProvider));
      result.setReferencesProvider(or(ServerCapabilities::getReferencesProvider));
      result.setRenameProvider(or(ServerCapabilities::getRenameProvider));
      result.setSignatureHelpProvider(getSignatureHelpProvider());
      result.setTextDocumentSync(getTextDocumentSync());
      result.setWorkspaceSymbolProvider(or(ServerCapabilities::getWorkspaceSymbolProvider));

      return result;
    }

