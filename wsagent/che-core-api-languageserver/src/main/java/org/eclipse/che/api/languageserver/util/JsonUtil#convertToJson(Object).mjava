    public static JsonElement convertToJson(Object value) {
        Class<?> t = value.getClass();
        if (Enum.class.isAssignableFrom(t)) {
            return new JsonPrimitive(((Enum<?>)value).name());
        } else if (String.class.isAssignableFrom(t)) {
            return new JsonPrimitive((String)value);
        } else if (Number.class.isAssignableFrom(t)) {
            return new JsonPrimitive(((Number)value).doubleValue());
        } else if (Boolean.class.isAssignableFrom(t)) {
            return new JsonPrimitive((boolean)value);
        } else if (JsonSerializable.class.isAssignableFrom(t)) {
            return ((JsonSerializable)value).toJsonElement();
        } else if (value instanceof JsonElement) {
            return (JsonElement)value;
        }
        throw new RuntimeException("Unexpected runtime value: " + value);
    }

