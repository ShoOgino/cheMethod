  private List<TextEditDto> rangeFormatting(
      DocumentRangeFormattingParams documentRangeFormattingParams) {
    try {
      String wsPath = documentRangeFormattingParams.getTextDocument().getUri();
      Optional<ExtendedLanguageServer> serverOptional =
          findServer
              .byPath(wsPath)
              .stream()
              .filter(s -> truish(s.getCapabilities().getDocumentRangeFormattingProvider()))
              .findFirst();
      if (serverOptional.isPresent()) {
        String lsId = serverOptional.get().getId();
        URI uri = languageServerPathTransformer.toFsURI(lsId, wsPath);
        documentRangeFormattingParams.getTextDocument().setUri(uri.toString());

        return serverOptional
            .get()
            .getTextDocumentService()
            .rangeFormatting(documentRangeFormattingParams)
            .get()
            .stream()
            .map(TextEditDto::new)
            .collect(Collectors.toList());
      } else {
        return emptyList();
      }

    } catch (InterruptedException | ExecutionException e) {
      throw new JsonRpcException(-27000, e.getMessage());
    }
  }

