  private void addRenameResult(
      Map<String, ExtendedWorkspaceEdit> map, String id, WorkspaceEdit workspaceEdit) {

    ExtendedWorkspaceEdit result = new ExtendedWorkspaceEdit();
    List<ExtendedTextDocumentEdit> edits = new ArrayList<>();
    if (workspaceEdit.getDocumentChanges() != null) {
      for (Either<TextDocumentEdit, ResourceOperation> documentChange :
          workspaceEdit.getDocumentChanges()) {
        if (documentChange.isLeft()) {
          // since we're not announcing our capability to handle resource edits in initialization,
          // we should not get any resoure changes
          TextDocumentEdit documentEdit = documentChange.getLeft();
          ExtendedTextDocumentEdit edit = new ExtendedTextDocumentEdit();
          edit.setTextDocument(documentEdit.getTextDocument());
          edit.getTextDocument().setUri(removePrefixUri(edit.getTextDocument().getUri()));
          edit.setEdits(
              convertToExtendedEdit(
                  documentEdit.getEdits(),
                  removeUriScheme(documentEdit.getTextDocument().getUri())));
          edits.add(edit);
        }
      }
    } else if (workspaceEdit.getChanges() != null) {
      for (Entry<String, List<TextEdit>> entry : workspaceEdit.getChanges().entrySet()) {
        ExtendedTextDocumentEdit edit = new ExtendedTextDocumentEdit();
        VersionedTextDocumentIdentifier documentIdentifier = new VersionedTextDocumentIdentifier();
        documentIdentifier.setVersion(-1);
        documentIdentifier.setUri(removePrefixUri(entry.getKey()));
        edit.setTextDocument(documentIdentifier);
        edit.setEdits(convertToExtendedEdit(entry.getValue(), removeUriScheme(entry.getKey())));
        edits.add(edit);
      }
    }

    if (!edits.isEmpty()) {
      result.setDocumentChanges(edits);
      map.put(id, result);
    }
  }

