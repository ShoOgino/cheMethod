  private static ExtendedTextEdit doConvert(TextEdit edit, StringBuilder currentLine) {
    ExtendedTextEdit extendedEdit = new ExtendedTextEdit();
    extendedEdit.setRange(edit.getRange());
    extendedEdit.setNewText(edit.getNewText());

    extendedEdit.setLineText(currentLine.toString());
    extendedEdit.setInLineStart(edit.getRange().getStart().getCharacter());
    if (edit.getRange().getEnd().getLine() == edit.getRange().getStart().getLine()) {
      extendedEdit.setInLineEnd(edit.getRange().getEnd().getCharacter());
    } else {
      extendedEdit.setInLineEnd(Math.max(0, currentLine.length() - 1));
    }
    return extendedEdit;
  }

