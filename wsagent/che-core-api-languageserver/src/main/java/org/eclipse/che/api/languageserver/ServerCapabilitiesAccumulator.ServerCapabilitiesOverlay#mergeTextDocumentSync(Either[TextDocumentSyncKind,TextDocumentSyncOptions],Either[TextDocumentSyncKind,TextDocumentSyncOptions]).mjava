    private Either<TextDocumentSyncKind, TextDocumentSyncOptions> mergeTextDocumentSync(
        Either<TextDocumentSyncKind, TextDocumentSyncOptions> left,
        Either<TextDocumentSyncKind, TextDocumentSyncOptions> right) {
      if (left == null) {
        return right;
      }
      if (right == null) {
        return left;
      }
      if (left.equals(right)) {
        return left;
      }

      if (left.isLeft() && left.getLeft() == TextDocumentSyncKind.Full) {
        return left;
      }

      if (left.isLeft() && left.getLeft() == TextDocumentSyncKind.Incremental) {
        if (right.isLeft() && right.getLeft() == TextDocumentSyncKind.Full) {
          return right;
        } else {
          return left;
        }
      }

      if (left.isRight() && right.isRight()) {
        TextDocumentSyncOptions leftRight = left.getRight();
        TextDocumentSyncOptions rightRight = right.getRight();
        if (leftRight.getChange() == TextDocumentSyncKind.Full) {
          return left;
        }

        if (leftRight.getChange() == TextDocumentSyncKind.Incremental) {
          if (rightRight.getChange() == TextDocumentSyncKind.Full) {
            return right;
          } else {
            return left;
          }
        }
      }

      if (left.isLeft() && right.isRight()) {
        return right;
      }

      if (left.isRight() && right.isLeft()) {
        return left;
      }
      return right;
    }

