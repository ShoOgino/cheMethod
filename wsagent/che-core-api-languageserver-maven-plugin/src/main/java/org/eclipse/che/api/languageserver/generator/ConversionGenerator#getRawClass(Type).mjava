    protected Class<?> getRawClass(Type type) {
        if (type instanceof ParameterizedType) {
            return getRawClass(((ParameterizedType)type).getRawType());
        } else if (type instanceof WildcardType) {
            return getRawClass(((WildcardType)type).getUpperBounds()[0]);
        }
        return (Class<?>)type;
    }

