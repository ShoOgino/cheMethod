    public void generateToJson(String indent, PrintWriter out, Class<?> receiverClass, Method m) {
        String varName = fieldName(m) + "Val";
        Type paramType = m.getGenericParameterTypes()[0];
        String valueAccess = getterName(receiverClass, m) + "()";

        if (getRawClass(paramType).isPrimitive()) {
            generateToJson(indent, out, varName, getterName(receiverClass, m) + "()", paramType);
            out.println(
                    String.format(indent + INDENT + "result.%1$s(\"%2$s\", %3$s);", json.put(), fieldName(m), varName));
        } else {
            out.println(indent + String.format("if (%1$s == null) {", valueAccess));
            out.println(indent + INDENT + String.format("%1$s((%2$s)null);", m.getName(), paramType.getTypeName()));
            out.println(indent + "} else {");
            generateToJson(indent + INDENT, out, varName, getterName(receiverClass, m) + "()", paramType);
            out.println(
                    String.format(indent + INDENT + "result.%1$s(\"%2$s\", %3$s);", json.put(), fieldName(m), varName));
            out.println(indent + "}");
        }
    }

