    @Override
    public void writeTo(OutputStream out) throws IOException {
        try (PrintWriter outWriter = new PrintWriter(out);) {
            if (request.getCommitA() == null && request.getCommitB() == null && !request.isCached()) {
                workingTreeToIndex(outWriter);
            } else if (request.getCommitA() != null && request.getCommitB() == null && !request.isCached()) {
                commitToWorkingTree(request.getCommitA(), outWriter);
            } else if (request.getCommitB() == null && request.isCached()) {
                commitToIndex(request.getCommitA(), outWriter);
            } else {
                commitToCommit(request.getCommitA(), request.getCommitB(), outWriter);
            }
        } catch (GitException e) {
            LOG.error("Diff page creating exception", e);
        }
    }

