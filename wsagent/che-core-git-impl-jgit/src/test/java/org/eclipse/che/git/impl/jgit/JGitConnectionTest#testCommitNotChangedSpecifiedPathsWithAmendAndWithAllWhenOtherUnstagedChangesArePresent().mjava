  /** Test for workaround related to https://bugs.eclipse.org/bugs/show_bug.cgi?id=510685. */
  @Test(
    expectedExceptions = GitException.class,
    expectedExceptionsMessageRegExp =
        "Changes are present but not changed path was specified for commit."
  )
  public void
      testCommitNotChangedSpecifiedPathsWithAmendAndWithAllWhenOtherUnstagedChangesArePresent()
          throws Exception {
    // given
    Status status = mock(Status.class);
    when(status.getModified()).thenReturn(singletonList("ChangedNotSpecified"));
    doReturn(status).when(jGitConnection).status(anyObject());

    // when
    jGitConnection.commit(
        CommitParams.create("message")
            .withFiles(singletonList("NotChangedSpecified"))
            .withAmend(true)
            .withAll(true));
  }

