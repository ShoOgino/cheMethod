    @Test
    public void shouldCloseCloneCommand() throws Exception {
        //given
        File fileMock = mock(File.class);
        Git cloneCommand = mock(Git.class);
        jGitConnection.setOutputLineConsumerFactory(mock(LineConsumerFactory.class));
        when(repository.getWorkTree()).thenReturn(fileMock);
        when(repository.getDirectory()).thenReturn(fileMock);
        when(repository.getConfig()).thenReturn(mock(StoredConfig.class));
        doReturn(cloneCommand).when(jGitConnection).executeRemoteCommand(anyString(), anyObject(), anyString(), anyString());

        //when
        jGitConnection.clone(CloneParams.create("url").withWorkingDir("fakePath"));

        //then
        verify(cloneCommand).close();
    }

