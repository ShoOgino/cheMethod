  @Override
  public JGitConnection getConnection(File workDir, LineConsumerFactory outputPublisherFactory)
      throws GitException {
    Repository gitRepo = createRepository(workDir);
    JGitConnection conn =
        new JGitConnection(gitRepo, credentialsLoader, sshKeyProvider, eventService, userResolver);
    conn.setOutputLineConsumerFactory(outputPublisherFactory);
    return conn;
  }

