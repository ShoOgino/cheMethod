  /** To add deleted files in index it is required to perform git rm on them */
  private void addDeletedFilesToIndexIfNeeded(List<String> filePatterns) throws GitAPIException {
    Set<String> deletedFiles = getGit().status().call().getMissing();
    if (deletedFiles.isEmpty()) {
      return;
    }
    if (!filePatterns.isEmpty() && !filePatterns.contains(".")) {
      deletedFiles =
          deletedFiles.stream().filter(filePatterns::contains).collect(Collectors.toSet());
    }
    if (!deletedFiles.isEmpty()) {
      RmCommand rmCommand = getGit().rm();
      deletedFiles.forEach(rmCommand::addFilepattern);
      rmCommand.call();
    }
  }

