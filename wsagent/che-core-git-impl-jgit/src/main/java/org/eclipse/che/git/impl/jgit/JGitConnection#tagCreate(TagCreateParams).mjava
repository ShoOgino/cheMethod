  @Override
  public Tag tagCreate(TagCreateParams params) throws GitException {
    String commit = params.getCommit();
    if (commit == null) {
      commit = HEAD;
    }

    try {
      RevWalk revWalk = new RevWalk(repository);
      RevObject revObject;
      try {
        revObject = revWalk.parseAny(repository.resolve(commit));
      } finally {
        revWalk.close();
      }

      TagCommand tagCommand =
          getGit()
              .tag()
              .setName(params.getName())
              .setObjectId(revObject)
              .setMessage(params.getMessage())
              .setForceUpdate(params.isForce());

      GitUser tagger = getUser();
      if (tagger != null) {
        tagCommand.setTagger(new PersonIdent(tagger.getName(), tagger.getEmail()));
      }

      Ref revTagRef = tagCommand.call();
      RevTag revTag = revWalk.parseTag(revTagRef.getLeaf().getObjectId());
      return newDto(Tag.class).withName(revTag.getTagName());
    } catch (IOException | GitAPIException exception) {
      throw new GitException(exception.getMessage(), exception);
    }
  }

