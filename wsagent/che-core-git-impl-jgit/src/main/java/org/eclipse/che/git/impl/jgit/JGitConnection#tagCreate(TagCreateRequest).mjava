    @Override
    public Tag tagCreate(TagCreateRequest request) throws GitException {
        String commit = request.getCommit();
        if (commit == null) {
            commit = Constants.HEAD;
        }

        try {
            RevWalk revWalk = new RevWalk(repository);
            RevObject revObject;
            try {
                revObject = revWalk.parseAny(repository.resolve(commit));
            } finally {
                revWalk.close();
            }

            TagCommand tagCommand = getGit().tag()
                                            .setName(request.getName())
                                            .setObjectId(revObject)
                                            .setMessage(request.getMessage())
                                            .setForceUpdate(request.isForce());

            GitUser tagger = getUser();
            if (tagger != null) {
                tagCommand.setTagger(new PersonIdent(tagger.getName(), tagger.getEmail()));
            }

            Ref revTagRef = tagCommand.call();
            RevTag revTag = revWalk.parseTag(revTagRef.getLeaf().getObjectId());
            return newDto(Tag.class).withName(revTag.getTagName());
        } catch (IOException | GitAPIException exception) {
            throw new GitException(exception.getMessage(), exception);
        }
    }

