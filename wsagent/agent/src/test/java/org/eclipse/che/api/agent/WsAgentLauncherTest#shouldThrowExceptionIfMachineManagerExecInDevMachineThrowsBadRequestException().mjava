    @Test(expectedExceptions = ServerException.class, expectedExceptionsMessageRegExp = "Test exception")
    public void shouldThrowExceptionIfMachineManagerExecInDevMachineThrowsBadRequestException() throws Exception {
        Mockito.when(machineProcessManager.exec(Matchers.anyString(),
                                                Matchers.anyString(),
                                                any(Command.class),
                                                Matchers.anyString()))
               .thenThrow(new BadRequestException("Test exception"));

        wsAgentLauncher.launch(machine, agent);

        Mockito.verify(machineProcessManager).exec(Matchers.anyString(),
                                                   Matchers.anyString(),
                                                   any(Command.class),
                                                   Matchers.anyString());
    }

