  @Test
  public void shouldPingWsAgentMultipleTimesAfterStartIfPingFailsWithException() throws Exception {
    Mockito.when(pingRequest.request())
        .thenThrow(new ServerException(""), new BadRequestException(""), new IOException())
        .thenReturn(pingResponse);

    wsAgentLauncher.launch(machine, agent);

    Mockito.verify(pingRequest, Mockito.times(4)).request();
    Mockito.verify(pingResponse).getResponseCode();
  }

