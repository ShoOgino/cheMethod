  @Test
  public void shouldStartWsAgentUsingMachineExec() throws Exception {
    wsAgentLauncher.launch(machine, agent);

    Mockito.verify(machineProcessManager)
        .exec(
            eq(WORKSPACE_ID),
            eq(MACHINE_ID),
            eq(
                new CommandImpl(
                    "org.eclipse.che.ws-agent",
                    "script\n" + WsAgentLauncher.DEFAULT_WS_AGENT_RUN_COMMAND,
                    WS_AGENT_PROCESS_NAME)),
            eq(WsAgentLauncher.getWsAgentProcessOutputChannel(WORKSPACE_ID)));
  }

