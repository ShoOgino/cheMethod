  private void addDirectory(Path fsPath) throws ServerException {
    long start = System.currentTimeMillis();
    LinkedList<File> queue = new LinkedList<>();
    queue.add(fsPath.toFile());
    int indexedFiles = 0;
    while (!queue.isEmpty()) {
      File folder = queue.pop();
      if (folder.exists() && folder.isDirectory()) {
        File[] files = folder.listFiles();
        if (files == null) {
          continue;
        }
        for (File child : files) {
          if (child.isDirectory()) {
            queue.push(child);
          } else {
            addFile(child.toPath());
            indexedFiles++;
          }
        }
      }
    }

    long end = System.currentTimeMillis();
    LOG.debug("Indexed {} files from {}, time: {} ms", indexedFiles, fsPath, (end - start));
  }

