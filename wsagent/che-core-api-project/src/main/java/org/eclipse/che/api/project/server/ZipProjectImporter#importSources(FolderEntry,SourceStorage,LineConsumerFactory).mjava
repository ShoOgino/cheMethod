  @Override
  public void importSources(
      FolderEntry baseFolder,
      SourceStorage storage,
      LineConsumerFactory importOutputConsumerFactory)
      throws ForbiddenException, ConflictException, IOException, ServerException {
    URL url;
    String location = storage.getLocation();
    if (location.startsWith("http://") || location.startsWith("https://")) {
      url = new URL(location);
    } else {
      url = Thread.currentThread().getContextClassLoader().getResource(location);
      if (url == null) {
        final java.io.File file = new java.io.File(location);
        if (file.exists()) {
          url = file.toURI().toURL();
        }
      }
    }

    if (url == null) {
      throw new IOException(String.format("Can't find %s", location));
    }

    Map<String, String> parameters = storage.getParameters();
    try (InputStream zip = url.openStream()) {
      int stripNumber = 0;
      if (parameters != null && parameters.containsKey("skipFirstLevel")) {
        stripNumber = Boolean.parseBoolean(parameters.get("skipFirstLevel")) ? 1 : 0;
      }
      baseFolder.getVirtualFile().unzip(zip, true, stripNumber);
    }
  }

