  private Document createDocument(String wsPath, Reader reader) throws ServerException {
    String name = nameOf(wsPath);
    Document doc = new Document();
    doc.add(new StringField(PATH_FIELD, wsPath, Field.Store.YES));
    doc.add(new TextField(NAME_FIELD, name, Field.Store.YES));
    if (reader != null) {
      try {
        doc.add(new TextField(TEXT_FIELD, CharStreams.toString(reader), Field.Store.YES));
      } catch (IOException e) {
        LOG.error("Can't index file: {}", wsPath);
        throw new ServerException(e.getLocalizedMessage(), e);
      }
    }
    return doc;
  }

