  /**
   * Updates content of the working copy by applying editor content changes.
   *
   * @param changes contains editor content changes
   */
  void applyChanges(EditorChangesDto changes) {
    synchronized (this) {
      String text = changes.getText();
      int offset = changes.getOffset();
      int removedCharCount = changes.getRemovedCharCount();

      String newContent = null;
      String oldContent = getContentAsString();
      EditorChangesDto.Type type = changes.getType();
      if (type == INSERT) {
        newContent = new StringBuilder(oldContent).insert(offset, text).toString();
      }

      if (type == REMOVE && removedCharCount > 0) {
        newContent =
            new StringBuilder(oldContent).delete(offset, offset + removedCharCount).toString();
      }

      if (newContent != null) {
        updateContent(newContent);
      }
    }
  }

