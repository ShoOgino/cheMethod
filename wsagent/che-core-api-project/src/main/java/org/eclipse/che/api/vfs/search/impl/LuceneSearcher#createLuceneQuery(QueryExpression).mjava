  private Query createLuceneQuery(QueryExpression query) throws ParseException {
    final BooleanQuery luceneQuery = new BooleanQuery();
    final String name = query.getName();
    final String path = query.getPath();
    final String text = query.getText();
    if (path != null) {
      luceneQuery.add(new PrefixQuery(new Term(PATH_FIELD, path)), BooleanClause.Occur.MUST);
    }
    if (name != null) {
      QueryParser qParser = new QueryParser(NAME_FIELD, makeAnalyzer());
      qParser.setAllowLeadingWildcard(true);
      luceneQuery.add(qParser.parse(name), BooleanClause.Occur.MUST);
    }
    if (text != null) {
      QueryParser qParser = new QueryParser(TEXT_FIELD, makeAnalyzer());
      qParser.setAllowLeadingWildcard(true);
      luceneQuery.add(qParser.parse(text), BooleanClause.Occur.MUST);
    }
    return luceneQuery;
  }

