  /**
   * Registers create, modify and delete operations when item defined by path parameter is
   * correspondingly being created, modified or deleted. If path parameter denotes directory than
   * listed operations are considered to correspond any directory entry related event. Return value
   * corresponds to identifier that is used to distinguish different operation sets registered for
   * the same path and can be later used to unregister those operations.
   *
   * @param path path
   * @param create consumer for entry create event
   * @param modify consumer for entry modify event
   * @param delete consumer for entry delete event
   * @return number identifier of operations set
   */
  int register(
      Path path, Consumer<String> create, Consumer<String> modify, Consumer<String> delete) {
    LOG.debug("Registering operations for path '{}'");
    int id = idCounter.incrementAndGet();
    FileWatcherOperation operation = new FileWatcherOperation(id, create, modify, delete);

    operations.putIfAbsent(path, newHashSet());
    operations.get(path).add(operation);

    return id;
  }

