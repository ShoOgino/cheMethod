  @Override
  public VirtualFile copyTo(VirtualFile parent, String newName, boolean overwrite)
      throws ForbiddenException, ConflictException, ServerException {
    checkExistence();
    ((MemoryVirtualFile) parent).checkExistence();
    if (isRoot()) {
      throw new ServerException("Unable copy root folder");
    }
    if (newName == null || newName.trim().isEmpty()) {
      newName = this.getName();
    }
    if (parent.isFolder()) {
      VirtualFile copy = doCopy((MemoryVirtualFile) parent, newName, overwrite);
      addInSearcher(copy);
      return copy;
    } else {
      throw new ForbiddenException(
          String.format(
              "Unable create copy of '%s'. Item '%s' specified as parent is not a folder.",
              getPath(), parent.getPath()));
    }
  }

