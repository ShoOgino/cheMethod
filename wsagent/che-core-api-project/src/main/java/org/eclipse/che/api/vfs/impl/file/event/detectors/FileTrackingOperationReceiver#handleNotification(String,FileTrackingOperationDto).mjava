    @Override
    public void handleNotification(String endpointId, FileTrackingOperationDto operation) {
        final Type type = operation.getType();
        final String path = operation.getPath();
        final String oldPath = operation.getOldPath();

        switch (type) {
            case START: {
                LOG.debug("Received file tracking operation START trigger.");
                int id = fileWatcherManager.registerByPath(path,
                                                           EMPTY_CONSUMER,
                                                           getModifyConsumer(endpointId, path),
                                                           getDeleteConsumer(endpointId, path));
                watchIdRegistry.put(path + endpointId, id);
                break;
            }
            case STOP: {
                LOG.debug("Received file tracking operation STOP trigger.");

                int id = watchIdRegistry.remove(path + endpointId);
                fileWatcherManager.unRegisterByPath(id);

                break;
            }
            case SUSPEND: {
                LOG.debug("Received file tracking operation SUSPEND trigger.");

                fileWatcherManager.suspend();

                break;
            }
            case RESUME: {
                LOG.debug("Received file tracking operation RESUME trigger.");

                fileWatcherManager.resume();

                break;
            }
            case MOVE: {
                LOG.debug("Received file tracking operation MOVE trigger.");

                int oldId = watchIdRegistry.remove(oldPath + endpointId);
                fileWatcherManager.unRegisterByPath(oldId);

                int newId = fileWatcherManager.registerByPath(path,
                                                              EMPTY_CONSUMER,
                                                              getModifyConsumer(endpointId, path),
                                                              getDeleteConsumer(endpointId, path));
                watchIdRegistry.put(path + endpointId, newId);


                break;
            }
            default: {
                LOG.error("Received file tracking operation UNKNOWN trigger.");

                break;
            }
        }
    }

