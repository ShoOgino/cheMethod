  Set<Path> getFilePaths(Path fsPath) {
    File[] files = fsPath.toFile().listFiles();

    if (files == null) {
      return Collections.emptySet();
    }

    Set<Path> fileNames =
        Arrays.stream(files).filter(File::isFile).map(File::toPath).collect(toSet());

    return Collections.unmodifiableSet(fileNames);
  }

