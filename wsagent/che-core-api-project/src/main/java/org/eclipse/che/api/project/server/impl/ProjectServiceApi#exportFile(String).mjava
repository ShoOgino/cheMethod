  public Response exportFile(String wsPath)
      throws NotFoundException, ForbiddenException, ServerException, ConflictException {
    wsPath = absolutize(wsPath);

    InputStream inputStream = fsManager.read(wsPath);
    long length = fsManager.length(wsPath);
    long lastModified = fsManager.lastModified(wsPath);
    String name = nameOf(wsPath);

    return Response.ok(inputStream, getTIKA().detect(name))
        .lastModified(new Date(lastModified))
        .header(HttpHeaders.CONTENT_LENGTH, Long.toString(length))
        .header(HttpHeaders.CONTENT_DISPOSITION, "attachment; filename=\"" + name + '"')
        .build();
  }

