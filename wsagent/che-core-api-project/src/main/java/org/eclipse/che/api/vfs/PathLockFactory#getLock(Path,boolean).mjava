    public PathLock getLock(Path path, boolean exclusive) {
        return new PathLock(path, exclusive ? maxThreads : 1);
    }

