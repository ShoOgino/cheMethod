    @Override
    public Map<String, String> read(DataInput input) throws IOException {
        final int recordsNum = input.readInt();
        if (recordsNum == 0) {
            return newLinkedHashMap();
        }
        final Map<String, String> properties = newHashMapWithExpectedSize(recordsNum);
        final List<String> valuesList = newArrayList();
        int readRecords = 0;
        while (readRecords < recordsNum) {
            String name = input.readUTF();
            final int valueItemNum = input.readInt();
            valuesList.clear();
            for (int i = 0; i < valueItemNum; i++) {
                valuesList.add(input.readUTF());
            }
            properties.put(name, Joiner.on(',').join(valuesList));
            ++readRecords;
        }
        return properties;
    }

