  @Inject
  public FileTreeWatcher(
      @Named("che.user.workspaces.storage") File watchRoot,
      @Named("vfs.index_filter_matcher") Set<PathMatcher> excludePatterns,
      FileWatcherNotificationHandler fileWatcherNotificationHandler) {
    watchEventModifiers = new WatchEvent.Modifier[0];
    this.watchRoot = toCanonicalFile(watchRoot);
    this.watchRootPath = this.watchRoot.toPath();
    this.excludePatterns = newArrayList(excludePatterns);
    this.fileWatcherNotificationHandler = fileWatcherNotificationHandler;

    ThreadFactory threadFactory =
        new ThreadFactoryBuilder()
            .setDaemon(true)
            .setUncaughtExceptionHandler(LoggingUncaughtExceptionHandler.getInstance())
            .setNameFormat("FileTreeWatcher-%d")
            .build();
    executor = Executors.newSingleThreadExecutor(threadFactory);
    running = new AtomicBoolean();
    watchedDirectories = newHashMap();
  }

