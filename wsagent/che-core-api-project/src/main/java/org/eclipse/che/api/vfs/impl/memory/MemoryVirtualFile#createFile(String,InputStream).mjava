  @Override
  public VirtualFile createFile(String name, InputStream content)
      throws ForbiddenException, ConflictException, ServerException {
    checkExistence();

    checkName(name);
    if (Path.of(name).length() > 1) {
      throw new ServerException(String.format("Invalid name '%s'", name));
    }

    if (isFolder()) {
      final MemoryVirtualFile newFile;
      try {
        newFile = newFile(this, name, content);
      } catch (IOException e) {
        throw new ServerException(
            String.format("Unable set content of '%s'. Error: %s", getPath(), e.getMessage()));
      }
      if (!addChild(newFile)) {
        throw new ConflictException(String.format("Item with the name '%s' already exists", name));
      }
      addInSearcher(newFile);
      return newFile;
    } else {
      throw new ForbiddenException(
          "Unable create new file. Item specified as parent is not a folder");
    }
  }

