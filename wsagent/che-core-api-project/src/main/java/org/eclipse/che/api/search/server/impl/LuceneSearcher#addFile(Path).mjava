  private void addFile(Path fsPath) throws ServerException {
    if (!fsPath.toFile().exists()) {
      return;
    }

    String wsPath = pathTransformer.transform(fsPath);

    try (Reader fContentReader = isNotExcluded(fsPath) ? newBufferedReader(fsPath) : null) {
      luceneIndexWriter.updateDocument(
          new Term(PATH_FIELD, wsPath), createDocument(wsPath, fContentReader));
    } catch (OutOfMemoryError oome) {
      doTerminate();
      throw oome;
    } catch (IOException e) {
      throw new ServerException(e.getMessage(), e);
    }
  }

