    @Override
    public void compress(OutputStream zipOutput, VirtualFileFilter filter) throws IOException, ServerException {
        try (ZipOutputStream zipOutputStream = new ZipOutputStream(zipOutput)) {
            folder.accept(new VirtualFileVisitor() {
                @Override
                public void visit(VirtualFile visitedVirtualFile) throws ServerException {
                    if (filter.accept(visitedVirtualFile)) {
                        if (!visitedVirtualFile.equals(folder)) {
                            addZipEntry(visitedVirtualFile, zipOutputStream);
                        }
                        if (visitedVirtualFile.isFolder()) {
                            for (VirtualFile child : visitedVirtualFile.getChildren()) {
                                child.accept(this);
                            }
                        }
                    }
                }
            });
        }
    }

