  /**
   * Find related VCS provider and set VCS status of {@link ItemReference} file to it's attributes
   * if VCS provider is present.
   *
   * @param itemReference file to update
   */
  public ItemReference injectVcsStatus(ItemReference itemReference)
      throws ServerException, NotFoundException {
    List<String> vcsAttributes =
        projectManager
            .getProject(itemReference.getProject())
            .getAttributes()
            .get("vcs.provider.name");
    Optional<VcsStatusProvider> optional =
        vcsStatusProviders
            .stream()
            .filter(
                vcsStatusProvider ->
                    vcsStatusProvider
                        .getVcsName()
                        .equals(vcsAttributes != null ? vcsAttributes.get(0) : null))
            .findAny();
    if (optional.isPresent()) {
      Map<String, String> attributes = new HashMap<>(itemReference.getAttributes());
      attributes.put("vcs.status", optional.get().getStatus(itemReference.getPath()).toString());
      itemReference.setAttributes(attributes);
    }
    return itemReference;
  }

