  /**
   * Reset project types and atrributes after initialization in case when some attributes are not
   * valid (for instance required attributes are not initialized)
   *
   * @param attributesToDel - invalid attributes
   */
  void reset(Set<Attribute> attributesToDel) {

    Set<String> ptsToDel = new HashSet<>();
    for (Attribute attr : attributesToDel) {
      ptsToDel.add(attr.getProjectType());
    }

    Set<String> attrNamesToDel = new HashSet<>();
    for (String pt : ptsToDel) {
      ProjectTypeDef typeDef = all.get(pt);
      for (Attribute attrDef : typeDef.getAttributes()) {
        attrNamesToDel.add(attrDef.getName());
      }
    }

    // remove project types
    for (String typeId : ptsToDel) {
      this.all.remove(typeId);
      if (this.primary.getId().equals(typeId)) {
        this.primary = ProjectTypeRegistry.BASE_TYPE;
        this.all.put(ProjectTypeRegistry.BASE_TYPE.getId(), ProjectTypeRegistry.BASE_TYPE);
      } else {
        mixins.remove(typeId);
      }
    }

    // remove attributes
    for (String attr : attrNamesToDel) {
      this.attributeDefs.remove(attr);
    }
  }

