  @Test
  public void readsProperties() throws Exception {
    DataInput data = mock(DataInput.class);
    when(data.readInt()).thenReturn(2, 1, 1);
    when(data.readUTF()).thenReturn("a", "x", "b", "z");
    Map<String, String> expected =
        ImmutableMap.of(
            "a", "x",
            "b", "z");
    assertEquals(expected, metadataSerializer.read(data));
  }

