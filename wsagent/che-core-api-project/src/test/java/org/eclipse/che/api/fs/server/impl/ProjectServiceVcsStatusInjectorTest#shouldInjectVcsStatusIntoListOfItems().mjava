  @Test
  public void shouldInjectVcsStatusIntoListOfItems() throws Exception {
    // given
    List<ItemReference> itemReferences = new ArrayList<>();
    itemReferences.add(itemReference);
    itemReferences.add(itemReference1);

    List<String> itemReferenceFiles = new ArrayList<>();
    itemReferenceFiles.add("file");
    itemReferenceFiles.add("file1");

    Map<String, VcsStatusProvider.VcsStatus> statusMap = new HashMap<>();
    statusMap.put("/project/file", ADDED);
    statusMap.put("/project/file1", MODIFIED);

    when(vcsStatusProvider.getStatus("project", itemReferenceFiles)).thenReturn(statusMap);

    // when
    vcsStatusInjector.injectVcsStatus(itemReferences);

    // then
    verify(itemReference).setAttributes(argumentCaptor.capture());
    assertTrue(argumentCaptor.getValue().size() == 1);
    assertEquals(argumentCaptor.getValue().get("vcs.status"), ADDED.toString());

    verify(itemReference1).setAttributes(argumentCaptor.capture());
    assertTrue(argumentCaptor.getValue().size() == 1);
    assertEquals(argumentCaptor.getValue().get("vcs.status"), MODIFIED.toString());
  }

