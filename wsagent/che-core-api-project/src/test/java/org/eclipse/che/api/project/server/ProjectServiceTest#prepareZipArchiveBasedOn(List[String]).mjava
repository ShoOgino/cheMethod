  private InputStream prepareZipArchiveBasedOn(List<String> paths) throws IOException {
    ByteArrayOutputStream bout = new ByteArrayOutputStream();
    ZipOutputStream zipOut = new ZipOutputStream(bout);

    for (String path : paths) {
      zipOut.putNextEntry(new ZipEntry(path));
    }
    zipOut.close();
    return new ByteArrayInputStream(bout.toByteArray());
  }

