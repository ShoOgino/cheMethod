  @Test
  public void failsCopyFileWhenItemWithTheSameNameExistsInTargetFolderAndOverwritingIsDisabled()
      throws Exception {
    VirtualFile root = getRoot();
    VirtualFile file = root.createFile(generateFileName(), DEFAULT_CONTENT);
    VirtualFile targetFolder = root.createFolder(generateFolderName());
    VirtualFile conflictFile = targetFolder.createFile("existed_name", "xxx");

    try {
      file.copyTo(targetFolder, "existed_name", false);
      thrown.expect(ConflictException.class);
    } catch (ConflictException e) {
      assertionHelper.assertThatIoFileHasContent(conflictFile.getPath(), "xxx".getBytes());
      assertionHelper.assertThatIoFileHasContent(file.getPath(), DEFAULT_CONTENT_BYTES);
    }
  }

