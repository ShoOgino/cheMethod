    @Test
    public void testCreateProjectWhenSourceCodeIsNotReachable() throws Exception {
        final String projectPath = "/testProject";
        final SourceStorageDto source = DtoFactory.newDto(SourceStorageDto.class).withLocation("someLocation").withType("importType");
        final NewProjectConfigDto config = createProjectConfigObject("testProject1", projectPath, BaseProjectType.ID, source);

        final List<NewProjectConfig> configs = new ArrayList<>(1);
        configs.add(config);

        try {
            pm.createBatchProjects(configs, false);
            fail("Exception should be thrown when source code is not reachable");
        } catch (Exception e) {
            assertEquals(0, projectRegistry.getProjects().size());
            assertNull(projectRegistry.getProject(projectPath));
            assertNull(pm.getProjectsRoot().getChild(projectPath));
        }
    }

