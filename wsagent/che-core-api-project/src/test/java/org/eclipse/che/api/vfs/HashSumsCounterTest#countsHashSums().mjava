  @Test
  public void countsHashSums() throws Exception {
    VirtualFile fileAB = mockFile("/a/file", "file1".getBytes());
    VirtualFile fileBA = mockFile("/a/b/file", "file2".getBytes());
    VirtualFile folderB = mockFolder("/a/b", fileBA);
    VirtualFile folderA = mockFolder("/a", folderB, fileAB);
    Set<Pair<String, String>> expected =
        newHashSet(
            Pair.of(countMd5Sum("file1".getBytes()), "file"),
            Pair.of(countMd5Sum("file2".getBytes()), "b/file"));

    Set<Pair<String, String>> hashSums =
        newHashSet(new HashSumsCounter(folderA, Hashing.md5()).countHashSums());

    assertEquals(expected, hashSums);
  }

