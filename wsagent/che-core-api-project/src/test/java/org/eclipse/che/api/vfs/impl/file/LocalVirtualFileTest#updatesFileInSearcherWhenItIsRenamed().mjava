    @Test
    public void updatesFileInSearcherWhenItIsRenamed() throws Exception {
        VirtualFile file = getRoot().createFile(generateFileName(), DEFAULT_CONTENT);
        String oldPath = file.getPath().toString();
        Mockito.reset(searcher);
        VirtualFile renamed = file.rename("new_name");
        verify(searcher).add(renamed);
        verify(searcher).delete(oldPath, true);
    }

