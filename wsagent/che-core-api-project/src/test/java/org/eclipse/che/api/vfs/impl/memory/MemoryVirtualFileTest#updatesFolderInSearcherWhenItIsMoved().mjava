  @Test
  public void updatesFolderInSearcherWhenItIsMoved() throws Exception {
    VirtualFile folder = getRoot().createFolder(generateFileName());
    VirtualFile newParent = getRoot().createFolder(generateFolderName());
    String oldPath = folder.getPath().toString();
    Mockito.reset(searcher);
    VirtualFile moved = folder.moveTo(newParent);
    verify(searcher).add(moved);
    verify(searcher).delete(oldPath, false);
  }

