  @Test
  public void shouldInjectVcsStatusIntoTreeElements() throws Exception {
    // given
    TreeElement treeElement = mock(TreeElement.class);
    TreeElement treeElement1 = mock(TreeElement.class);
    when(treeElement.getNode()).thenReturn(itemReference);
    when(treeElement1.getNode()).thenReturn(itemReference1);

    List<TreeElement> treeElements = new ArrayList<>();
    treeElements.add(treeElement);
    treeElements.add(treeElement1);

    List<String> itemReferenceFiles = new ArrayList<>();
    itemReferenceFiles.add("file");
    itemReferenceFiles.add("file1");

    Map<String, VcsStatusProvider.VcsStatus> statusMap = new HashMap<>();
    statusMap.put("/project/file", ADDED);
    statusMap.put("/project/file1", MODIFIED);

    when(vcsStatusProvider.getStatus("project", itemReferenceFiles)).thenReturn(statusMap);

    // when
    vcsStatusInjector.injectVcsStatusTreeElements(treeElements);

    // then
    verify(itemReference).setAttributes(argumentCaptor.capture());
    assertTrue(argumentCaptor.getValue().size() == 1);
    assertEquals(argumentCaptor.getValue().get("vcs.status"), ADDED.toString());

    verify(itemReference1).setAttributes(argumentCaptor.capture());
    assertTrue(argumentCaptor.getValue().size() == 1);
    assertEquals(argumentCaptor.getValue().get("vcs.status"), MODIFIED.toString());
  }

