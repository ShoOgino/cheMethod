  @Test
  public void writesProperties() throws Exception {
    DataOutput output = mock(DataOutput.class);
    Map<String, String> properties = ImmutableMap.of("a", "x", "b", "z");

    metadataSerializer.write(output, properties);

    InOrder inOrder = inOrder(output);
    inOrder.verify(output).writeInt(properties.size());
    inOrder.verify(output).writeUTF("a");
    inOrder.verify(output).writeInt(1);
    inOrder.verify(output).writeUTF("b");
    inOrder.verify(output).writeInt(1);
    inOrder.verify(output).writeUTF("z");
  }

