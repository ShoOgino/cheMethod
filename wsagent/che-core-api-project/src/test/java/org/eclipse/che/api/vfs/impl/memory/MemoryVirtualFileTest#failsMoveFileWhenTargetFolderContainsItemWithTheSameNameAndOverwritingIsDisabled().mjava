  @Test
  public void failsMoveFileWhenTargetFolderContainsItemWithTheSameNameAndOverwritingIsDisabled()
      throws Exception {
    VirtualFile file = getRoot().createFile(generateFileName(), DEFAULT_CONTENT);
    VirtualFile targetFolder = getRoot().createFolder(generateFolderName());
    Path filePath = file.getPath();
    VirtualFile existedFile = targetFolder.createFile("existed_name", "existed content");

    try {
      file.moveTo(targetFolder, "existed_name", false, null);
      thrown.expect(ConflictException.class);
    } catch (ConflictException e) {
      assertEquals(file, getRoot().getChild(filePath));
      assertEquals("existed content", existedFile.getContentAsString());
    }
  }

