  @Test
  public void copiesLockedFile() throws Exception {
    VirtualFile root = getRoot();
    VirtualFile file = root.createFile(generateFileName(), DEFAULT_CONTENT);
    file.lock(0);
    VirtualFile targetFolder = root.createFolder(generateFolderName());

    VirtualFile copy = file.copyTo(targetFolder);

    assertFalse(copy.isLocked());
    assertEquals(file.getContentAsString(), copy.getContentAsString());
    assertEquals(file.getProperties(), copy.getProperties());
  }

