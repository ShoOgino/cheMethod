  @Test
  public void compressesFolderToZipArchive() throws Exception {
    VirtualFile folder = getRoot().createFolder(generateFolderName());
    Archiver archiver = mock(Archiver.class);
    when(archiverFactory.createArchiver(eq(folder), eq("zip"))).thenReturn(archiver);
    folder.zip();
    verify(archiver).compress(any(OutputStream.class), any(VirtualFileFilter.class));
  }

