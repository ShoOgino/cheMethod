  @Test
  public void copiesFolderThatContainsLockedFile() throws Exception {
    VirtualFile folder = getRoot().createFolder(generateFolderName());
    VirtualFile file = folder.createFile(generateFileName(), DEFAULT_CONTENT);
    file.lock(0);

    VirtualFile targetFolder = getRoot().createFolder(generateFolderName());

    VirtualFile copiedFolder = folder.copyTo(targetFolder);
    assertNotNull(getRoot().getChild(copiedFolder.getPath()));

    VirtualFile copiedFile = copiedFolder.getChild(Path.of(file.getName()));
    assertFalse(copiedFile.isLocked());
    assertEquals(file.getContentAsString(), copiedFile.getContentAsString());
  }

