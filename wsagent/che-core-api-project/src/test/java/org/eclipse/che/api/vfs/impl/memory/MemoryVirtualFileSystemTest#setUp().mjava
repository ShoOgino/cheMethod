    @Before
    public void setUp() throws Exception {
        SearcherProvider searcherProvider = mock(SearcherProvider.class);
        searcher = mock(Searcher.class);
        closeCallback = mock(AbstractVirtualFileSystemProvider.CloseCallback.class);
        fileSystem = new MemoryVirtualFileSystem(mock(ArchiverFactory.class), searcherProvider, closeCallback);
        when(searcherProvider.getSearcher(eq(fileSystem), anyBoolean())).thenReturn(searcher);
    }

