        public void doFilter(GenericContainerRequest request) {
            EnvironmentContext.getCurrent().setUser(TEST_USER);
            // hacking security context
            try {
                final SecurityContext securityContext = mock(SecurityContext.class, RETURNS_MOCKS);
                when(securityContext.isUserInRole("user")).thenReturn(true);
                final Field scField = request.getClass().getSuperclass().getDeclaredField("securityContext");
                scField.setAccessible(true);
                scField.set(request, securityContext);
            } catch (IllegalAccessException | NoSuchFieldException ex) {
                throw new RuntimeException(ex);
            }
        }

