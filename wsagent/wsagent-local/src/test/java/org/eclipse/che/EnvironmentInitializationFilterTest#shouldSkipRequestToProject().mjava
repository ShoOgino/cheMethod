  @Test
  public void shouldSkipRequestToProject() throws Exception {
    // given

    EnvironmentContext context = spy(EnvironmentContext.getCurrent());
    EnvironmentContext.setCurrent(context);

    // when
    filter.doFilter(request, response, chain);

    // then
    verify(chain).doFilter(eq(request), eq(response));
    verify(context).setSubject(eq(new SubjectImpl("che", "che", "dummy_token", false)));
    // after reset
    assertNotEquals(EnvironmentContext.getCurrent(), context);
  }

