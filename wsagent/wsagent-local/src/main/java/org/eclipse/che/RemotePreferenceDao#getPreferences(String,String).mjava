    @Override
    public Map<String, String> getPreferences(String userId, String filter) throws ServerException {
        requireNonNull(filter, "Required non-null filter");
        checkUserId(requireNonNull(userId, "Required non-null user id"));
        try {
            return requestFactory.fromUrl(prefsUrl)
                                 .useGetMethod()
                                 .addQueryParam("filter", filter)
                                 .request()
                                 .asProperties();
        } catch (IOException | UnauthorizedException | ForbiddenException | ConflictException | NotFoundException | BadRequestException ex) {
            throw new ServerException(ex.getLocalizedMessage(), ex);
        }
    }

