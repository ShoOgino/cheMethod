    private WebApplicationException translateException(Throwable e) {
        if (e instanceof WebApplicationException) {
            return (WebApplicationException)e;
        }
        Throwable cause = null;
        if (e instanceof InvocationTargetException) {
            cause = e.getCause();
        }
        if (e instanceof RuntimeException) {
            cause = e.getCause();
        }
        if (cause != null && cause != e) {
            return translateException(cause);
        }
        return new WebApplicationException(Response.status(Response.Status.INTERNAL_SERVER_ERROR)
                                                   .entity("An unexpected error occured during test execution: " + e.toString()).build());
    }

