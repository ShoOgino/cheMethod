    @Override
    public String get() {
        if (isNullOrEmpty(cachedAgentUrl)) {
            try {
                final WorkspaceDto workspace = requestFactory.fromUrl(workspaceApiEndpoint + wsId)
                                                             .useGetMethod()
                                                             .request()
                                                             .asDto(WorkspaceDto.class);
                if (workspace.getRuntime() != null) {
                    MachineDto machineDto = workspace.getRuntime().getMachines().get("org.eclipse.che.ws-agent");
                    for (Map.Entry<String, ServerDto> serverEntry : machineDto.getServers().entrySet()) {
                        if (WSAGENT_REFERENCE.equals(serverEntry.getKey())) {
                            cachedAgentUrl = serverEntry.getValue().getUrl();
                            return cachedAgentUrl;
                        }
                    }
                }
            } catch (ApiException | IOException ex) {
                LOG.warn(ex.getLocalizedMessage());
                throw new RuntimeException("Failed to configure wsagent endpoint");
            }
        }
        return cachedAgentUrl;
    }

