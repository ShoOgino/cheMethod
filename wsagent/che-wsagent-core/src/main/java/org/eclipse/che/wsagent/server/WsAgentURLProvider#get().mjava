    @Override
    public String get() {
        if (isNullOrEmpty(cachedAgentUrl)) {
            try {
                final WorkspaceDto workspace = requestFactory.fromUrl(workspaceApiEndpoint + wsId)
                                                             .useGetMethod()
                                                             .request()
                                                             .asDto(WorkspaceDto.class);
                if (workspace.getRuntime() != null) {
                    for (MachineDto machine : workspace.getRuntime().getMachines().values()) {
                        ServerDto wsAgent = machine.getServers().get(WSAGENT_REFERENCE);
                        if (wsAgent != null) {
                            cachedAgentUrl = wsAgent.getUrl();
                        }
                    }
                }
            } catch (ApiException | IOException ex) {
                LOG.warn(ex.getLocalizedMessage());
                throw new RuntimeException("Failed to configure wsagent endpoint");
            }
        }
        return cachedAgentUrl;
    }

