  /**
   * Save IDE state of current workspace for given user. Note: it is expected that incoming IDE
   * state object is valid, so any validations are not performed.
   *
   * @param userId user identifier
   * @param json IDE state in JSON format
   * @throws ValidationException when user identifier is {@code null} or empty
   * @throws ServerException when any server error occurs
   */
  public void saveState(String userId, String json) throws ValidationException, ServerException {
    checkUserIdentifier(userId);

    String appStateHolderPath = getAppStateHolderPath(userId);
    try {
      if (fsManager.existsAsFile(appStateHolderPath)) {
        fsManager.update(appStateHolderPath, json);
      } else {
        fsManager.createFile(appStateHolderPath, json, false, true);
      }
    } catch (NotFoundException | ConflictException e) {
      LOG.error("Can not save app state for user %s, the reason is: %s", userId, e.getCause());
      throw new ServerException("Can not save app state for user " + userId);
    }
  }

