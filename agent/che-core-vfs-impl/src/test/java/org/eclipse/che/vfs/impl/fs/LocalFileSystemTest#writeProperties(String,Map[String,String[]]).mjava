    protected java.io.File writeProperties(String vfsPath, Map<String, String[]> properties)
            throws IOException {
        java.io.File file = getIoFile(vfsPath);
        java.io.File propsDir = new java.io.File(file.getParentFile(), FSMountPoint.PROPS_DIR);
        if (!(propsDir.exists() || propsDir.mkdirs())) {
            fail();
        }

        java.io.File propsFile = new java.io.File(propsDir, file.getName() + FSMountPoint.PROPERTIES_FILE_SUFFIX);
        try (DataOutputStream dos = new DataOutputStream(new BufferedOutputStream(new FileOutputStream(propsFile)))) {
            propertiesSerializer.write(dos, properties);
        }

        return propsFile;
    }

