    protected int createTree(String parent, int numberItemsEachLevel, int depth, Map<String, String[]> properties, String suffix)
            throws Exception {
        if (depth == 0) {
            return 0;
        }
        int num = 0;
        for (int i = 0; i < numberItemsEachLevel; i++, num++) {
            String newName = generate(null, 8);
            String newPath = parent + '/' + newName;
            java.io.File f = getIoFile(newPath);

            if (i % 2 == 0) {
                assertTrue(String.format("Failed create %s", newPath), f.mkdirs());
            } else {
                if (suffix != null) {
                    newPath += suffix;
                }
                writeFile(newPath, DEFAULT_CONTENT_BYTES);
            }

            if (!(properties == null || properties.isEmpty())) {
                writeProperties(newPath, properties);
            }

            if (f.isDirectory()) {
                num += createTree(newPath, numberItemsEachLevel, depth - 1, properties, suffix);
            }
        }
        return num;
    }

