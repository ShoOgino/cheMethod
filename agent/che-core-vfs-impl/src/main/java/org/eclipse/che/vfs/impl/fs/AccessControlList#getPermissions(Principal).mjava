    public Set<String> getPermissions(Principal principal) {
        if (permissionMap.isEmpty()) {
            return null;
        }
        Set<String> userPermissions = permissionMap.get(principal);
        if (userPermissions == null) {
            return null;
        }
        return new HashSet<>(userPermissions);
    }

