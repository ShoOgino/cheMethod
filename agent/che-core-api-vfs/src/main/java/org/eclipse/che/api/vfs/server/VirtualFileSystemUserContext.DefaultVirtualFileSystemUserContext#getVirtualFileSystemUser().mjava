        public VirtualFileSystemUser getVirtualFileSystemUser() {
            final EnvironmentContext context = EnvironmentContext.getCurrent();

            final User user = context.getUser();
            if (user == null) {
                return new VirtualFileSystemUser(VirtualFileSystemInfo.ANONYMOUS_PRINCIPAL, Collections.<String>emptySet());
            }
            final Set<String> groups = new HashSet<>(2);
            if (user.isMemberOf("workspace/developer")) {
                groups.add("workspace/developer");
            }
            if (user.isMemberOf("system/admin")) {
                groups.add("workspace/developer");
            }
            if (user.isMemberOf("workspace/admin")) {
                groups.add("workspace/admin");
            }
            return new VirtualFileSystemUser(user.getId(), groups);
        }

