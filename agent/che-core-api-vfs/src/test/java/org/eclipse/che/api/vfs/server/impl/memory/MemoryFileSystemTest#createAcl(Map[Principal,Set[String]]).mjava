    protected List<AccessControlEntry> createAcl(Map<Principal, Set<String>> permissions) {
        final List<AccessControlEntry> acl = new ArrayList<>(permissions.size());
        for (Map.Entry<Principal, Set<String>> e : permissions.entrySet()) {
            final Set<String> basicPermissions = e.getValue();
            final Principal principal = e.getKey();
            final List<String> plainPermissions = new ArrayList<>(basicPermissions.size());
            for (String permission : e.getValue()) {
                plainPermissions.add(permission);
            }
            final Principal copyPrincipal = DtoFactory.getInstance().clone(principal);
            final AccessControlEntry ace = DtoFactory.getInstance().createDto(AccessControlEntry.class)
                                                     .withPrincipal(copyPrincipal).withPermissions(plainPermissions);
            acl.add(ace);
        }
        return acl;
    }

