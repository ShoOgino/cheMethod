    protected void validateLinks(Item item) throws Exception {
        Map<String, Link> links = item.getLinks();

        if (links.size() == 0) {
            fail("Links not found. ");
        }

        Link link = links.get(Link.REL_SELF);
        assertNotNull("'" + Link.REL_SELF + "' link not found. ", link);
        assertEquals(MediaType.APPLICATION_JSON, link.getType());
        assertEquals(Link.REL_SELF, link.getRel());
        assertEquals(UriBuilder.fromPath(SERVICE_URI).path("item").path(item.getId()).build().toString(), link.getHref());

        link = links.get(Link.REL_PARENT);
        if (item.getParentId() == null) {
            assertNull("'" + Link.REL_PARENT + "' link not allowed for root folder. ", link);
        } else {
            assertNotNull("'" + Link.REL_PARENT + "' link not found. ", link);
            assertEquals(MediaType.APPLICATION_JSON, link.getType());
            assertEquals(Link.REL_PARENT, link.getRel());
            assertEquals(UriBuilder.fromPath(SERVICE_URI).path("item").path(item.getParentId()).build().toString(),
                         link.getHref());
        }

        link = links.get(Link.REL_ACL);
        assertNotNull("'" + Link.REL_ACL + "' link not found. ", link);
        assertEquals(MediaType.APPLICATION_JSON, link.getType());
        assertEquals(Link.REL_ACL, link.getRel());
        assertEquals(UriBuilder.fromPath(SERVICE_URI).path("acl").path(item.getId()).build().toString(), link.getHref());

        link = links.get(Link.REL_DELETE);
        if (item.getParentId() == null) {
            assertNull("'" + Link.REL_DELETE + "' link not allowed for root folder. ", link);
        } else {
            assertNotNull("'" + Link.REL_DELETE + "' link not found. ", link);
            assertEquals(null, link.getType());
            assertEquals(Link.REL_DELETE, link.getRel());
            if (item.getItemType() == ItemType.FILE && ((File)item).isLocked()) {
                assertEquals(
                        UriBuilder.fromPath(SERVICE_URI).path("delete").path(item.getId())
                                  .queryParam("lockToken", "[lockToken]").build().toString(), link.getHref());
            } else {
                assertEquals(UriBuilder.fromPath(SERVICE_URI).path("delete").path(item.getId()).build().toString(),
                             link.getHref());
            }
        }

        link = links.get(Link.REL_COPY);
        if (item.getParentId() == null) {
            assertNull("'" + Link.REL_COPY + "' link not allowed for root folder. ", link);
        } else {
            assertNotNull("'" + Link.REL_COPY + "' link not found. ", link);
            assertEquals(MediaType.APPLICATION_JSON, link.getType());
            assertEquals(Link.REL_COPY, link.getRel());
            assertEquals(
                    UriBuilder.fromPath(SERVICE_URI).path("copy").path(item.getId()).queryParam("parentId", "[parentId]")
                              .build().toString(), link.getHref());
        }

        link = links.get(Link.REL_MOVE);
        if (item.getParentId() == null) {
            assertNull("'" + Link.REL_MOVE + "' link not allowed for root folder. ", link);
        } else {
            assertNotNull("'" + Link.REL_MOVE + "' link not found. ", link);
            assertEquals(MediaType.APPLICATION_JSON, link.getType());
            assertEquals(Link.REL_MOVE, link.getRel());
            if (item.getItemType() == ItemType.FILE && ((File)item).isLocked()) {
                assertEquals(
                        UriBuilder.fromPath(SERVICE_URI).path("move").path(item.getId()).queryParam("parentId", "[parentId]")
                                  .queryParam("lockToken", "[lockToken]").build().toString(), link.getHref());
            } else {
                assertEquals(
                        UriBuilder.fromPath(SERVICE_URI).path("move").path(item.getId()).queryParam("parentId", "[parentId]")
                                  .build().toString(), link.getHref());
            }
        }

        ItemType type = item.getItemType();
        if (type == ItemType.FILE) {
            File file = (File)item;

            link = links.get(Link.REL_CONTENT);
            assertNotNull("'" + Link.REL_CONTENT + "' link not found. ", link);
            assertEquals(file.getMimeType(), link.getType());
            assertEquals(Link.REL_CONTENT, link.getRel());
            assertEquals(UriBuilder.fromPath(SERVICE_URI).path("content").path(file.getId()).build().toString(),
                         link.getHref());

            link = links.get(Link.REL_DOWNLOAD_FILE);
            assertNotNull("'" + Link.REL_DOWNLOAD_FILE + "' link not found. ", link);
            assertEquals(file.getMimeType(), link.getType());
            assertEquals(Link.REL_DOWNLOAD_FILE, link.getRel());
            assertEquals(UriBuilder.fromPath(SERVICE_URI).path("downloadfile").path(file.getId()).build().toString(),
                         link.getHref());

            link = links.get(Link.REL_CONTENT_BY_PATH);
            assertNotNull("'" + Link.REL_CONTENT_BY_PATH + "' link not found. ", link);
            assertEquals(file.getMimeType(), link.getType());
            assertEquals(Link.REL_CONTENT_BY_PATH, link.getRel());
            assertEquals(UriBuilder.fromPath(SERVICE_URI).path("contentbypath").path(file.getPath().substring(1)).build()
                                   .toString(), link.getHref());

            link = links.get(Link.REL_CURRENT_VERSION);
            assertNotNull("'" + Link.REL_CURRENT_VERSION + "' link not found. ", link);
            assertEquals(MediaType.APPLICATION_JSON, link.getType());
            assertEquals(Link.REL_CURRENT_VERSION, link.getRel());
            // Versioning not supported. Have only one version of file so id of file is always id of current version.
            String expectedCurrentVersionId = file.getId();
            assertEquals(UriBuilder.fromPath(SERVICE_URI).path("item").path(expectedCurrentVersionId).build().toString(),
                         link.getHref());

            link = links.get(Link.REL_VERSION_HISTORY);
            assertNotNull("'" + Link.REL_VERSION_HISTORY + "' link not found. ", link);
            assertEquals(MediaType.APPLICATION_JSON, link.getType());
            assertEquals(Link.REL_VERSION_HISTORY, link.getRel());
            assertEquals(UriBuilder.fromPath(SERVICE_URI).path("version-history").path(file.getId()).build().toString(),
                         link.getHref());

            link = links.get(Link.REL_LOCK);
            if (file.isLocked()) {
                assertNull("'" + Link.REL_LOCK + "' link not allowed for locked files. ", link);
                link = links.get(Link.REL_UNLOCK);
                assertEquals(null, link.getType());
                assertEquals(Link.REL_UNLOCK, link.getRel());
                assertEquals(
                        UriBuilder.fromPath(SERVICE_URI).path("unlock").path(file.getId())
                                  .queryParam("lockToken", "[lockToken]").build().toString(), link.getHref());
            } else {
                assertNotNull("'" + Link.REL_LOCK + "' link not found. ", link);
                assertEquals(MediaType.APPLICATION_JSON, link.getType());
                assertEquals(Link.REL_LOCK, link.getRel());
                assertEquals(UriBuilder.fromPath(SERVICE_URI).path("lock").path(file.getId())
                                       .queryParam("timeout", "[timeout]").build().toString(), link.getHref());
                link = links.get(Link.REL_UNLOCK);
                assertNull("'" + Link.REL_UNLOCK + "' link not allowed for unlocked files. ", link);
            }
        } else {
            link = links.get(Link.REL_CHILDREN);
            assertNotNull("'" + Link.REL_CHILDREN + "' link not found. ", link);
            assertEquals(MediaType.APPLICATION_JSON, link.getType());
            assertEquals(Link.REL_CHILDREN, link.getRel());
            assertEquals(UriBuilder.fromPath(SERVICE_URI).path("children").path(item.getId()).build().toString(),
                         link.getHref());

            link = links.get(Link.REL_CREATE_FOLDER);
            assertNotNull("'" + Link.REL_CREATE_FOLDER + "' link not found. ", link);
            assertEquals(MediaType.APPLICATION_JSON, link.getType());
            assertEquals(Link.REL_CREATE_FOLDER, link.getRel());
            assertEquals(UriBuilder.fromPath(SERVICE_URI).path("folder").path(item.getId()).queryParam("name", "[name]")
                                   .build().toString(), link.getHref());

            link = links.get(Link.REL_CREATE_FILE);
            assertNotNull("'" + Link.REL_CREATE_FILE + "' link not found. ", link);
            assertEquals(MediaType.APPLICATION_JSON, link.getType());
            assertEquals(Link.REL_CREATE_FILE, link.getRel());
            assertEquals(UriBuilder.fromPath(SERVICE_URI).path("file").path(item.getId()).queryParam("name", "[name]")
                                   .build().toString(), link.getHref());

            link = links.get(Link.REL_UPLOAD_FILE);
            assertNotNull("'" + Link.REL_UPLOAD_FILE + "' link not found. ", link);
            assertEquals(MediaType.TEXT_HTML, link.getType());
            assertEquals(Link.REL_UPLOAD_FILE, link.getRel());
            assertEquals(UriBuilder.fromPath(SERVICE_URI).path("uploadfile").path(item.getId()).build().toString(),
                         link.getHref());

            link = links.get(Link.REL_EXPORT);
            assertNotNull("'" + Link.REL_EXPORT + "' link not found. ", link);
            assertEquals(ExtMediaType.APPLICATION_ZIP, link.getType());
            assertEquals(Link.REL_EXPORT, link.getRel());
            assertEquals(UriBuilder.fromPath(SERVICE_URI).path("export").path(item.getId()).build().toString(),
                         link.getHref());

            link = links.get(Link.REL_IMPORT);
            assertNotNull("'" + Link.REL_IMPORT + "' link not found. ", link);
            assertEquals(ExtMediaType.APPLICATION_ZIP, link.getType());
            assertEquals(Link.REL_IMPORT, link.getRel());
            assertEquals(UriBuilder.fromPath(SERVICE_URI).path("import").path(item.getId()).build().toString(),
                         link.getHref());

            link = links.get(Link.REL_DOWNLOAD_ZIP);
            assertNotNull("'" + Link.REL_DOWNLOAD_ZIP + "' link not found. ", link);
            assertEquals(ExtMediaType.APPLICATION_ZIP, link.getType());
            assertEquals(Link.REL_DOWNLOAD_ZIP, link.getRel());
            assertEquals(UriBuilder.fromPath(SERVICE_URI).path("downloadzip").path(item.getId()).build().toString(),
                         link.getHref());

            link = links.get(Link.REL_UPLOAD_ZIP);
            assertNotNull("'" + Link.REL_UPLOAD_ZIP + "' link not found. ", link);
            assertEquals(MediaType.TEXT_HTML, link.getType());
            assertEquals(Link.REL_UPLOAD_ZIP, link.getRel());
            assertEquals(UriBuilder.fromPath(SERVICE_URI).path("uploadzip").path(item.getId()).build().toString(),
                         link.getHref());
        }
    }

