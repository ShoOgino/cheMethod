    protected void checkPage(String url, String httpMethod, Map<String, List<String>> headers, byte[] body, Method m,
                             List<Object> expected) throws Exception {
        ByteArrayContainerResponseWriter writer = new ByteArrayContainerResponseWriter();
        ContainerResponse response = launcher.service(httpMethod, url, BASE_URI, headers, body, writer, null);
        assertEquals(200, response.getStatus());
        @SuppressWarnings("unchecked")
        List<Item> items = ((ItemList)response.getEntity()).getItems();
        List<Object> all = new ArrayList<>(expected.size());
        for (Item i : items) {
            validateLinks(i);
            all.add(m.invoke(i));
        }
        assertEquals(all, expected);
    }

