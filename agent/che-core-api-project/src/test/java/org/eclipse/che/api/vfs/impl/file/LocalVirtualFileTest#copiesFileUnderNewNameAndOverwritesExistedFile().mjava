    @Test
    public void copiesFileUnderNewNameAndOverwritesExistedFile() throws Exception {
        VirtualFile root = getRoot();
        VirtualFile file = root.createFile(generateFileName(), DEFAULT_CONTENT);
        file.setProperty("property1", "value1");
        VirtualFile targetFolder = root.createFolder(generateFolderName());
        targetFolder.createFile("existed_name", "existed content");

        VirtualFile copy = file.copyTo(targetFolder, "existed_name", true);

        assertionHelper.assertThatIoFilesHaveSameContent(file.getPath(), copy.getPath());
        assertionHelper.assertThatMetadataIoFilesHaveSameContent(file.getPath(), copy.getPath());
    }

