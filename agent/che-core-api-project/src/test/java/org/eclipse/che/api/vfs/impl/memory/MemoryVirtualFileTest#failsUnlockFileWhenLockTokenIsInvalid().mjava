    @Test
    public void failsUnlockFileWhenLockTokenIsInvalid() throws Exception {
        VirtualFile root = getRoot();
        VirtualFile file = root.createFile(generateFileName(), DEFAULT_CONTENT);
        String invalidLockToken = invalidateLockToken(file.lock(0));
        try {
            file.unlock(invalidLockToken);
            thrown.expect(ForbiddenException.class);
        } catch (ForbiddenException e) {
            assertTrue(file.isLocked());
        }
    }

