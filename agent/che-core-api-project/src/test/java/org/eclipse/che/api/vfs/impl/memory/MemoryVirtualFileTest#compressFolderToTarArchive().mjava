    @Test
    public void compressFolderToTarArchive() throws Exception {
        VirtualFile folder = getRoot().createFolder(generateFolderName());
        Archiver archiver = mock(Archiver.class);
        when(archiverFactory.createArchiver(eq(folder), eq("tar"))).thenReturn(archiver);
        folder.tar();
        verify(archiver).compress(any(OutputStream.class));
    }

