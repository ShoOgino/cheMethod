    private byte[] serializeVirtualFileMetadata(Map<String, String> properties) throws IOException {
        ByteArrayOutputStream byteOutput = new ByteArrayOutputStream();
        DataOutputStream dataOutput = new DataOutputStream(byteOutput);
        new FileMetadataSerializer().write(dataOutput, properties);
        return byteOutput.toByteArray();
    }

