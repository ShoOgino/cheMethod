    @Test
    public void updatesFolderInSearcherWhenItIsRenamed() throws Exception {
        VirtualFile folder = getRoot().createFolder(generateFolderName());
        String oldPath = folder.getPath().toString();
        Mockito.reset(searcher);
        VirtualFile renamed = folder.rename("new_name");
        verify(searcher).add(renamed);
        verify(searcher).delete(oldPath, false);
    }

