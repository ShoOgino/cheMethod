    /**
     * Creates entity of {@link Watcher} to listen changes on file system.
     *
     * @param dir
     *         directory which will be registered via watcher
     * @param filesBuffer
     *         buffer which need to separate actions IDE and file systems
     * @param recursive
     *         <code>true</code> watcher will be registered on current directory and all inner directories
     *         <code>false</code>  watcher will be registered only on current directory
     * @throws IOException
     */
    Watcher(Path dir, FilesBuffer filesBuffer, boolean recursive) throws IOException {
        this.watcher = FileSystems.getDefault().newWatchService();
        this.keys = new HashMap<>();
        this.recursive = recursive;
        this.filesBuffer = filesBuffer;
        this.pathToRoot = dir.toString();

        if (recursive) {
            registerAll(dir);
        } else {
            register(dir);
        }
    }

