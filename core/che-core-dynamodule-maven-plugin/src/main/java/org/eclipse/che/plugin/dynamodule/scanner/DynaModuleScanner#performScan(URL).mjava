  /**
   * Performs the scan of the URL.
   *
   * @param url the url to analyze
   * @throws URISyntaxException
   * @throws IOException
   */
  protected void performScan(URL url) throws URISyntaxException, IOException {

    long start = System.currentTimeMillis();

    // scan is based upon the type of the URL
    Path path = Paths.get(url.toURI());
    if (Files.isDirectory(path)) {
      scanDirectory(path);
    } else {
      if (path.toString().endsWith(".jar") || path.toString().endsWith(".war")) {
        if (scanJarInWarDependencies && path.toString().endsWith(".war")) {
          scanDeepWar(path);
        } else {
          try (JarFile jarFile = new JarFile(path.toFile())) {
            scanJar(jarFile);
          }
        }
      } else if (path.toString().endsWith(".class")) {
        scanFile(path);
      }
    }
    long end = System.currentTimeMillis();
    times.add(new UrlTime(url, (end - start)));
  }

