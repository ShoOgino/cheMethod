  /**
   * Patches the IDE GWT module by replacing inheritance of Full.gwt.xml by
   * Full-with-excludes.gwt.xml.
   */
  private void patchGwtModule() throws XmlPullParserException, IOException {
    String gwtModuleFileRelPath = getGwtModule().replace('.', '/') + ".gwt.xml";
    Path gwtModuleFilePath = Paths.get(outputDirectory.getPath(), gwtModuleFileRelPath);

    Xpp3Dom module = Xpp3DomBuilder.build(Files.newInputStream(gwtModuleFilePath), UTF_8.name());

    for (int i = module.getChildCount() - 1; i >= 0; i--) {
      Xpp3Dom child = module.getChild(i);

      if ("inherits".equals(child.getName())) {
        String moduleName = child.getAttribute("name");

        if (moduleName.equals(fullIdeGwtModule)) {
          child.setAttribute("name", fullIdeGwtModule + FULL_IDE_GWT_MODULE_SUFFIX);
          break;
        }
      }
    }

    try (Writer writer = new StringWriter()) {
      XMLWriter xmlWriter = new PrettyPrintXMLWriter(writer);
      Xpp3DomWriter.write(xmlWriter, module);
      Files.write(gwtModuleFilePath, writer.toString().getBytes());
    }
  }

