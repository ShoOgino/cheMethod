    @Test
    public void shouldGenerateFactoryJsonIncludeAllProjects() throws Exception {
        // given
        final String wsId = "workspace123234";
        UsersWorkspaceImpl.UsersWorkspaceImplBuilder ws = UsersWorkspaceImpl.builder();
        ws.setId(wsId);
        ws.setProjects(Arrays.asList(dto.createDto(ProjectConfigDto.class)
                                        .withSource(dto.createDto(SourceStorageDto.class)
                                                       .withType("git")
                                                       .withLocation("location")),
                                     dto.createDto(ProjectConfigDto.class)
                                        .withSource(dto.createDto(SourceStorageDto.class)
                                                       .withType("git")
                                                       .withLocation("location"))));
        ws.setName("wsname");
        ws.setOwner("id-2314");
        ws.setDefaultEnv("env1");
        ws.setEnvironments(Collections.singletonList(dto.createDto(EnvironmentDto.class).withName("env1")));
        ws.setStatus(WorkspaceStatus.RUNNING);
        ws.setCommands(Collections.singletonList(dto.createDto(CommandDto.class)
                                                    .withName("MCI")
                                                    .withType("mvn")
                                                    .withCommandLine("clean install")));

        UsersWorkspaceImpl usersWorkspace = ws.build();
        when(workspaceManager.getWorkspace(eq(wsId))).thenReturn(usersWorkspace);

        // when
        Response response = given().auth()
                                   .basic(JettyHttpServer.ADMIN_USER_NAME, JettyHttpServer.ADMIN_USER_PASSWORD)
                                   .when()
                                   .get("/private" + SERVICE_PATH + "/workspace/" + wsId);

        // then
        assertEquals(response.getStatusCode(), 200);
        Factory result = dto.createDtoFromJson(response.getBody().asString(), Factory.class);
        assertEquals(result.getWorkspace().getProjects().size(), 2);
        assertEquals(result.getWorkspace().getName(), usersWorkspace.getName());
        assertEquals(result.getWorkspace().getEnvironments().get(0).toString(),
                     asDto(usersWorkspace.getEnvironments().get(0)).toString());
        assertEquals(result.getWorkspace().getCommands().get(0), asDto(usersWorkspace.getCommands().get(0)));
    }

