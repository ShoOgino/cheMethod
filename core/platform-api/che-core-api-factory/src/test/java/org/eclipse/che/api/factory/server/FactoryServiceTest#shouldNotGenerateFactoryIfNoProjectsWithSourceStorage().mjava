    @Test
    public void shouldNotGenerateFactoryIfNoProjectsWithSourceStorage() throws Exception {
        // given
        final String wsId = "workspace123234";
        UsersWorkspaceImpl.UsersWorkspaceImplBuilder ws = UsersWorkspaceImpl.builder();
        WorkspaceConfigImpl.WorkspaceConfigImplBuilder wsConfig = WorkspaceConfigImpl.builder();
        ws.setId(wsId);
        wsConfig.setProjects(Arrays.asList(dto.createDto(ProjectConfigDto.class)
                                        .withPath("/proj1"),
                                     dto.createDto(ProjectConfigDto.class)
                                        .withPath("/proj2")));
        wsConfig.setName("wsname");
        ws.setOwner("id-2314");
        wsConfig.setEnvironments(Collections.singletonList(dto.createDto(EnvironmentDto.class).withName("env1")));
        wsConfig.setDefaultEnv("env1");
        ws.setStatus(WorkspaceStatus.RUNNING);
        wsConfig.setCommands(Collections.singletonList(
                dto.createDto(CommandDto.class).withName("MCI").withType("mvn").withCommandLine("clean install")));
        ws.setConfig(wsConfig.build());

        UsersWorkspaceImpl usersWorkspace = ws.build();
        when(workspaceManager.getWorkspace(eq(wsId))).thenReturn(usersWorkspace);

        // when
        Response response = given().auth()
                                   .basic(JettyHttpServer.ADMIN_USER_NAME, JettyHttpServer.ADMIN_USER_PASSWORD)
                                   .when()
                                   .get("/private" + SERVICE_PATH + "/workspace/" + wsId);

        // then
        assertEquals(response.getStatusCode(), Status.BAD_REQUEST.getStatusCode());
    }

