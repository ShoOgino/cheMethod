    @POST
    @Path("/{accountId}/{workspaceId}")
    @Produces(APPLICATION_JSON)
    @RolesAllowed("account/owner")
    public AccountDescriptor registerWorkspace(@PathParam("accountId") String accountId, @PathParam("workspaceId") String workspaceId)
            throws NotFoundException, ServerException, BadRequestException, ConflictException {
        Account account = accountDao.getById(accountId);
        Workspace workspace = workspaceManager.getWorkspace(workspaceId);
        if (accountDao.isWorkspaceRegistered(workspaceId)) {
            throw new ConflictException("Workspace '" + workspaceId + "' already registered in another account");
        }
        if (account.getWorkspaces().contains(workspace)) {
            throw new ConflictException(format("Workspace '%s' is already registered in this account", workspaceId));
        }
        account.getWorkspaces().add(workspace);
        accountDao.update(account);
        return toDescriptor(account);
    }

