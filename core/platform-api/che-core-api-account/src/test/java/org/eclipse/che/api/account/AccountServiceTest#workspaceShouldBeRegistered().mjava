    @Test
    public void workspaceShouldBeRegistered() throws Exception {
        UsersWorkspaceImpl workspace = spy(createUsersWorkspace());
        Account account = new Account("account123");
        when(workspace.getId()).thenReturn("workspace123");
        when(workspaceManager.getWorkspace(any())).thenReturn(workspace);
        when(accountDao.getById(account.getId())).thenReturn(account);
        when(accountDao.getByWorkspace(workspace.getId())).thenThrow(new NotFoundException(""));

        ContainerResponse response = makeRequest(POST, SERVICE_PATH + '/' + account.getId() + '/' + workspace.getId(), null, null);

        assertEquals(response.getStatus(), 200);
        AccountDescriptor descriptor = (AccountDescriptor)response.getEntity();
        assertEquals(descriptor.getWorkspaces().size(), 1);
        assertEquals(descriptor.getWorkspaces().get(0).getId(), workspace.getId());
        verify(accountDao).update(account);
    }

