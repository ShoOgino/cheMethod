    @Test
    public void shouldFailWorkspaceRegistrationWhenAccountAlreadyContainsGivenWorkspace() throws Exception {
        UsersWorkspaceImpl workspace = mock(UsersWorkspaceImpl.class);
        Account account = new Account("account123");
        account.setWorkspaces(singletonList(workspace));
        when(workspace.getId()).thenReturn("workspace123");
        when(workspaceManager.getWorkspace(any())).thenReturn(workspace);
        when(accountDao.getById(account.getId())).thenReturn(account);

        ContainerResponse response = makeRequest(POST, SERVICE_PATH + '/' + account.getId() + '/' + workspace.getId(), null, null);

        assertEquals(response.getEntity().toString(), "Workspace 'workspace123' is already registered in this account");
    }

