    private MetricHandler instantiateMetricHandler() throws NoSuchMethodException,
                                                            IllegalAccessException,
                                                            InvocationTargetException,
                                                            InstantiationException {
        Properties properties;
        try {
            properties = readAnalyticsProperties();
        } catch (IOException e) {
            LOG.warn("Error reading " + ANALYTICS_CONF_FILENAME + " " + e.getMessage());
            return new DummyMetricHandler();
        }

        String clazzName = (String)properties.get(METRIC_HANDLER_CLASS_NAME);
        if (clazzName == null) {
            return new DummyMetricHandler();

        } else {
            try {
                Class<?> clazz = Class.forName(clazzName);

                try {
                    return (MetricHandler)clazz.getConstructor(Properties.class).newInstance(properties);
                } catch (NoSuchMethodException e) {
                    return (MetricHandler)clazz.getConstructor().newInstance();
                }
            } catch (ClassNotFoundException e) {
                return new DummyMetricHandler();
            }
        }
    }

