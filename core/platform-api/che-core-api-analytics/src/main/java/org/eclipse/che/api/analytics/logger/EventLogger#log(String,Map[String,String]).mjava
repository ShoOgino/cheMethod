    public void log(String event, Map<String, String> parameters) throws UnsupportedEncodingException {
        if (event != null && ALLOWED_EVENTS.contains(event)) {
            if (event.equals(DASHBOARD_USAGE)) {
                parameters.put(EventLogger.SOURCE_PARAM, EventLogger.DASHBOARD_SOURCE);
            }

            validate(parameters);

            String message = createMessage(event, parameters);
            if (!offerEvent(message)) {
                if (ignoredEvents++ % 1000 == 0) {
                    LOG.warn("Ignored " + ignoredEvents + " events due to maximum queue capacity");
                }
            }
        }
    }

