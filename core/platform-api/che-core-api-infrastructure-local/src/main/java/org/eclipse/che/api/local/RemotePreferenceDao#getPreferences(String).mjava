    @Override
    public Map<String, String> getPreferences(String userId) throws ServerException {
        checkUserId(requireNonNull(userId, "Required non-null user id"));
        try {
            return requestFactory.fromUrl(prefsUrl)
                                 .useGetMethod()
                                 .request()
                                 .asProperties();
        } catch (IOException | UnauthorizedException | ForbiddenException | ConflictException | NotFoundException | BadRequestException ex) {
            throw new ServerException(ex.getLocalizedMessage(), ex);
        }
    }

