    @Test
    public void testSnapshotsSerialization() throws Exception {
        final SnapshotImpl snapshot = createSnapshot();

        snapshotDao.saveSnapshot(snapshot);
        snapshotDao.saveSnapshots();

        assertEquals(GSON.toJson(singletonMap(snapshot.getId(), snapshot)), new String(readAllBytes(snapshotsPath)));
    }

