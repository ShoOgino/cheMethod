    /**
     * Check we have a valid user which has the 'user' role with 'system' scope
     */
    @Test
    public void checkUserWithSystemScope() throws Exception {
        when(securityContext.isUserInRole("user")).thenReturn(true);

        final ContainerResponse response = makeRequest(HttpMethod.GET, SERVICE_PATH + "/inrole?role=user&scope=system", null);

        assertEquals(response.getStatus(), OK.getStatusCode());
        final UserInRoleDescriptor userInRoleDescriptor = (UserInRoleDescriptor)response.getEntity();

        assertNotNull(userInRoleDescriptor);
        assertEquals(userInRoleDescriptor.getIsInRole(), true);
        assertEquals(userInRoleDescriptor.getScope(), "system");
        assertEquals(userInRoleDescriptor.getScopeId(), "");
    }

