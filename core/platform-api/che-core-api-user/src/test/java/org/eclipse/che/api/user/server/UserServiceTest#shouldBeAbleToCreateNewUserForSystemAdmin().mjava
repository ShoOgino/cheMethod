    @Test
    public void shouldBeAbleToCreateNewUserForSystemAdmin() throws Exception {
        final NewUser newUser = DtoFactory.getInstance()
                                          .createDto(NewUser.class)
                                          .withName("test")
                                          .withPassword("password123");
        when(securityContext.isUserInRole("system/admin")).thenReturn(true);

        final ContainerResponse response = makeRequest(HttpMethod.POST, SERVICE_PATH + "/create", newUser);

        assertEquals(response.getStatus(), CREATED.getStatusCode());
        final UserDescriptor descriptor = (UserDescriptor)response.getEntity();
        assertEquals(descriptor.getName(), newUser.getName());
        assertEquals(descriptor.getPassword(), "<none>");
        verify(userDao).create(any(User.class));
        verify(profileDao).create(any(Profile.class));
    }

