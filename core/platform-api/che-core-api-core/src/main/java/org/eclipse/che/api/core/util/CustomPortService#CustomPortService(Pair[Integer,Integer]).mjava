    public CustomPortService(Pair<Integer, Integer> range) {
        if (range.first < 0 || range.second > 65535) {
            throw new IllegalArgumentException(String.format("Invalid port range: [%d:%d]", range.first, range.second));
        }
        this.range = range;
        rnd = new SecureRandom();
        portsInUse = new ConcurrentHashMap<>();
    }

