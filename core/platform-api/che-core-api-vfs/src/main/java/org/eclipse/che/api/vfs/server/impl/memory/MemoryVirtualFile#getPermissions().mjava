    @Override
    public Map<Principal, Set<String>> getPermissions() {
        checkExist();
        final Map<Principal, Set<String>> copy = new HashMap<>(permissionsMap.size());
        for (Map.Entry<Principal, Set<String>> e : permissionsMap.entrySet()) {
            final Principal copyPrincipal = DtoFactory.getInstance().clone(e.getKey());
            copy.put(copyPrincipal, new LinkedHashSet<>(e.getValue()));
        }
        return copy;
    }

