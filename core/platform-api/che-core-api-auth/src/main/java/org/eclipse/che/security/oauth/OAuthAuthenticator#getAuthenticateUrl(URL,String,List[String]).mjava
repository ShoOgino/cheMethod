    /**
     * Create authentication URL.
     *
     * @param requestUrl
     *         URL of current HTTP request. This parameter required to be able determine URL for redirection after
     *         authentication. If URL contains query parameters they will be copy to 'state' parameter and returned to
     *         callback method.
     * @param userId
     *         user identifier. This parameter should be not <code>null</code> if user already authenticated in Codenvy site
     *         but need to get OAuth access token to be able use some third party services. This parameter always
     *         <code>null</code> if third party OAuth provider used for authenticate user in Codenvy.
     * @param scopes
     *         specify exactly what type of access needed
     * @return URL for authentication
     */
    public String getAuthenticateUrl(URL requestUrl, String userId, List<String> scopes) throws OAuthAuthenticationException {
        if (!isConfigured()) {
            throw new OAuthAuthenticationException("Authenticator is not configured");
        }

        AuthorizationCodeRequestUrl url = flow.newAuthorizationUrl().setRedirectUri(findRedirectUrl(requestUrl))
                                              .setScopes(scopes);
        url.setState(prepareState(requestUrl, userId));
        return url.build();
    }

