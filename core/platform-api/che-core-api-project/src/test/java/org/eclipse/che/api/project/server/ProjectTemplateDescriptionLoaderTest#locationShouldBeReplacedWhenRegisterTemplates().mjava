    @Test
    public void locationShouldBeReplacedWhenRegisterTemplates() throws Exception {
        URL resource = getClass().getClassLoader().getResource("che-templates/embed_type.json");

        //noinspection ConstantConditions
        final List<ProjectTemplateDescriptor> templates = DtoFactory.getInstance().createListDtoFromJson(resource.openStream(),
                                                                                                         ProjectTemplateDescriptor.class);
        ProjectTemplateDescriptor descriptor = templates.get(0);

        assertThat(descriptor.getSource().getLocation(), is(equalTo("${project.template_location_dir}")));

        //noinspection ConstantConditions
        new ProjectTemplateDescriptionLoader(resource.getPath(), templateRegistry);

        verify(templateRegistry).register(tagsCaptor.capture(), templateCaptor.capture());

        ProjectTemplateDescriptor descriptorWithNewLocation = templateCaptor.getValue();

        assertEquals(1, descriptor.getCommands().size());
        CommandDto commandDto = descriptor.getCommands().get(0);
        assertThat(commandDto.getCommandLine(), is(equalTo("echo \"hello\"")));
        assertThat(commandDto.getType(), is(equalTo("custom")));
        assertThat(commandDto.getName(), is(equalTo("customCommand")));

    }

