    @Test
    @SuppressWarnings("unchecked")
    public void testGetItemWithHandler() throws Exception {
        final Project myProject = pm.getProject(workspace, "my_project");
        GetItemHandler myHandler = new GetItemHandler() {
            @Override
            public void onGetItem(VirtualFileEntry virtualFile) {

                virtualFile.getAttributes().put("my", "myValue");
                if (virtualFile.isFile())
                    virtualFile.getAttributes().put("file", "a");
            }

            @Override
            public String getProjectType() {
                return "my_project_type";
            }
        };
        pm.getHandlers().register(myHandler);

        FolderEntry a = myProject.getBaseFolder().createFolder("a");
        a.createFolder("b");
        a.createFile("test.txt", "test".getBytes());
        ContainerResponse response = launcher.service(GET,
                                                      String.format("http://localhost:8080/api/project/%s/item/my_project/a/b", workspace),
                                                      "http://localhost:8080/api", null, null, null);
        assertEquals(response.getStatus(), 200, "Error: " + response.getEntity());

        ItemReference result = (ItemReference)response.getEntity();
        assertEquals(result.getName(), "b");
        assertNotNull(result.getCreated());
        assertNotNull(result.getModified());
        assertEquals(result.getAttributes().size(), 1);

        response = launcher.service(GET,
                                    String.format("http://localhost:8080/api/project/%s/item/my_project/a/test.txt", workspace),
                                    "http://localhost:8080/api", null, null, null);
        assertEquals(response.getStatus(), 200, "Error: " + response.getEntity());
        result = (ItemReference)response.getEntity();
        assertEquals(result.getType(), "file");
        assertEquals(result.getMediaType(), TEXT_PLAIN);
        assertNotNull(result.getContentLength());
        assertEquals(result.getAttributes().size(), 2);
    }

