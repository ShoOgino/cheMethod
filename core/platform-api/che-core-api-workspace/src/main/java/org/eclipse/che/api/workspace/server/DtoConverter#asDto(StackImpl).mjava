    /**
     * Convert {@link StackImpl} to {@link StackDto}
     */
    public static StackDto asDto(StackImpl stack) {
        WorkspaceConfigDto workspaceConfigDto = null;
        if (stack.getWorkspaceConfig() != null) {
            workspaceConfigDto = asDto(stack.getWorkspaceConfig());
        }

        StackSourceDto stackSourceDto = null;
        StackSource source = stack.getSource();
        if (source != null) {
            stackSourceDto = newDto(StackSourceDto.class).withType(source.getType()).withOrigin(source.getOrigin());
        }

        List<StackComponentDto> componentsDto = null;
        if (stack.getComponents() != null) {
            componentsDto = stack.getComponents()
                                 .stream()
                                 .map(component -> newDto(StackComponentDto.class).withName(component.getName())
                                                                                  .withVersion(component.getVersion()))
                                 .collect(toList());
        }

        PermissionsDescriptor permissionsDescriptor = null;
        if (stack.getPermissions() != null) {
            Permissions permissions = stack.getPermissions();

            List<GroupDescriptor> groups = permissions.getGroups()
                                                      .stream()
                                                      .map(descriptor -> newDto(GroupDescriptor.class).withName(descriptor.getName())
                                                                                                      .withAcl(descriptor.getAcl())
                                                                                                      .withUnit(descriptor.getUnit()))
                                                      .collect(toList());

            permissionsDescriptor = newDto(PermissionsDescriptor.class).withGroups(groups)
                                                                       .withUsers(permissions.getUsers());
        }

        return newDto(StackDto.class).withId(stack.getId())
                                     .withName(stack.getName())
                                     .withDescription(stack.getDescription())
                                     .withCreator(stack.getCreator())
                                     .withScope(stack.getScope())
                                     .withTags(stack.getTags())
                                     .withComponents(componentsDto)
                                     .withWorkspaceConfig(workspaceConfigDto)
                                     .withSource(stackSourceDto)
                                     .withPermissions(permissionsDescriptor);
    }

