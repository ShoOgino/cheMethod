    /**
     * Adds given machine to the running workspace, if the workspace exists.
     * Sets up this machine as dev-machine if it is dev.
     *
     * @return true if machine was added to the workspace(workspace exists) and false otherwise
     */
    @VisibleForTesting
    boolean addRunningMachine(MachineImpl machine) throws ServerException {
        lock.writeLock().lock();
        try {
            final RuntimeWorkspaceImpl workspace = idToWorkspaces.get(machine.getWorkspaceId());
            if (workspace != null) {
                if (machine.isDev()) {
                    workspace.setDevMachine(machine);
                }
                workspace.getMachines().add(machine);
            }
            return workspace != null;
        } finally {
            lock.writeLock().unlock();
        }
    }

