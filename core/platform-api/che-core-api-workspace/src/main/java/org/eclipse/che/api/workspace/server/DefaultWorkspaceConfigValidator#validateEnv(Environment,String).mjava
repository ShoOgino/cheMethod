    private void validateEnv(Environment environment, String workspaceName) throws BadRequestException {
        final String envName = environment.getName();
        checkArgument(!isNullOrEmpty(envName), "Environment name should be neither null nor empty");

        checkArgument(environment.getRecipe() == null || "docker".equals(environment.getRecipe().getType()),
                      "Recipe of environment '%s' in workspace with name '%s' has unsupported type '%s'",
                      envName,
                      workspaceName,
                      environment.getRecipe() != null ? environment.getRecipe().getType() : null);

        //machine configs
        checkArgument(!environment.getMachineConfigs().isEmpty(), "Environment '%s' should contain at least 1 machine", envName);

        final long devCount = environment.getMachineConfigs()
                                         .stream()
                                         .filter(MachineConfig::isDev)
                                         .count();
        checkArgument(devCount == 1,
                      "Environment should contain exactly 1 dev machine, but '%s' contains '%d'",
                      envName,
                      devCount);
        for (MachineConfig machineCfg : environment.getMachineConfigs()) {
            validateMachine(machineCfg, envName);
        }
    }

