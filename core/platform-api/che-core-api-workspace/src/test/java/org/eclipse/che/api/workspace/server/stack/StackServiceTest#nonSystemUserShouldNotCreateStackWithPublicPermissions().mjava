    @Test
    public void nonSystemUserShouldNotCreateStackWithPublicPermissions() {
        stackDto.setPermissions(permissionsDescriptor);
        when(checker.hasPublicSearchPermission(any(PermissionsDescriptor.class))).thenReturn(true);

        final Response response = given().auth()
                                         .basic(ADMIN_USER_NAME, ADMIN_USER_PASSWORD)
                                         .contentType(APPLICATION_JSON)
                                         .body(stackDto)
                                         .when()
                                         .post(SECURE_PATH + "/stack");

        assertEquals(response.getStatusCode(), 403);
        String expectedErrorMessage = "User '" + USER_ID + "' doesn't has access to use 'public: search' permission";
        assertEquals(unwrapDto(response, ServiceError.class).getMessage(), expectedErrorMessage);
    }

