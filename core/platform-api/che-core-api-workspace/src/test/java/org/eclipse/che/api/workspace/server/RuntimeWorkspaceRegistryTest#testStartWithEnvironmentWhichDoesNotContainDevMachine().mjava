    @Test(expectedExceptions = BadRequestException.class,
          expectedExceptionsMessageRegExp = "Couldn't start workspace '.*' from environment '.*', environment doesn't contain dev-machine")
    public void testStartWithEnvironmentWhichDoesNotContainDevMachine() throws Exception {
        final UsersWorkspaceImpl workspaceMock = workspaceMock();
        EnvironmentStateImpl state = new EnvironmentStateImpl(workspaceMock.getDefaultEnv(), new RecipeImpl().withType("docker"), null);
        state.setMachineConfigs(emptyList());
        when(workspaceMock.getEnvironments()).thenReturn(singletonList(state));

        registry.start(workspaceMock, workspaceMock.getDefaultEnv());
    }

