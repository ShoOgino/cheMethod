    private static UsersWorkspaceImpl workspaceMock() {
        // prepare default environment
        final EnvironmentImpl envState = mock(EnvironmentImpl.class, RETURNS_MOCKS);

        final Recipe recipe = mock(Recipe.class);
        when(recipe.getType()).thenReturn("docker");
        when(envState.getRecipe()).thenReturn(recipe);

        final MachineConfigImpl cfg = mock(MachineConfigImpl.class);
        when(cfg.isDev()).thenReturn(true);

        final MachineConfigImpl cf2 = mock(MachineConfigImpl.class);
        when(envState.getMachineConfigs()).thenReturn((asList(cfg, cf2)));

        // prepare workspace
        final RuntimeWorkspaceImpl workspace = mock(RuntimeWorkspaceImpl.class, RETURNS_MOCKS);
        final WorkspaceConfigImpl  wsConfig = mock(WorkspaceConfigImpl.class, RETURNS_MOCKS);
        when(workspace.getConfig()).thenReturn(wsConfig);
        when(wsConfig.getEnvironments()).thenReturn(Collections.singletonList(envState));
        when(workspace.getDevMachine()).thenReturn(mock(MachineImpl.class, RETURNS_MOCKS));
        when(workspace.getId()).thenReturn(WORKSPACE_ID);

        return workspace;
    }

