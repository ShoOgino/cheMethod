    /**
     * Get machine by ID, machine can be in running or not
     *
     * @param machineId
     *         id of machine
     * @throws NotFoundException
     *         if machine was not found
     * @throws MachineException
     *         if other error occurs
     */
    public synchronized MachineImpl getMachine(String machineId) throws NotFoundException, MachineException {
        MachineImpl machine = machines.get(machineId);
        if (machine == null) {
            final Instance instance = instances.get(machineId);
            if (instance == null) {
                throw new NotFoundException("Machine " + machineId + " is not found");
            }
            machine = toMachine(instance);
        }

        return machine;
    }

