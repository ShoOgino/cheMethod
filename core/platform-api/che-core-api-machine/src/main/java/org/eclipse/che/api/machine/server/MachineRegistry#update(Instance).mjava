    public synchronized void update(Instance instance) throws ConflictException, MachineException {
        if (!instances.containsKey(instance.getId()) && !states.containsKey(instance.getId())) {
            throw new ConflictException("Machine " + instance.getId() + " not found");
        } else {
            instances.put(instance.getId(), instance);
            states.remove(instance.getId());
        }
    }

