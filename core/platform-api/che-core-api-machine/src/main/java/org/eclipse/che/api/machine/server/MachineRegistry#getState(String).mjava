    public synchronized MachineStateImpl getState(String machineId) throws NotFoundException, MachineException {
        MachineStateImpl state = states.get(machineId);
        if (state == null) {
            if (instances.get(machineId) == null) {
                throw new NotFoundException("Machine " + machineId + " is not found");
            }
            state = getState(instances.get(machineId));
        }

        return state;
    }

