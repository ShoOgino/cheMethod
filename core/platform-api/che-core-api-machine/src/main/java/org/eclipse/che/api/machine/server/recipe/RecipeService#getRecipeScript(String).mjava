    @GET
    @Path("/{id}/script")
    @Produces(TEXT_PLAIN)
    @RolesAllowed({"user", "system/admin", "system/manager"})
    public String getRecipeScript(@PathParam("id") String id) throws ApiException {
        final ManagedRecipe recipe = recipeDao.getById(id);

        final User user = EnvironmentContext.getCurrent().getUser();
        if (!user.isMemberOf("system/admin") &&
            !user.isMemberOf("system/manager") &&
            !permissionsChecker.hasAccess(recipe, user.getId(), "read")) {
            throw new ForbiddenException(format("User %s doesn't have access to recipe %s", user.getId(), id));
        }

        return recipe.getScript();
    }

