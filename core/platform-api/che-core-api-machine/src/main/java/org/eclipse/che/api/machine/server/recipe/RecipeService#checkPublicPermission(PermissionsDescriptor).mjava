    /**
     * User who is neither 'workspace/admin' no 'workspace/developer' can't create or
     * update recipe permissions to 'public: search', this operation allowed only
     * for 'system/admin' or 'system/manager'
     */
    private void checkPublicPermission(PermissionsDescriptor permissions) throws ForbiddenException {
        final User user = EnvironmentContext.getCurrent().getUser();
        if (!user.isMemberOf("system/admin") && !user.isMemberOf("system/manager")) {
            for (GroupDescriptor group : permissions.getGroups()) {
                if ("public".equalsIgnoreCase(group.getName()) && group.getAcl().contains("search")) {
                    throw new ForbiddenException("User " + user.getId() + " doesn't have access to use 'public: search' permission");
                }
            }
        }
    }

