    @Test
    public void shouldNotBeAbleToCreateNewRecipeWithPublicSearchPermissionForUser() {
        final GroupDescriptor group = newDto(GroupDescriptor.class).withName("public").withAcl(asList("read", "search"));
        PermissionsDescriptor permissions = newDto(PermissionsDescriptor.class).withGroups(asList(group));
        final NewRecipe newRecipe = newDto(NewRecipe.class).withType("docker")
                                                           .withName("name")
                                                           .withScript("FROM ubuntu\n")
                                                           .withPermissions(permissions);
        when(permissionsChecker.hasPublicSearchPermission(any(PermissionsDescriptor.class))).thenReturn(true);

        final Response response = given().auth()
                                         .basic(ADMIN_USER_NAME, ADMIN_USER_PASSWORD)
                                         .contentType("application/json")
                                         .body(newRecipe)
                                         .when()
                                         .post(SECURE_PATH + "/recipe");

        assertEquals(response.getStatusCode(), 403);
        final ServiceError error = unwrapDto(response, ServiceError.class);
        assertEquals(error.getMessage(), "User " + USER_ID + " doesn't have access to use 'public: search' permission");
    }

