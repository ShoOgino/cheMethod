    public void testDeleteFileHavePermissions() throws Exception {
        ByteArrayContainerResponseWriter writer = new ByteArrayContainerResponseWriter();
        String requestPath = SERVICE_URI + "delete/" + protectedFileId;
        // File is protected and default principal 'andrew' has not write permission.
        // Replace default principal by principal who has write permission.
        EnvironmentContext.getCurrent().setUser(new UserImpl("andrew", "andrew", null, Arrays.asList("workspace/developer"), false));
        ContainerResponse response = launcher.service(HttpMethod.POST, requestPath, BASE_URI, null, null, writer, null);
        assertEquals(204, response.getStatus());
        assertFalse("File must not be removed. ", exists(protectedFilePath));
        assertNull("ACL file must be removed. ", readPermissions(protectedFilePath)); // file which stored ACL must be removed
    }

