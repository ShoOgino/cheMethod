    protected Map<Principal, Set<String>> readPermissions(String vfsPath) throws Exception {
        java.io.File file = getIoFile(vfsPath);
        java.io.File aclDir = new java.io.File(file.getParentFile(), FSMountPoint.ACL_DIR);
        java.io.File aclFile = new java.io.File(aclDir, file.getName() + FSMountPoint.ACL_FILE_SUFFIX);
        FileInputStream fIn;
        try {
            fIn = new FileInputStream(aclFile);
        } catch (FileNotFoundException e) {
            return null;
        }
        try (DataInputStream dis = new DataInputStream(new BufferedInputStream(fIn))) {
            return AccessControlList.read(dis).getPermissionMap();
        }
    }

