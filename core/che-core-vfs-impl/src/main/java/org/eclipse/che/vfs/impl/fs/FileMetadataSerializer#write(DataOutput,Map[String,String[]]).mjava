    @Override
    public void write(DataOutput output, Map<String, String[]> props) throws IOException {
        output.writeInt(props.size());
        for (Map.Entry<String, String[]> entry : props.entrySet()) {
            String[] values = entry.getValue();
            if (values != null) {
                output.writeUTF(entry.getKey());
                output.writeInt(values.length);
                for (String v : values) {
                    output.writeUTF(v);
                }
            }
        }
    }

