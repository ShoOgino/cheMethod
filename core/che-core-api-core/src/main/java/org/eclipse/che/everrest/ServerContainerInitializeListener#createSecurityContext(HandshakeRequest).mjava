  protected SecurityContext createSecurityContext(final HandshakeRequest req) {
    final boolean isSecure = false; // todo: get somehow from request
    final String authType = "BASIC";
    final Subject subject = EnvironmentContext.getCurrent().getSubject();

    final Principal principal = new SimplePrincipal(subject.getUserName());
    return new SecurityContext() {

      @Override
      public Principal getUserPrincipal() {
        return principal;
      }

      @Override
      public boolean isUserInRole(String role) {
        return false;
      }

      @Override
      public boolean isSecure() {
        return isSecure;
      }

      @Override
      public String getAuthenticationScheme() {
        return authType;
      }
    };
  }

