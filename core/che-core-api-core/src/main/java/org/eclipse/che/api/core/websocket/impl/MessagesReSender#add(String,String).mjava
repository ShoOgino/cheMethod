  public void add(String endpointId, String message) {
    List<String> messages = messagesMap.get(endpointId);

    if (messages == null) {
      messages = new LinkedList<>();
      messagesMap.put(endpointId, messages);
    }

    if (messages.size() <= MAX_MESSAGES) {
      messages.add(message);
    }
  }

