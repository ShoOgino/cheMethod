    private String getAllowedOrigin(String url) {
        if (url == null || url.isEmpty()) {
            throw new IllegalArgumentException("Api endpoint url can not be null.");
        }

        String allowedOrigin = "";

        if (url.startsWith("http://")) {
            allowedOrigin = getOriginOf(url, "http://");
        } else if (url.startsWith("https://")) {
            allowedOrigin = getOriginOf(url, "https://");
        }

        if (allowedOrigin.isEmpty()) {
            throw new IllegalArgumentException("The origin has to starts from http or https, " + url + " is not valid");
        }

        return allowedOrigin.contains("che-host") ? DEFAULT_ALLOWED_ORIGINS : allowedOrigin;
    }

