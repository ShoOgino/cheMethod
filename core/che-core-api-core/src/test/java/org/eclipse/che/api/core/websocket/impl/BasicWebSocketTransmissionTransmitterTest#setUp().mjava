    @BeforeMethod
    public void setUp() throws Exception {
        when(session.getAsyncRemote()).thenReturn(remote);
        when(session.isOpen()).thenReturn(true);

        when(registry.get(eq(ENDPOINT_ID))).thenReturn(Optional.of(session));
        when(registry.getSessions()).thenReturn(emptySet());

        transmission = DtoFactory.newDto(WebSocketTransmission.class).withProtocol(PROTOCOL).withMessage(MESSAGE);
    }

