    @Test
    public void shouldKeepMessagesIfSessionIsClosed() {
        resender.add(ENDPOINT_ID, transmission);

        when(session.isOpen()).thenReturn(false);
        resender.resend(ENDPOINT_ID);

        verify(session, never()).getAsyncRemote();
        verify(endpoint, never()).sendText(eq(MESSAGE));

        when(session.isOpen()).thenReturn(true);
        resender.resend(ENDPOINT_ID);

        verify(session).getAsyncRemote();
        verify(endpoint).sendText(eq(MESSAGE));
    }

