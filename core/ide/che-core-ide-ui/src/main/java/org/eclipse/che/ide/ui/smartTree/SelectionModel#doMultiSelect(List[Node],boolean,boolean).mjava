    protected void doMultiSelect(List<Node> nodes, boolean keepExisting, boolean suppressEvent) {
        boolean change = false;
        if (!keepExisting && selectionStorage.size() > 0) {
            change = true;
            doDeselect(new ArrayList<>(selectionStorage), true);
        }

        for (Node node : nodes) {
            boolean isSelected = isSelected(node);
            if (!suppressEvent && !isSelected) {
                BeforeSelectionEvent<Node> evt = BeforeSelectionEvent.fire(this, node);
                if (evt != null && evt.isCanceled()) {
                    continue;
                }
            }

            change = true;
            lastSelectedNode = node;

            selectionStorage.add(node);
            setLastFocused(lastSelectedNode);

            if (!isSelected) {
                onSelectChange(node, true);
                if (!suppressEvent) {
                    SelectionEvent.fire(this, node);
                }
            }
        }

        if (change && !suppressEvent) {
            fireSelectionChange();
        }
    }

