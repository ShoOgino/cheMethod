    private void onCollapse(Node node, NodeDescriptor nodeDescriptor, boolean deep) {
        if (nodeDescriptor.isExpanded() && fireCancellableEvent(new BeforeCollapseNodeEvent(node))) {
            nodeDescriptor.setExpanded(false);
            view.collapse(nodeDescriptor);

            update();

            fireEvent(new CollapseNodeEvent(node));
        }

        if (deep) {
            setExpandChildren(node, false);
        }
    }

