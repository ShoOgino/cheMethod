    @Override
    public Element render(N node, String domID, Tree.Joint joint, int depth) {
        NodePresentation presentation;
        if (node instanceof HasPresentation) {
            presentation = ((HasPresentation)node).getPresentation(false);
        } else {
            presentation = new NodePresentation();
            presentation.setPresentableText(node.getName());
        }

        Element rootContainer = getRootContainer(domID);

        Element nodeContainer = getNodeContainer();

        setIndentLevel(nodeContainer, depth);

        Element jointContainer = getJointContainer(joint);

        Element iconContainer = getIconContainer(presentation.getPresentableIcon());

        Element userElement = getUserElement(presentation.getUserElement());

        Element presentableTextContainer = getPresentableTextContainer(createPresentableTextElement(presentation));

        Element infoTextContainer = getInfoTextContainer(createInfoTextElement(presentation));

        Element descendantsContainer = getDescendantsContainer();

        nodeContainer.appendChild(jointContainer);
        nodeContainer.appendChild(iconContainer);
        nodeContainer.appendChild(userElement == null ? Document.get().createSpanElement() : userElement);
        nodeContainer.appendChild(presentableTextContainer);
        nodeContainer.appendChild(infoTextContainer);

        rootContainer.appendChild(nodeContainer);
        rootContainer.appendChild(descendantsContainer);

        return rootContainer;
    }

