    /**
     * VM has changed breakpoint state. Sets respective mark.
     */
    private void onBreakpointStateChanged(BreakpointStateEvent.BreakpointState state, String filePath, int lineNumber) {
        if (state == BreakpointStateEvent.BreakpointState.ACTIVE) {
            List<Breakpoint> breakpointsForPath = breakpoints.get(filePath);
            if (breakpointsForPath == null) {
                return;
            }

            for (int i = 0; i < breakpointsForPath.size(); i++) {
                Breakpoint breakpoint = breakpointsForPath.get(i);

                if (breakpoint.getLineNumber() == lineNumber) {
                    Breakpoint newActiveBreakpoint = new Breakpoint(breakpoint.getType(),
                                                                    breakpoint.getLineNumber(),
                                                                    breakpoint.getPath(),
                                                                    breakpoint.getFile(),
                                                                    breakpoint.getMessage(),
                                                                    true);
                    breakpointsForPath.set(i, newActiveBreakpoint);

                    BreakpointRenderer breakpointRenderer = getBreakpointRendererForFile(breakpoint.getFile());
                    if (breakpointRenderer != null) {
                        breakpointRenderer.setBreakpointActive(breakpoint.getLineNumber(), true);
                    }
                }
            }
        }
    }

