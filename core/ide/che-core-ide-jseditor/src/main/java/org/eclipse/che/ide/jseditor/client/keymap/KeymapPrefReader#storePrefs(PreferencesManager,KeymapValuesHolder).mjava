    /**
     * Updates the keymap in preferences.
     *
     * @param preferencesManager
     *         the preferences manager
     * @param valuesHolder
     *         the object that contains the values to store
     */
    public static void storePrefs(final PreferencesManager preferencesManager, final KeymapValuesHolder valuesHolder) {
        final String keymapPrefAsJson = preferencesManager.getValue(KEYMAP_PREF_KEY);

        JSONObject prefObject;
        if (keymapPrefAsJson == null) {
            prefObject = new JSONObject();
        } else {
            final JSONValue parseResult = JSONParser.parseStrict(keymapPrefAsJson);
            prefObject = parseResult.isObject();
        }

        for (final Entry<EditorType, Keymap> entry : valuesHolder) {
            if (entry.getKey() != null && entry.getValue() != null) {
                prefObject.put(entry.getKey().getEditorTypeKey(), new JSONString(entry.getValue().getKey()));
            }
        }

        final String newJson = prefObject.toString();
        preferencesManager.setValue(KEYMAP_PREF_KEY, newJson);
    }

