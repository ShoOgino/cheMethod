    /**
     * Configure the editor's code assistant.
     * @param documentHandle the handle on the document
     */
    private void configureCodeAssist(final DocumentHandle documentHandle) {
        if (this.codeAssistantFactory == null) {
            return;
        }
        final Map<String, CodeAssistProcessor> processors = configuration.getContentAssistantProcessors();

        if (processors != null && !processors.isEmpty()) {
            LOG.info("Creating code assistant.");

            final CodeAssistant codeAssistant = this.codeAssistantFactory.create(this.textEditor,
                                                                                 this.configuration.getPartitioner());
            for (String key: processors.keySet()) {
                codeAssistant.setCodeAssistantProcessor(key, processors.get(key));
            }

            final KeyBindingAction action = new KeyBindingAction() {
                @Override
                public void action() {
                    showCompletion(codeAssistant);
                }
            };
            final HasKeybindings hasKeybindings = this.textEditor.getHasKeybindings();
            hasKeybindings.addKeybinding(new Keybinding(true, false, false, false, KeyCode.SPACE, action), CONTENT_ASSIST);

            // handle CompletionRequest events that come from text operations instead of simple key binding
            documentHandle.getDocEventBus().addHandler(CompletionRequestEvent.TYPE, new CompletionRequestHandler() {
                @Override
                public void onCompletionRequest(final CompletionRequestEvent event) {
                    showCompletion(codeAssistant);
                }
            });
        } else {
            final KeyBindingAction action = new KeyBindingAction() {
                @Override
                public void action() {
                    showCompletion();
                }
            };
            final HasKeybindings hasKeybindings = this.textEditor.getHasKeybindings();
            if(UserAgent.isMac()){
                hasKeybindings.addKeybinding(new Keybinding(false,false,false, true, KeyCode.SPACE, action), CONTENT_ASSIST);
                hasKeybindings.addKeybinding(new Keybinding(false,false,true, true, KeyCode.SPACE, action), CONTENT_ASSIST);
            } else {
                hasKeybindings.addKeybinding(new Keybinding(true, false, false, false, KeyCode.SPACE, action), CONTENT_ASSIST);
            }
            // handle CompletionRequest events that come from text operations instead of simple key binding
            documentHandle.getDocEventBus().addHandler(CompletionRequestEvent.TYPE, new CompletionRequestHandler() {
                @Override
                public void onCompletionRequest(final CompletionRequestEvent event) {
                    showCompletion();
                }
            });
        }
    }

