    @Before
    public void setUp() throws Exception {
        when(messageBusProvider.getMessageBus()).thenReturn(messageBus);

        eventLogger = spy(new AnalyticsEventLoggerImpl(dtoFactory, user, appContext, eventBus, messageBusProvider, dtoUnmarshallerFactory));

        doReturn("workspaceId").when(eventLogger).getWorkspace();

        verify(eventBus).addHandler(eq(StartWorkspaceEvent.TYPE), startWorkspaceCaptor.capture());
        startWorkspaceCaptor.getValue().onWorkspaceStarted(workspace);

        when(appContext.getWorkspace()).thenReturn(workspace);
        when(workspace.getId()).thenReturn("workspaceId");
    }

