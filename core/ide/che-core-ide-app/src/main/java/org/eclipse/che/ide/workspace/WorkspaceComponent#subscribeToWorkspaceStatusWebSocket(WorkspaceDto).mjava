    private void subscribeToWorkspaceStatusWebSocket(final WorkspaceDto workspace) {
        Unmarshallable<WorkspaceStatusEvent> unmarshaller = dtoUnmarshallerFactory.newWSUnmarshaller(WorkspaceStatusEvent.class);

        try {
            messageBus.subscribe("workspace:" + workspace.getId(), new SubscriptionHandler<WorkspaceStatusEvent>(unmarshaller) {
                @Override
                protected void onMessageReceived(WorkspaceStatusEvent statusEvent) {
                    String workspaceName = workspace.getConfig().getName();

                    switch (statusEvent.getEventType()) {

                        case RUNNING:
                            setCurrentWorkspace(workspace);
                            notificationManager.notify(locale.startedWs(), StatusNotification.Status.SUCCESS, true);
                            eventBus.fireEvent(new WorkspaceStartedEvent(workspace));
                            break;

                        case ERROR:
                            unSubscribeWorkspace(statusEvent.getWorkspaceId(), this);
                            notificationManager.notify(locale.workspaceStartFailed(), FAIL, true);
                            initialLoadingInfo.setOperationStatus(WORKSPACE_BOOTING.getValue(), ERROR);
                            showErrorDialog(workspaceName, statusEvent.getError());
                            eventBus.fireEvent(new WorkspaceStoppedEvent(workspace));
                            break;

                        case STOPPED:
                            workspaceServiceClient.getWorkspaces(SKIP_COUNT, MAX_COUNT).then(new Operation<List<WorkspaceDto>>() {
                                @Override
                                public void apply(List<WorkspaceDto> workspaces) throws OperationException {
                                    startWorkspacePresenter.show(workspaces, callback);
                                }
                            });
                            unSubscribeWorkspace(statusEvent.getWorkspaceId(), this);
                            notificationManager.notify(locale.extServerStopped(), StatusNotification.Status.SUCCESS, true);
                            eventBus.fireEvent(new WorkspaceStoppedEvent(workspace));
                            break;

                        case SNAPSHOT_CREATED:
                            snapshotCreator.successfullyCreated();
                            break;

                        case SNAPSHOT_CREATION_ERROR:
                            snapshotCreator.creationError("Snapshot creation error: " + statusEvent.getError());
                            break;

                    }
                }

                @Override
                protected void onErrorReceived(Throwable exception) {
                    notificationManager.notify(exception.getMessage(), FAIL, false);
                }
            });
        } catch (WebSocketException exception) {
            Log.error(getClass(), exception);
        }
    }

