    /** Returns parent for creating new item or {@code null} if resource can not be created. */
    @Nullable
    protected ResourceBasedNode<?> getResourceBasedNode() {
        Selection<?> selection = projectExplorer.getSelection();

        //we should be sure that user selected single element to work with it
        if (selection == null || selection.isEmpty()) {
            return null;
        }

        Object o = selection.getHeadElement();

        if (o instanceof ResourceBasedNode<?>) {
            ResourceBasedNode<?> node = (ResourceBasedNode<?>)o;
            //it may be file node, so we should take parent node
            if (node.isLeaf() && isResourceAndStorableNode(node.getParent())) {
                return (ResourceBasedNode<?>)node.getParent();
            }

            return isResourceAndStorableNode(node) ? node : null;
        }

        return null;
    }

