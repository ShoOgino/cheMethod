    @Nullable
    protected FolderReferenceNode getResourceBasedNode() {
        List<?> selection = projectExplorer.getSelection().getAllElements();
        //we should be sure that user selected single element to work with it
        if (selection.isEmpty() || selection.size() > 1) {
            return null;
        }

        Object o = selection.get(0);

        if (o instanceof FolderReferenceNode) {
            return (FolderReferenceNode)o;
        }

        return null;
    }

