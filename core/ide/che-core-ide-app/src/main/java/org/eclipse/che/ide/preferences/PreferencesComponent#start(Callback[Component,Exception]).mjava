    @Override
    public void start(final Callback<Component, Exception> callback) {
        userProfileService.getPreferences(new AsyncRequestCallback<Map<String, String>>(new StringMapUnmarshaller()) {
            @Override
            protected void onSuccess(Map<String, String> preferences) {
                currentUser.setPreferences(preferences);
                appContext.setCurrentUser(currentUser);
                preferencesManager.load(preferences);

                setTheme();

                styleInjector.inject();
                callback.onSuccess(PreferencesComponent.this);
            }

            @Override
            protected void onFailure(Throwable exception) {
                callback.onFailure(new Exception("Unable to load preferences", exception));
            }
        });
    }

