    private String getPathToParent() {
        Selection<?> selection = selectionAgent.getSelection();
        if (selection == null || selection.isEmpty()) {
            return DEFAULT_PARENT_DIRECTORY;
        }

        if (selection.getAllElements().size() > 1) {
            return DEFAULT_PARENT_DIRECTORY;
        }

        Object selectedElement = selection.getHeadElement();

        if (selectedElement instanceof FolderReferenceNode) {
            Node parent = ((FolderReferenceNode)selectedElement).getParent();
            return getPath(parent);
        } else if (selectedElement instanceof ProjectNode) {
            Node parent = ((ProjectNode)selectedElement).getParent();
            return getPath(parent);
        }

        return DEFAULT_PARENT_DIRECTORY;
    }

