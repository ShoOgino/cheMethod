    public String getWsAgentWebSocketUrl() {
        DevMachineServer server = getServer(Constants.WSAGENT_REFERENCE);
        if (server != null) {
            String url = server.getUrl();
            String extUrl = url.substring(url.indexOf(':'), url.length());
            final String protocol = Window.Location.getProtocol().equals("https:") ? "wss" : "ws";
            return protocol
                   + extUrl
                   + (extUrl.endsWith("/") ? "ws/" : "/ws/")
                   + getWorkspace();
        } else {
            //should not be
            String message = "Reference " + Constants.WSAGENT_REFERENCE + " not found in DevMachine description";
            Log.error(getClass(), message);
            throw new RuntimeException(message);
        }
    }

