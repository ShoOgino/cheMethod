  private void removePredecessorMapping(Map<ID, NodeInfo<ID, N>> nodes, NodeInfo<ID, N> node) {
    if (node.successors != null) {
      for (ID succ : node.successors) {
        NodeInfo<ID, N> succNode = nodes.get(succ);
        if (succNode != null) {
          succNode.predecessors.remove(node.id);
        }
      }
    }
    nodes.remove(node.id);
  }

