    @Override

    public String getToken(HttpServletRequest req) {
        if (req.getHeader(HttpHeaders.AUTHORIZATION) == null) {
            return null;
        }
        return req.getHeader(HttpHeaders.AUTHORIZATION).toLowerCase().startsWith("bearer") ? req.getHeader(HttpHeaders.AUTHORIZATION)
                                                                                                .split(" ")[1]
                                                                                           : req.getHeader(HttpHeaders.AUTHORIZATION);
    }

