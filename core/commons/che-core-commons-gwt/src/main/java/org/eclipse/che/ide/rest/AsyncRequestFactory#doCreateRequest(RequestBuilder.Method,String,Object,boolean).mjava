    /**
     * Creates new HTTP request to the specified {@code url}.
     *
     * @param method
     *         request method
     * @param url
     *         request URL
     * @param dtoBody
     *         the DTO to send as body of the request. Must implement {@link org.eclipse.che.ide.dto.JsonSerializable} interface or contain
     *         objects that implement it. May be {@code null}.
     * @param async
     *         if <b>true</b> - request will be sent in asynchronous mode
     * @return new {@link AsyncRequest} instance to send POST request
     */
    protected AsyncRequest doCreateRequest(RequestBuilder.Method method, String url, Object dtoBody, boolean async) {
        AsyncRequest asyncRequest = new AsyncRequest(method, url, async);
        if (dtoBody != null) {
            if (dtoBody instanceof List) {
                asyncRequest.data(dtoFactory.toJson((List)dtoBody));
            } else if (dtoBody instanceof String) {
                asyncRequest.data((String) dtoBody);
            } else {
                asyncRequest.data(dtoFactory.toJson(dtoBody));
            }
            asyncRequest.header(HTTPHeader.CONTENT_TYPE, DTO_CONTENT_TYPE);
        }
        return asyncRequest;
    }

