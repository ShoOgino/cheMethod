    public static MatchResult findMatchBeforeIndex(
            RegExp regexp, String text, int exclusiveEndIndex) {
        regexp.setLastIndex(0);

        // Find the last match without going over our startIndex
        MatchResult lastMatch = null;
        for (MatchResult result = regexp.exec(text);
             result != null && result.getIndex() < exclusiveEndIndex; result = regexp.exec(text)) {
            lastMatch = result;
        }

        return lastMatch;
    }

