    private void handleFailure(Response response) {
        Exception exception;
        String contentType = response.getHeader(CONTENT_TYPE);

        if (contentType != null && !contentType.contains(APPLICATION_JSON)) {
            String message = generateErrorMessage(response);
            exception = new Exception(message);
        } else {
            exception = new ServerException(response);
        }
        onFailure(exception);
    }

