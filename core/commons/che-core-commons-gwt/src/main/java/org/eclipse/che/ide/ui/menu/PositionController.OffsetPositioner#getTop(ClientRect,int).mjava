        @Override
        double getTop(ClientRect elementRect, int offsetY) {
            // This rect is to only be used for width and height since the coordinates are relative to the
            // viewport and we are relative to an offsetParent.
            ClientRect anchorRect = anchor.getBoundingClientRect();

            ensureOffsetCalculated();
            switch (getVerticalAlignment()) {
                case TOP:
                    return anchorOffsetTop - elementRect.getHeight() - offsetY;
                case MIDDLE:
                    double anchory = anchorOffsetTop + anchorRect.getHeight() / 2;
                    return anchory - elementRect.getHeight() / 2 - offsetY;
                case BOTTOM:
                    double anchorBottom = anchorOffsetTop + anchorRect.getHeight();
                    return anchorBottom + offsetY;
                default:
                    return 0;
            }
        }

