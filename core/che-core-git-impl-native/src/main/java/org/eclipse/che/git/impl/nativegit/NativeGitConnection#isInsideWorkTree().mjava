    @Override
    public boolean isInsideWorkTree() throws GitException {
        final EmptyGitCommand emptyGitCommand = nativeGit.createEmptyGitCommand();
        
        // command "rev-parse --is-inside-work-tree" returns true/false
        try {
            emptyGitCommand.setNextParameter("rev-parse")
                           .setNextParameter("--is-inside-work-tree")
                           .execute();
                   
            final String output = emptyGitCommand.getText();
            return Boolean.valueOf(output);
        } catch(GitException ge) {
            String msg = ge.getMessage();
            if (msg != null && notInGitRepoErrorPattern.matcher(msg).matches()) {
                return false;
            }
            
            throw ge;
        }
    }

