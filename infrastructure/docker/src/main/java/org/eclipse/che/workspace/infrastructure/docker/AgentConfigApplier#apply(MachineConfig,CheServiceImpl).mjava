    /**
     * Applies docker specific properties to a machine.
     *
     * @param machineConf
     *         machine config with the list of agents that should be injected into machine
     * @param machine
     *         affected machine
     * @throws AgentException
     *         if any error occurs
     */
    public void apply(@Nullable MachineConfig machineConf,
                      CheServiceImpl machine) throws AgentException {
        if (machineConf != null) {
            for (AgentKey agentKey : sorter.sort(machineConf.getAgents())) {
                Agent agent = agentRegistry.getAgent(agentKey);
                addEnv(machine, agent.getProperties());
                addExposedPorts(machine, agent.getServers());
                addLabels(machine, agent.getServers());
            }
        }
    }

