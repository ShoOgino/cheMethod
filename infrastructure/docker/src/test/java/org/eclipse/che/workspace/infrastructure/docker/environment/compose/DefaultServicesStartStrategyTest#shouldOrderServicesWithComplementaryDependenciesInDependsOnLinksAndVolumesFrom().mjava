    @Test
    public void shouldOrderServicesWithComplementaryDependenciesInDependsOnLinksAndVolumesFrom() throws Exception {
        // given
        CheServicesEnvironmentImpl composeEnvironment = new CheServicesEnvironmentImpl();
        composeEnvironment.getServices().put("second", new CheServiceImpl().withVolumesFrom(singletonList("first")));
        composeEnvironment.getServices().put("third", new CheServiceImpl().withVolumesFrom(singletonList("second"))
                                                                          .withDependsOn(singletonList("first")));
        composeEnvironment.getServices().put("first", new CheServiceImpl());
        composeEnvironment.getServices().put("forth", new CheServiceImpl().withVolumesFrom(singletonList("third"))
                                                                          .withDependsOn(singletonList("second"))
                                                                          .withLinks(singletonList("first:alias")));
        composeEnvironment.getServices().put("fifth", new CheServiceImpl().withVolumesFrom(singletonList("first"))
                                                                          .withLinks(singletonList("forth"))
                                                                          .withDependsOn(singletonList("second")));
        List<String> expected = asList("first", "second", "third", "forth", "fifth");

        // when
        List<String> actual = strategy.order(composeEnvironment);

        // then
        assertEquals(actual, expected);
    }

