    @Test
    public void shouldBeAbleToCreateSshMachineInstanceOnMachineCreationFromRecipe() throws Exception {
        when(sshMachineFactory.createSshClient(any(SshMachineRecipe.class), anyMap())).thenReturn(sshClient);
        when(sshMachineFactory.createInstance(eq(machine), eq(sshClient), any(LineConsumer.class))).thenReturn(sshMachineInstance);
        when(recipeDownloader.getRecipe(eq(machine.getConfig()))).thenReturn(recipe);

        Instance instance = provider.createInstance(machine, LineConsumer.DEV_NULL);

        assertEquals(instance, sshMachineInstance);
    }

