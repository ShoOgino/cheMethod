    private void copyFile(String sourcePath, String absoluteTargetPath, ChannelSftp channelSftp) throws MachineException {
        try {
            channelSftp.put(sourcePath, absoluteTargetPath);

            // apply permissions
            File file = new File(sourcePath);
            // read
            int permissions = 4;
            // execute
            if (file.canExecute()) {
                permissions += 1;
            }
            // write
            if (file.canWrite()) {
                permissions += 2;
            }
            channelSftp.chmod(permissions, absoluteTargetPath);
        } catch (SftpException e) {
            throw new MachineException(format("Sftp copying of file %s failed. Error: %s",
                                              absoluteTargetPath,
                                              e.getLocalizedMessage()));
        }
    }

