  @Test
  public void testOnBinaryPathChanged() throws Exception {
    String binPath = "/path";
    when(pageView.getBinaryPath()).thenReturn(binPath);

    final DebugConfigurationPage.DirtyStateListener listener =
        mock(DebugConfigurationPage.DirtyStateListener.class);
    pagePresenter.setDirtyStateListener(listener);

    pagePresenter.onBinaryPathChanged();

    verify(pageView).getBinaryPath();
    ArgumentCaptor<Map> argumentCaptor = ArgumentCaptor.forClass(Map.class);

    verify(configuration).setConnectionProperties(argumentCaptor.capture());
    Map argumentCaptorValue = argumentCaptor.getValue();
    assertEquals(
        binPath,
        argumentCaptorValue.get(GdbConfigurationPagePresenter.BIN_PATH_CONNECTION_PROPERTY));

    verify(listener).onDirtyStateChanged();
  }

