    private void setHosts(List<Machine> machines) {
        List<Promise<RecipeDescriptor>> recipePromises = new ArrayList<>(machines.size());
        for (Machine machine : machines) {
            String location = machine.getConfig().getSource().getLocation();
            String recipeId = getRecipeId(location);
            recipePromises.add(recipeServiceClient.getRecipe(recipeId));
        }

        @SuppressWarnings("unchecked")
        final Promise<RecipeDescriptor>[] recipePromisesArray = (Promise<RecipeDescriptor>[])recipePromises.toArray();
        setHostsList(recipePromisesArray, machines);
    }

