  @Override
  public void onClose(final String newContent) {
    if (!compareWithLatest || this.localContent == null || newContent.equals(localContent)) {
      view.hide();
      return;
    }

    ConfirmCallback confirmCallback =
        () ->
            comparedFile
                .updateContent(newContent)
                .then(
                    ignored -> {
                      final Container parent = comparedFile.getParent();

                      if (parent != null) {
                        parent.synchronize();
                      }

                      eventBus.fireEvent(
                          new FileContentUpdateEvent(comparedFile.getLocation().toString()));
                      view.hide();
                    });

    CancelCallback cancelCallback = view::hide;

    dialogFactory
        .createConfirmDialog(
            locale.compareSaveTitle(),
            locale.compareSaveQuestion(),
            locale.buttonYes(),
            locale.buttonNo(),
            confirmCallback,
            cancelCallback)
        .show();
  }

