    @Test
    public void testShowDialogWhenRootFolderIsSelected() throws Exception {
        when(service.getStatus(anyObject(), any(Path.class))).thenReturn(statusPromise);
        when(statusPromise.then(any(Operation.class))).thenReturn(statusPromise);
        when(statusPromise.catchError(any(Operation.class))).thenReturn(statusPromise);
        when(appContext.getResources()).thenReturn(new Resource[]{mock(Resource.class)});
        when(constant.addToIndexAllChanges()).thenReturn(MESSAGE);

        presenter.showDialog(project);

        verify(statusPromise).then(statusPromiseCaptor.capture());
        statusPromiseCaptor.getValue().apply(statusResponse);

        verify(constant).addToIndexAllChanges();
        verify(view).setMessage(eq(MESSAGE), Matchers.<List<String>>eq(null));
        verify(view).setUpdated(anyBoolean());
        verify(view).showDialog();
    }

