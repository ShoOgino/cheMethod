    @Test
    public void testDialogWillNotBeShownWhenNothingAddToIndex() throws Exception {
        when(this.statusResponse.isClean()).thenReturn(true);

        presenter.showDialog();

        verify(service).status(anyString(), eq(rootProjectConfig), asyncRequestCallbackStatusCaptor.capture());
        AsyncRequestCallback<Status> callback = asyncRequestCallbackStatusCaptor.getValue();

        //noinspection NonJREEmulationClassesInClientCode
        Method onSuccess = GwtReflectionUtils.getMethod(callback.getClass(), "onSuccess");
        onSuccess.invoke(callback, this.statusResponse);

        verify(gitOutputConsoleFactory).create(ADD_TO_INDEX_COMMAND_NAME);
        verify(console).printInfo(anyString());
        verify(consolesPanelPresenter).addCommandOutput(anyString(), eq(console));
        verify(notificationManager).notify(anyString(), eq(rootProjectConfig));
        verify(view, never()).showDialog();
        verify(constant, times(2)).nothingAddToIndex();
    }

