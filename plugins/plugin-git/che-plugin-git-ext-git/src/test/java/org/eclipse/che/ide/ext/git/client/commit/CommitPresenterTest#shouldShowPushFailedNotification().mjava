  @Test
  public void shouldShowPushFailedNotification() throws Exception {
    when(constant.pushFail()).thenReturn("pushFail");
    when(view.isPushAfterCommit()).thenReturn(true);
    when(view.getRemoteBranch()).thenReturn("origin/master");

    presenter.showDialog(project);
    presenter.onCommitClicked();
    verify(voidPromise).then(voidPromiseCaptor.capture());
    voidPromiseCaptor.getValue().apply(null);
    verify(revisionPromise).then(revisionCaptor.capture());
    revisionCaptor.getValue().apply(mock(Revision.class));
    verify(pushPromise).catchError(promiseErrorCaptor.capture());
    promiseErrorCaptor.getValue().apply(promiseError);

    verify(notificationManager).notify(eq("pushFail"), eq(FAIL), eq(FLOAT_MODE));
  }

