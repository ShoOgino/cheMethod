  @Test
  public void testShowDialogWhenStatusRequestIsSuccessfulButIndexIsEmpty() throws Exception {
    MessageDialog messageDialog = mock(MessageDialog.class);
    when(constant.messagesWarningTitle()).thenReturn("Warning");
    when(constant.indexIsEmpty()).thenReturn("Index is Empty");
    when(dialogFactory.createMessageDialog(anyString(), anyString(), anyObject()))
        .thenReturn(messageDialog);
    final Status status = mock(Status.class);
    List<String> changes = new ArrayList<>();
    when(status.getAdded()).thenReturn(changes);
    when(status.getChanged()).thenReturn(changes);
    when(status.getRemoved()).thenReturn(changes);

    presenter.showDialog(project);

    verify(statusPromise).then(statusPromiseCaptor.capture());
    statusPromiseCaptor.getValue().apply(status);

    verify(dialogFactory).createMessageDialog(eq("Warning"), eq("Index is Empty"), anyObject());
    verify(view, never()).setIndexedFiles(anyObject());
    verify(view, never()).showDialog();
  }

