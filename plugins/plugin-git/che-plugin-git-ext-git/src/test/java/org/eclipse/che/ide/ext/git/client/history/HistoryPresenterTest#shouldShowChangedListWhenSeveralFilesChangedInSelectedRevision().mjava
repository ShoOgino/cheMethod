    @Test
    public void shouldShowChangedListWhenSeveralFilesChangedInSelectedRevision() throws Exception {
        Revision revisionA = mock(Revision.class);
        Revision revisionB = mock(Revision.class);
        when(revisionA.getId()).thenReturn("commitA");
        when(revisionB.getId()).thenReturn("commitB");
        LogResponse logResponse = mock(LogResponse.class);
        List<Revision> revisions = new ArrayList<>();
        revisions.add(revisionA);
        revisions.add(revisionB);
        when(logResponse.getCommits()).thenReturn(revisions);

        presenter.show();
        presenter.onRevisionSelected(revisionA);
        verify(logPromise).then(logCaptor.capture());
        logCaptor.getValue().apply(logResponse);
        presenter.onCompareClicked();
        verify(stringPromise).then(stringCaptor.capture());
        stringCaptor.getValue().apply("M file1\nM file2");

        verify(changedListPresenter).show(anyMap(), eq("commitB"), eq("commitA"), any(Project.class));
    }

