    @Test
    public void testOnPushClickedWhenPusHasChanges() throws Exception {
        when(pushResponse.getCommandOutput()).thenReturn("Something pushed");

        presenter.showDialog();
        presenter.onPushClicked();

        verify(service).push(eq(devMachine), anyObject(), anyListOf(String.class), anyString(), anyBoolean(),
                             asyncCallbackVoidCaptor.capture());
        AsyncRequestCallback<PushResponse> voidCallback = asyncCallbackVoidCaptor.getValue();
        Method onSuccess = GwtReflectionUtils.getMethod(voidCallback.getClass(), "onSuccess");
        onSuccess.invoke(voidCallback, pushResponse);

        verify(service).push(eq(devMachine), eq(rootProjectConfig), anyListOf(String.class), eq(REPOSITORY_NAME), eq(DISABLE_CHECK),
                             (AsyncRequestCallback<PushResponse>)anyObject());
        verify(view).close();
        verify(gitOutputConsoleFactory).create(PUSH_COMMAND_NAME);
        verify(console).print(anyString());
        verify(constant).pushSuccess(anyString());
        verify(consolesPanelPresenter).addCommandOutput(anyString(), eq(console));
        verify(notificationManager).notify(anyString(), rootProjectConfig);
    }

