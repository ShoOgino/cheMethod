    @Test
    public void onEnterClickedWhenValueIsCorrect() throws Exception {
        when(dtoFactory.createDto(CheckoutRequest.class)).thenReturn(checkoutRequest);
        when(checkoutRequest.withName(anyString())).thenReturn(checkoutRequest);
        when(checkoutRequest.withCreateNew(anyBoolean())).thenReturn(checkoutRequest);
        reset(service);
        when(service.checkout(anyObject(), any(Path.class), any(CheckoutRequest.class))).thenReturn(voidPromise);
        when(voidPromise.then(any(Operation.class))).thenReturn(voidPromise);
        when(voidPromise.catchError(any(Operation.class))).thenReturn(voidPromise);
        when(view.getReference()).thenReturn(CORRECT_REFERENCE);

        presenter.showDialog(project);
        presenter.onEnterClicked();

        verify(voidPromise).then(voidPromiseCaptor.capture());
        voidPromiseCaptor.getValue().apply(null);

        verify(synchronizePromise).then(synchronizeCaptor.capture());
        synchronizeCaptor.getValue().apply(new Resource[0]);

        verify(view).close();
        verify(service).checkout(anyObject(), any(Path.class), any(CheckoutRequest.class));
        verify(checkoutRequest).withName(CORRECT_REFERENCE);
        verifyNoMoreInteractions(checkoutRequest);
    }

