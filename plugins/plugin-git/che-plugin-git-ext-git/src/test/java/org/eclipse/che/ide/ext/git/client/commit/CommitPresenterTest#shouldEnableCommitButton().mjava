  @Test
  public void shouldEnableCommitButton() throws Exception {
    when(view.getCommitMessage()).thenReturn("foo");

    presenter.showDialog(project);
    verify(stringPromise).then(stringCaptor.capture());
    stringCaptor.getValue().apply("M\tfile");
    verify(logPromise).then(logCaptor.capture());
    logCaptor.getValue().apply(null);

    verify(view).setEnableCommitButton(eq(ENABLE_BUTTON));
  }

