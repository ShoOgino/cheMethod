  private synchronized PublicKey getJwtPublicKey(boolean reset)
      throws NoSuchAlgorithmException, InvalidKeySpecException {
    if (reset) {
      publicKey = null;
    }
    if (publicKey == null) {
      URL url;
      HttpURLConnection conn;
      try {
        url = new URL(authServerUrl + "/realms/" + realm);
        LOG.info("Pulling realm public key from URL : {}", url);
        conn = (HttpURLConnection) url.openConnection();
        conn.setRequestMethod("GET");
        Map<String, String> realmSettings;
        try (BufferedReader in = new BufferedReader(new InputStreamReader(conn.getInputStream()))) {
          ObjectMapper mapper = new ObjectMapper();
          //noinspection unchecked
          realmSettings = mapper.readValue(in, Map.class);
        }
        String encodedPublicKey = realmSettings.get("public_key");
        byte[] decoded = Base64.getDecoder().decode(encodedPublicKey);
        X509EncodedKeySpec keySpec = new X509EncodedKeySpec(decoded);
        KeyFactory kf = KeyFactory.getInstance("RSA");
        publicKey = kf.generatePublic(keySpec);
      } catch (IOException e) {
        LOG.error("Exception during retrieval of the Keycloak realm public key", e);
      }
    }
    return publicKey;
  }

