    private synchronized User getOrCreateUser(String id, String email, String username) throws ServletException {
        try {
            return userManager.getById(id);
        } catch (NotFoundException e) {
            try {
                final UserImpl cheUser = new UserImpl(id,
                                                      email,
                                                      username,
                                                      "secret",
                                                      emptyList());
                return userManager.create(cheUser, false);
            } catch (ServerException | ConflictException ex) {
                throw new ServletException("Unable to create new user", ex);
            }
        } catch (ServerException e) {
            throw new ServletException("Unable to get user", e);
        }

    }

