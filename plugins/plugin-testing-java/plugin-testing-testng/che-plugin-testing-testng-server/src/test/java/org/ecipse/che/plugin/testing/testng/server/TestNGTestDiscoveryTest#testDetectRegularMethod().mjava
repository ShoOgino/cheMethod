  @Test
  public void testDetectRegularMethod() throws Exception {

    StringBuffer buf = new StringBuffer();
    buf.append("package test;\n");
    buf.append("import org.testng.annotations.Test;\n");
    buf.append("public class E {\n");
    buf.append("    @Test\n");
    buf.append("    public void foo() {\n");
    buf.append("    }\n");
    buf.append("}\n");
    ICompilationUnit compilationUnit =
        packageFragment.createCompilationUnit("T.java", buf.toString(), false, null);

    compilationUnit.reconcile(0, true, DefaultWorkingCopyOwner.PRIMARY, null);
    TestNGRunner runner = new TestNGRunner("", testNGTestFinder, null, null);

    List<TestPosition> testPositions =
        runner.detectTests(
            new MockTestDetectionContext("/testDiscovery", "/testDiscovery/src/test/T.java", -1));

    assertThat(testPositions).isNotNull().isNotEmpty().hasSize(1);
    TestPosition testPosition = testPositions.iterator().next();
    assertThat(testPosition.getFrameworkName()).isEqualTo("testng");
    assertThat(testPosition.getTestName()).isEqualTo("foo");
    assertThat(testPosition.getTestNameStartOffset()).isEqualTo(buf.indexOf("foo("));
  }

