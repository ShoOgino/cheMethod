  @Override
  public void updateInPerspective(@NotNull ActionEvent event) {
    Presentation presentation = event.getPresentation();
    boolean isProjectExplorerActive =
        testDetector.getActivePart() instanceof ProjectExplorerPresenter;
    presentation.setVisible(isProjectExplorerActive);
    if (!isProjectExplorerActive) {
      return;
    }
    if (!testDetector.isEditorInFocus()) {
      analyzeProjectTreeSelection(presentation);
    } else {
      presentation.setEnabled(testDetector.isEnabled());
    }
  }

