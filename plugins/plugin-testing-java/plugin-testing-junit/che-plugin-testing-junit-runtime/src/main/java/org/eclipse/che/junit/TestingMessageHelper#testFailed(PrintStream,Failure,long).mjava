    /**
     * Prints an information when a test fails.
     *
     * @param out
     *         output stream
     * @param failure
     *         describes the test that failed and the exception that was thrown
     * @param duration
     *         time of test running
     */
    public static void testFailed(PrintStream out, Failure failure, long duration) {
        List<Pair> attributes = new ArrayList<>();
        attributes.add(new Pair(NAME, escape(failure.getDescription().getMethodName())));
        Throwable exception = failure.getException();
        if (exception != null) {
            String failMessage = failure.getMessage();
            StringWriter writer = new StringWriter();
            PrintWriter printWriter = new PrintWriter(writer);
            exception.printStackTrace(printWriter);
            String stackTrace = writer.getBuffer().toString();
            attributes.add(new Pair(MESSAGE, escape(failMessage)));
            attributes.add(new Pair(DETAILS, escape(stackTrace)));
        } else {
            attributes.add(new Pair(MESSAGE, ""));
        }
        attributes.add(new Pair(DURATION, String.valueOf(duration)));

        out.println(create(TEST_FAILED, attributes));
    }

