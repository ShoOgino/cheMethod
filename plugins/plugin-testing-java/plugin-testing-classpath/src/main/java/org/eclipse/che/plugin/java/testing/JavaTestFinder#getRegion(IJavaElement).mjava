    private IRegion getRegion(IJavaElement element) {
        IRegion result = JavaCore.newRegion();
        if (element.getElementType() == IJavaElement.JAVA_PROJECT) {
            //for projects only add the contained source folders
            try {
                IPackageFragmentRoot[] packageFragmentRoots = ((IJavaProject)element).getPackageFragmentRoots();
                for (IPackageFragmentRoot packageFragmentRoot : packageFragmentRoots) {
                    if (!packageFragmentRoot.isArchive()) {
                        result.add(packageFragmentRoot);
                    }
                }
            } catch (JavaModelException e) {
                LOG.info("Can't read source folders.", e);
            }
        } else {
            result.add(element);
        }
        return result;
    }

