  @Override
  public List<TestPosition> detectTests(TestDetectionContext context) {
    IJavaProject javaProject = getJavaProject(context.getProjectPath());
    if (!javaProject.exists()) {
      return Collections.emptyList();
    }

    List<TestPosition> result = new ArrayList<>();
    try {
      ICompilationUnit compilationUnit =
          findCompilationUnitByPath(javaProject, context.getFilePath());
      if (context.getOffset() == -1) {
        addAllTestsMethod(result, compilationUnit);
      } else {
        IJavaElement element = compilationUnit.getElementAt(context.getOffset());
        if (element != null && element.getElementType() == IJavaElement.METHOD) {
          if (isTestMethod((IMethod) element, compilationUnit)) {
            result.add(createTestPosition((IMethod) element));
          }
        } else {
          addAllTestsMethod(result, compilationUnit);
        }
      }
    } catch (JavaModelException e) {
      LOG.debug("Can't read all methods.", e);
    }

    return result;
  }

