    @Test
    public void ownerNameShouldBeSetWhenThereAreFirstAndLastNames() throws Exception {
        Map<String, String> attributes = new HashMap<>();
        attributes.put(MachineInfoPresenter.FIRST_NAME_KEY, "firstName");
        attributes.put(MachineInfoPresenter.LAST_NAME_KEY, "lastName");

        when(profileDescriptor.getAttributes()).thenReturn(attributes);
        when(wsService.getUsersWorkspace(SOME_TEXT)).thenReturn(promise);

        presenter.update(machine);

        verify(userProfile).getCurrentProfile(profileCaptor.capture());
        AsyncRequestCallback<ProfileDescriptor> callback = profileCaptor.getValue();

        //noinspection NonJREEmulationClassesInClientCode
        Method method = callback.getClass().getDeclaredMethod("onSuccess", Object.class);

        method.setAccessible(true);

        method.invoke(callback, profileDescriptor);

        verify(view).setOwner("firstName lastName");
    }

