    @Before
    public void setUp() {
        statusNotifier =
                new MachineStatusHandler(eventBus, appContext, entityFactory, workspaceServiceClient, notificationManager, locale);
        eventBus.addHandler(MachineStateEvent.TYPE, handler);

        when(machine.getDisplayName()).thenReturn(MACHINE_NAME);
        when(machineDto.getId()).thenReturn(MACHINE_ID);
        when(entityFactory.createMachine(machineDto)).thenReturn(machine);
        when(workspace.getRuntime()).thenReturn(workspaceRuntime);
        when(workspaceRuntime.getMachines()).thenReturn(Collections.singletonList(machineDto));
        when(machineStatusChangedEvent.getMachineId()).thenReturn(MACHINE_ID);
        when(machineStatusChangedEvent.getWorkspaceId()).thenReturn(WORKSPACE_ID);
        when(machineStatusChangedEvent.getMachineName()).thenReturn(MACHINE_NAME);
        when(workspaceServiceClient.getWorkspace(WORKSPACE_ID)).thenReturn(workspacePromise);
    }

