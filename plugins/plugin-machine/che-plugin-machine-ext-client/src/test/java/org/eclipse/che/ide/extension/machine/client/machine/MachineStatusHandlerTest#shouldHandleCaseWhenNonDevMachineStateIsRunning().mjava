    @Test
    public void shouldHandleCaseWhenNonDevMachineStateIsRunning() throws Exception {
        when(machine.isDev()).thenReturn(false);

        when(machineStatusChangedEvent.getEventType()).thenReturn(RUNNING);
        statusNotifier.onMachineStatusChanged(machineStatusChangedEvent);

        verify(workspaceServiceClient.getWorkspace(WORKSPACE_ID)).then(workspaceCaptor.capture());
        workspaceCaptor.getValue().apply(workspace);

        verify(appContext).setWorkspace(workspace);
        verify(handler).onMachineRunning(Matchers.<MachineStateEvent>anyObject());
    }

