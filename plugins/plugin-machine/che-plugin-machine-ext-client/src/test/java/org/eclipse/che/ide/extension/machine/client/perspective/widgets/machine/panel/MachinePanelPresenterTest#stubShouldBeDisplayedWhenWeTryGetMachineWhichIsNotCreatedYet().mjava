    @Test
    public void stubShouldBeDisplayedWhenWeTryGetMachineWhichIsNotCreatedYet() throws Exception {
        PromiseError error = mock(PromiseError.class);

        presenter.onMachineSelected(machineState1);

        verify(machinePromise).catchError(errorPromiseCaptor.capture());
        errorPromiseCaptor.getValue().apply(error);

        verify(machineState1).getName();
        verify(locale).unavailableMachineStarting(anyString());
        verify(appliance).showStub(anyString());

        assertThat(presenter.isMachineRunning(), is(false));
        assertThat(machineState1, is(equalTo(presenter.getSelectedMachineState())));
    }

