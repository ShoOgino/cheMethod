    @Before
    public void setUp() {
        statusNotifier = new MachineStatusNotifier(eventBus, initialLoadingInfo, machineServiceClient, notificationManager, locale);
        eventBus.addHandler(MachineStateEvent.TYPE, handler);

        when(machine.getConfig()).thenReturn(machineConfig);
        when(machineConfig.getName()).thenReturn(MACHINE_NAME);
        when(environmentStatusChangedEvent.getMachineId()).thenReturn(MACHINE_ID);
        when(environmentStatusChangedEvent.getMachineName()).thenReturn(MACHINE_NAME);
        when(machineServiceClient.getMachine(MACHINE_ID)).thenReturn(machinePromise);
        when(machinePromise.then(Matchers.<Operation<MachineDto>>anyObject())).thenReturn(machinePromise);
        when(machinePromise.catchError(Matchers.<Operation<PromiseError>>anyObject())).thenReturn(machinePromise);
    }

