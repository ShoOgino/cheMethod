    @Before
    public void setUp() {
        statusNotifier = new MachineStatusNotifier(eventBus, machineServiceClient, notificationManager, locale, loader);
        eventBus.addHandler(MachineStateEvent.TYPE, handler);

        when(machine.getConfig()).thenReturn(machineConfig);
        when(machineConfig.getName()).thenReturn(MACHINE_NAME);
        when(machineStatusChangedEvent.getMachineId()).thenReturn(MACHINE_ID);
        when(machineStatusChangedEvent.getWorkspaceId()).thenReturn(WORKSPACE_ID);
        when(machineStatusChangedEvent.getMachineName()).thenReturn(MACHINE_NAME);
        when(machineServiceClient.getMachine(WORKSPACE_ID, MACHINE_ID)).thenReturn(machinePromise);
        when(machinePromise.then(Matchers.<Operation<MachineDto>>anyObject())).thenReturn(machinePromise);
        when(machinePromise.catchError(Matchers.<Operation<PromiseError>>anyObject())).thenReturn(machinePromise);
    }

