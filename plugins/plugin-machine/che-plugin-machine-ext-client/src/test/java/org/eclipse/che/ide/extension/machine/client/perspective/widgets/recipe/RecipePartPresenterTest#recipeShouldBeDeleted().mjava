    @Test
    public void recipeShouldBeDeleted() throws Exception {
        NewRecipe newRecipe = mock(NewRecipe.class);
        when(dtoFactory.createDto(NewRecipe.class)).thenReturn(newRecipe);
        when(newRecipe.withType(anyString())).thenReturn(newRecipe);
        when(newRecipe.withScript(anyString())).thenReturn(newRecipe);
        when(newRecipe.withName(anyString())).thenReturn(newRecipe);
        when(newRecipe.withTags(Matchers.<List<String>>any())).thenReturn(newRecipe);
        when(service.createRecipe(newRecipe)).thenReturn(recipeDescriptorPromise);
        when(recipesContainerPresenter.getEditorPanel(Matchers.<RecipeWidget>any())).thenReturn(recipeEditorPanel);

        when(recipeDescriptor1.getId()).thenReturn("id");
        when(service.removeRecipe(anyString())).thenReturn(deletePromise);

        recipePartPresenter.onNewButtonClicked();

        verify(recipeDescriptorPromise).then(operationDescriptorCaptor.capture());
        operationDescriptorCaptor.getValue().apply(recipeDescriptor1);

        recipePartPresenter.onDeleteButtonClicked();

        verify(deletePromise).then(deleteCaptor.capture());
    }

