    @Test
    public void onEnterClickedWhenSaveButtonInFocus() throws Exception {
        when(view.isCancelButtonInFocus()).thenReturn(false);
        when(view.isCloseButtonInFocus()).thenReturn(false);

        when(view.getSelectedCommand()).thenReturn(command);

        when(commandPromise.then((Operation)anyObject())).thenReturn(commandPromise);
        when(commandPromise.catchError((Operation)anyObject())).thenReturn(commandPromise);

        presenter.onEnterClicked();

        verify(commandManager).update(anyString(), eq(command));

        verify(commandPromise, times(2)).then(commandCaptor.capture());
        commandCaptor.getValue().apply(command);

        verify(view).setCancelButtonState(false);
        verify(view).setSaveButtonState(false);
        verify(commandManager).getCommands();
        verify(view).setData(anyObject());
        verify(view).setFilterState(anyBoolean());
        verify(view).setCloseButtonInFocus();
        verify(view, never()).close();
    }

