    @Before
    public void setUp() {
        when(dialogFactory.createConfirmDialog(anyString(),
                                               anyString(),
                                               Matchers.<ConfirmCallback>anyObject(),
                                               Matchers.<CancelCallback>anyObject())).thenReturn(confirmDialog);

        when(promise.then(operationSuccessCapture.capture())).thenReturn(promise);


        arbitraryCategoryPresenter = new SshCategoryPresenter(sshView,
                                                              recipeServiceClient,
                                                              dtoFactory,
                                                              dtoUnmarshallerFactory,
                                                              dialogFactory,
                                                              notificationManager,
                                                              machineLocale,
                                                              workspaceServiceClient,
                                                              appContext,
                                                              machineService,
                                                              eventBus,
                                                              messageBusProvider);
        arbitraryCategoryPresenter.setTargetsTreeManager(targetsTreeManager);
        arbitraryCategoryPresenter.setCurrentSelection(target);
    }

