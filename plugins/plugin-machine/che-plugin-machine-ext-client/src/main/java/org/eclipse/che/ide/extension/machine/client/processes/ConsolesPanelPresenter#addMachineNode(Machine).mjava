    private ProcessTreeNode addMachineNode(final Machine machine) {
        if (machineNodes.containsKey(machine.getId())) {
            return machineNodes.get(machine.getId());
        }

        ProcessTreeNode machineNode = new ProcessTreeNode(MACHINE_NODE, rootNode, machine, null, new ArrayList<ProcessTreeNode>());
        machineNode.setRunning(true);
        machineNodes.put(machine.getId(), machineNode);

        if (rootNodes.contains(machineNode)) {
            rootNodes.remove(machineNode);
        }

        rootNodes.add(machineNode);

        view.setProcessesData(rootNode);

        OutputConsole outputConsole = commandConsoleFactory.create("");
        updateCommandOutput(machine.getId(), outputConsole);

        restoreState(machine);

        return machineNode;
    }

