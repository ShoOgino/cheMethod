    /**
     * Ensures machine is started.
     */
    private void ensureMachineIsStarted(final String machineId) {
        machineService.getMachine(machineId).then(new Operation<MachineDto>() {
            @Override
            public void apply(MachineDto machineDto) throws OperationException {
                if (machineDto.getStatus() == RUNNING) {
                    eventBus.fireEvent(new MachineStateEvent(machineDto, MachineStateEvent.MachineAction.RUNNING));
                    onConnected();
                } else {
                    new Timer() {
                        @Override
                        public void run() {
                            ensureMachineIsStarted(machineId);
                        }
                    }.schedule(1000);
                }
            }
        }).catchError(new Operation<PromiseError>() {
            @Override
            public void apply(PromiseError arg) throws OperationException {
                onConnectingFailed();
            }
        });
    }

