    private void refreshView() {
        reset();

        List<CommandImpl> allCommands = commandManager.getCommands();
        Map<CommandType, List<CommandImpl>> typeToCommands = new HashMap<>();

        for (CommandType type : commandTypeRegistry.getCommandTypes()) {
            final List<CommandImpl> commandsOfType = new ArrayList<>();

            for (CommandImpl command : allCommands) {
                if (type.getId().equals(command.getType())) {
                    commandsOfType.add(command);
                }
            }

            Collections.sort(commandsOfType, commandsComparator);
            typeToCommands.put(type, commandsOfType);
        }

        view.setData(typeToCommands);
        view.setFilterState(!allCommands.isEmpty());

        if (commandProcessingCallback != null) {
            commandProcessingCallback.onCompleted();
            commandProcessingCallback = null;
        }
    }

