    @Override
    public void onMachineDestroyed(MachineStateEvent event) {
        ProcessTreeNode destroyedMachineNode = machineNodes.get(event.getMachineId());
        if (destroyedMachineNode == null) {
            return;
        }

        rootNodes.remove(destroyedMachineNode);
        view.setProcessesData(rootNode);

        final Collection<ProcessTreeNode> children = new ArrayList<>();
        children.addAll(destroyedMachineNode.getChildren());
        for (ProcessTreeNode child : children) {
            if (TERMINAL_NODE.equals(child.getType()) && terminals.containsKey(child.getId())) {
                onCloseTerminal(child);
            } else if (COMMAND_NODE.equals(child.getType()) && consoles.containsKey(child.getId())) {
                onStopCommandProcess(child);
                view.hideProcessOutput(child.getId());
            }
        }

        view.hideProcessOutput(destroyedMachineNode.getId());
    }

