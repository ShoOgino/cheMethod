  private void prepareAndMockServers() throws ServerException, NotFoundException {
    ServerDto server1 = newDto(ServerDto.class).withUrl("http://localhost:38001/exec");
    ServerDto server2 = newDto(ServerDto.class).withUrl("http://localhost:38002/exec");
    Map<String, ServerDto> map1 = new HashMap<>();
    Map<String, ServerDto> map2 = new HashMap<>();
    map1.put(SERVER_EXEC_AGENT_HTTP_REFERENCE, server1);
    map2.put(SERVER_EXEC_AGENT_HTTP_REFERENCE, server2);
    MachineDto machine1 = newDto(MachineDto.class).withServers(map1);
    MachineDto machine2 = newDto(MachineDto.class).withServers(map2);
    Map<String, MachineDto> machineMap = new HashMap<>();
    machineMap.put("machine1", machine1);
    machineMap.put("machine2", machine2);

    when(workspaceManager.getWorkspace(anyString())).thenReturn(workspace);
    when(workspace.getRuntime()).thenReturn(runtime);
    when(runtime.getMachines()).thenReturn(machineMap);
  }

