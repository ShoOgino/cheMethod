  /**
   * Convert DBG specific location to VFS one.
   *
   * @return VFS specific location.
   */
  public Location convertToVFS(Location dbgLocation) {
    String remotePath = dbgLocation.getResourceProjectPath();
    String wsPath = absolutize(remotePath);
    if (wsPath.startsWith("/projects")) {
      wsPath = wsPath.substring("/projects".length());
    }

    if (!fsManager.exists(wsPath)) {
      return null;
    }

    String resourceProjectPath =
        projectManager
            .getClosest(wsPath)
            .orElseThrow(() -> new IllegalArgumentException("Can't find project"))
            .getPath();
    String target = nameOf(wsPath);
    int lineNumber = dbgLocation.getLineNumber();
    return new LocationImpl(
        target,
        lineNumber,
        false,
        null,
        resourceProjectPath,
        dbgLocation.getMethod(),
        dbgLocation.getThreadId());
  }

