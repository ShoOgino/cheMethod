  /** Stops nodejs process. */
  public void stop() {
    boolean interrupted = false;
    observers.clear();

    try {
      send("quit");
    } catch (NodeJsDebuggerException e) {
      LOG.warn("Failed to execute 'quit' command. " + e.getMessage());
    }

    try {
      processWriter.close();
    } catch (IOException ignored) {
      // ignore
    }

    executor.shutdown();
    try {
      if (!executor.awaitTermination(10, TimeUnit.SECONDS)) {
        executor.shutdownNow();
        if (!executor.awaitTermination(10, TimeUnit.SECONDS)) {
          LOG.error("Unable to terminate pool of NodeJs debugger tasks.");
        }
      }
    } catch (InterruptedException e) {
      interrupted = true;
      if (!executor.isShutdown()) {
        LOG.error("Unable to terminate pool of NodeJs debugger tasks.");
      }
    }

    process.destroy();
    try {
      if (!process.waitFor(10, TimeUnit.SECONDS)) {
        LOG.error("Unable to terminate NodeJs process.");
      }
    } catch (InterruptedException e) {
      interrupted = true;
      if (!process.isAlive()) {
        LOG.error("Unable to terminate NodeJs process.");
      }
    }

    if (interrupted) {
      Thread.currentThread().interrupt();
    }
  }

