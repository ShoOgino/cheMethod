    /**
     * {@inheritDoc}
     */
    @Override
    public TestResult execute(Map<String, String> testParameters,
                              TestClasspathProvider classpathProvider) throws Exception {

        projectPath = testParameters.get("absoluteProjectPath");
        String xmlPath = testParameters.get("testngXML");
        boolean updateClasspath = Boolean.valueOf(testParameters.get("updateClasspath"));
        boolean runClass = Boolean.valueOf(testParameters.get("runClass"));
        projectClassLoader = classpathProvider.getClassLoader(projectPath, updateClasspath);
        TestResult testResult;

        if (runClass) {
            String fqn = testParameters.get("fqn");
            testResult = run(fqn);
        } else {
            if (xmlPath == null) {
                testResult = runAll();
            } else {
                testResult = runTestXML(ResourcesPlugin.getPathToWorkspace() + xmlPath);
            }
        }
        return testResult;
    }

