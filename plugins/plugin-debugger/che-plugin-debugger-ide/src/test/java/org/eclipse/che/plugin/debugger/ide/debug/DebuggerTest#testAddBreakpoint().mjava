    @Test
    public void testAddBreakpoint() throws Exception {
        doReturn(promiseVoid).when(service).addBreakpoint(SESSION_ID, breakpointDto);
        doReturn(promiseVoid).when(promiseVoid).then((Operation<Void>)any());

        debugger.addBreakpoint(file, LINE_NUMBER);

        verify(locationDto).setLineNumber(LINE_NUMBER + 1);
        verify(locationDto).setTarget(FQN);

        verify(breakpointDto).setLocation(locationDto);
        verify(breakpointDto).setEnabled(true);

        verify(promiseVoid).then(operationVoidCaptor.capture());
        operationVoidCaptor.getValue().apply(null);
        verify(observer).onBreakpointAdded(breakpointCaptor.capture());
        assertEquals(breakpointCaptor.getValue(), TEST_BREAKPOINT);

        verify(promiseVoid).catchError(operationPromiseErrorCaptor.capture());
        operationPromiseErrorCaptor.getValue().apply(promiseError);
        verify(promiseError).getMessage();
    }

