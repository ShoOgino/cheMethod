    @Test
    public void testAddBreakpoint() throws Exception {
        doReturn(promiseVoid).when(service).addBreakpoint(DEBUGGER_ID, breakpoint);
        doReturn(promiseVoid).when(promiseVoid).then((Operation<Void>)any());

        debugger.addBreakpoint(file, LINE_NUMBER);

        verify(location).setLineNumber(LINE_NUMBER + 1);
        verify(location).setClassName(FQN);

        verify(breakpoint).setLocation(location);
        verify(breakpoint).setEnabled(true);

        verify(promiseVoid).then(operationVoidCaptor.capture());
        operationVoidCaptor.getValue().apply(null);
        verify(observer).onBreakpointAdded(breakpointCaptor.capture());
        assertEquals(breakpointCaptor.getValue(), TEST_BREAKPOINT);

        verify(promiseVoid).catchError(operationPromiseErrorCaptor.capture());
        operationPromiseErrorCaptor.getValue().apply(promiseError);
        verify(promiseError).getMessage();
    }

