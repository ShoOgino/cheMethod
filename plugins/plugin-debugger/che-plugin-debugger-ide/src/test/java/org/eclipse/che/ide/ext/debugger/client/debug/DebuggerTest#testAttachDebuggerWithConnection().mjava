    @Test
    public void testAttachDebuggerWithConnection() throws Exception {
        Map<String, String> connectionProperties = mock(Map.class);

        try {
            debugger.attachDebugger(connectionProperties);
        } catch (UnsatisfiedLinkError e) {
            assertTrue(e.getMessage().contains("JsPromiseError.create"));  // verify calling "Promises.resolve(null)"
            verify(service, never()).connect(any());
            return;
        }

        fail("debugger.attachDebugger() didn't try to obtain rejected promise when there is a connection");
    }

