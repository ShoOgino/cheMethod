  @Override
  public void setVariableValue(Variable variable, SimpleValue value) {
    MutableVariableImpl nodeData = new MutableVariableImpl(variable);

    TreeNodeElement<MutableVariable> node = variables.getNode(nodeData);
    if (node != null) {
      node.getData().setValue(value);

      SpanElement element = variables.getModel().getNodeRenderer().renderNodeContents(nodeData);
      node.getNodeLabel().setInnerHTML(element.getInnerHTML());

      for (Variable nestedVariable : value.getVariables()) {
        setVariableValue(nestedVariable, nestedVariable.getValue());
      }

      if (node.isOpen()) {
        if (value.getVariables().isEmpty()) {
          variables.closeNode(node);
        } else {
          variables.expandNode(node);
        }
      }
    }
  }

