  @SuppressWarnings("unchecked")
  public ExecutorPromiseMocker(
      final Executor.ExecutorBody<T> executorBody,
      final BiFunction<T, PromiseMocker<T>, Void> onResolved,
      final BiFunction<PromiseError, PromiseMocker<T>, Void> onRejected) {
    super();
    resolveFunction = (ResolveFunction<T>) mock(ResolveFunction.class);
    rejectFunction = mock(RejectFunction.class);

    doAnswer(
            new FunctionAnswer<T, Void>(
                resolvedValue -> {
                  onResolved.apply(resolvedValue, this);
                  return null;
                }))
        .when(resolveFunction)
        .apply(org.mockito.ArgumentMatchers.<T>any());

    doAnswer(
            new FunctionAnswer<PromiseError, Void>(
                promiseError -> {
                  onRejected.apply(promiseError, this);
                  return null;
                }))
        .when(rejectFunction)
        .apply(any(PromiseError.class));
  }

