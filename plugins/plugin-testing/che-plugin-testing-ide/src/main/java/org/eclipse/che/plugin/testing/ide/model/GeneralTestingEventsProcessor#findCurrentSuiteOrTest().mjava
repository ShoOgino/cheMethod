    private TestState findCurrentSuiteOrTest() {
        TestState result;
        if (testNameToTestState.size() == 1) {
            result = testNameToTestState.values().iterator().next();
        } else {
            if (testSuiteStack.isEmpty()) {
                result = testRootState;
            } else {
                result = getCurrentSuite();
            }
        }
        return result;
    }

