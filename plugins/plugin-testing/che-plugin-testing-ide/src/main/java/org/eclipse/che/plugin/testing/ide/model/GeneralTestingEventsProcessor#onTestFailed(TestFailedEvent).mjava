  @Override
  public void onTestFailed(TestFailedEvent event) {
    String name = event.getName();

    TestState testState = getStateByStateName(name);
    if (testState == null) {
      onTestStarted(new TestStartedEvent(name, null));
      testState = getStateByStateName(name);
    }

    if (testState == null) {
      return;
    }

    testState.setTestFailed(event.getFailureMessage(), event.getStackTrace(), event.isError());

    callTestFailed(testState);
  }

