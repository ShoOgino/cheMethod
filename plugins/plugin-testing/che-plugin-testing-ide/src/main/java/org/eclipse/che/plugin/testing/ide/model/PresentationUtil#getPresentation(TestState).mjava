  public static String getPresentation(TestState testState) {
    TestState parent = testState.getParent();
    String name = testState.getName();
    String result = name;
    if (parent != null) {
      String parentName = parent.getName();
      if (parentName != null) {
        boolean startsWith = name.startsWith(parentName);
        if (!startsWith && parent instanceof TestRootState) {
          String presentation = parent.getPresentation();
          if (presentation != null) {
            parentName = presentation;
            startsWith = name.startsWith(parentName);

            if (!startsWith) {
              String comment = ((TestRootState) parent).getComment();
              if (comment != null) {
                parentName = asQualifiedName(comment, presentation);
                startsWith = name.startsWith(parentName);
              }
            }
          }
        }

        if (startsWith) {
          result = name.substring(parentName.length());
          result = StringUtils.trimStart(result, ".");
        }
      }
    }
    result = result.trim();

    if (result.isEmpty()) {
      return TEST_WITHOUT_NAME;
    }

    return result;
  }

