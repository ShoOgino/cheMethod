  @Test
  public void testGetWordAtOffsetMultiLine() throws Exception {
    when(document.getLineAtOffset(16)).thenReturn(2);
    when(document.getLineContent(2)).thenReturn("foo bar !fooBar'  ");
    when(document.getLineStart(2)).thenReturn(5);

    Position wordAtOffset = detectionUtil.getWordAtOffset(document, 16);

    assertNotNull(wordAtOffset);
    assertEquals(14, wordAtOffset.offset);
    assertEquals(6, wordAtOffset.length);
  }

