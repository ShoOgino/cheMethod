    private LinearRange computeLastSelection(
        Document document, TextEdit mainEdit, List<TextEdit> allEdits) {
      Range range = mainEdit.getRange();
      TextPosition textPosition =
          new TextPosition(range.getStart().getLine(), range.getStart().getCharacter());
      int startOffset =
          document.getIndexFromPosition(textPosition) + mainEdit.getNewText().length();
      for (TextEdit textEdit : allEdits) {
        startOffset += offsetForEdit(document, textEdit, textPosition);
      }
      return LinearRange.createWithStart(startOffset).andLength(0);
    }

