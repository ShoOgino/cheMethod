    public TextDocumentPositionParamsDTO createTDPP(Document document, int cursorOffset) {
        TextDocumentPositionParamsDTO paramsDTO = dtoFactory.createDto(TextDocumentPositionParamsDTO.class);
        TextDocumentIdentifierDTO identifierDTO = dtoFactory.createDto(TextDocumentIdentifierDTO.class);
        identifierDTO.setUri(document.getFile().getLocation().toString());

        PositionDTO positionDTO = dtoFactory.createDto(PositionDTO.class);
        TextPosition position = document.getPositionFromIndex(cursorOffset);
        positionDTO.setCharacter(position.getCharacter());
        positionDTO.setLine(position.getLine());

        paramsDTO.setUri(document.getFile().getLocation().toString());
        paramsDTO.setTextDocument(identifierDTO);
        paramsDTO.setPosition(positionDTO);
        return paramsDTO;
    }

