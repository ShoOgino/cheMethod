  private void nextToken() {
    nextChar();
    if (value == '\\') {
      char nextChar = peekChar(pos + 1);
      String esc = inChoice ? choiceEscapeChars : escapeChars;
      int index = esc.indexOf(nextChar);
      if (index >= 0) {
        token = Token.values()[index];
        nextChar();
      }
    } else {
      int index = tokenChars.indexOf(value);
      if (index >= 0) {
        token = Token.values()[index];
      } else if (Character.isDigit(value)) {
        token = Token.DIGIT;
      } else if (value == (char) -1) {
        token = Token.EOF;
      } else {
        token = Token.OTHER;
      }
    }
  }

