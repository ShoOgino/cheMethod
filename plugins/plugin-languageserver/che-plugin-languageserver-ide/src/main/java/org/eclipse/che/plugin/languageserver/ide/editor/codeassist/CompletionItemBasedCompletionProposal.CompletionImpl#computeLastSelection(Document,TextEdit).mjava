    private LinearRange computeLastSelection(Document document, TextEdit textEdit) {
      Range range = textEdit.getRange();
      TextPosition textPosition =
          new TextPosition(range.getStart().getLine(), range.getStart().getCharacter());
      int startOffset =
          document.getIndexFromPosition(textPosition) + textEdit.getNewText().length();
      return LinearRange.createWithStart(startOffset).andLength(0);
    }

