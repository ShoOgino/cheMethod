    @Override
    public LinearRange getSelection(Document document) {
      final TextEdit textEdit = completionItem.getTextEdit();
      if (textEdit == null) {
        return LinearRange.createWithStart(document.getCursorOffset() + insertedText.length())
            .andLength(0);
      }
      Range range = textEdit.getRange();
      TextPosition textPosition =
          new TextPosition(range.getStart().getLine(), range.getStart().getCharacter());
      int startOffset =
          document.getIndexFromPosition(textPosition) + textEdit.getNewText().length();
      return LinearRange.createWithStart(startOffset).andLength(0);
    }

