  private <T> Promise<T> failIfNull(Promise<Optional<T>> optionalPromis) {
    return optionalPromis.thenPromise(
        (optional) -> {
          return promiseProvider.create(
              Executor.create(
                  (resolve, reject) -> {
                    if (optional.isPresent()) {
                      resolve.apply(optional.get());
                    } else {
                      reject.apply(JsPromiseError.create("optional is null"));
                    }
                  }));
        });
  }

