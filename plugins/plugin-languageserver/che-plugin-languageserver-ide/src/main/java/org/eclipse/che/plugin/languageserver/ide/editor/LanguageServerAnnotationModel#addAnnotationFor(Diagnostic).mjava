    private void addAnnotationFor(Diagnostic diagnostic) {
        Log.debug(getClass(), "adding annotation for "+diagnostic);
        DiagnosticAnnotation annotation = new DiagnosticAnnotation(diagnostic);
        generatedAnnotations.put(diagnostic, annotation);
        Position position = createPositionFromDiagnostic(diagnostic);
        if (position != null) {
            addAnnotation(annotation, position, false);
        } else {
            Log.error(getClass(), "Position is null for "+diagnostic);
        }
    }

