    private void onOpen(final FileEvent event,
                        final DtoFactory dtoFactory,
                        final TextDocumentServiceClient serviceClient,
                        final LanguageServerFileTypeRegister fileTypeRegister) {
        event.getFile().getContent().then(new Operation<String>() {
            @Override
            public void apply(String text) throws OperationException {
                TextDocumentItemDTO documentItem = dtoFactory.createDto(TextDocumentItemDTO.class);
                documentItem.setUri(event.getFile().getPath());
                documentItem.setVersion(LanguageServerEditorConfiguration.INITIAL_DOCUMENT_VERSION);
                documentItem.setText(text);
                documentItem.setLanguageId(fileTypeRegister.findLangId(event.getFile().getLocation().getFileExtension()));

                DidOpenTextDocumentParamsDTO openEvent = dtoFactory.createDto(DidOpenTextDocumentParamsDTO.class);
                openEvent.setTextDocument(documentItem);
                openEvent.setUri(event.getFile().getPath());
                openEvent.setText(text);

                serviceClient.didOpen(openEvent);
            }
        });
    }

