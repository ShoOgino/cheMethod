    private void computeProposals(String currentWord, int offset, CodeAssistCallback callback) {
        List<CompletionProposal> proposals = newArrayList();
        for (ExtendedCompletionItem item : latestCompletionResult.getCompletionList().getItems()) {
            List<Match> highlights = filter(currentWord, item.getItem());
            if (highlights != null) {
                proposals.add(new CompletionItemBasedCompletionProposal(item,
                                                                        currentWord,
                                                                        documentServiceClient,
                                                                        resources,
                                                                        imageProvider.getIcon(item.getItem().getKind()),
                                                                        serverCapabilities,
                                                                        highlights,
                                                                        offset));
            }
        }
        callback.proposalComputed(proposals);
    }

