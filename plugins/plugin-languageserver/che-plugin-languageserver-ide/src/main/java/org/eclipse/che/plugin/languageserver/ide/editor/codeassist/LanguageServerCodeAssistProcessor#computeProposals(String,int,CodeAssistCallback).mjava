    private void computeProposals(String currentWord, int offset, CodeAssistCallback callback) {
        List<CompletionProposal> proposals = newArrayList();
        for (ExtendedCompletionItem item : latestCompletionResult.getCompletionList().getItems()) {
            List<Match> highlights = filter(currentWord, item);
            if (highlights != null) {
                proposals.add(new CompletionItemBasedCompletionProposal(item,
                                                                        currentWord,
                                                                        documentServiceClient,
                                                                        latestCompletionResult.getDocumentId(),
                                                                        resources,
                                                                        imageProvider.getIcon(item.getKind()),
                                                                        serverCapabilities,
                                                                        highlights,
                                                                        offset));
            }
        }
        callback.proposalComputed(proposals);
    }

