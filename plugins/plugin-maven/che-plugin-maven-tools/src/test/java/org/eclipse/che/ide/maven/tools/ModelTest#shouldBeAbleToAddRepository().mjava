  @Test
  public void shouldBeAbleToAddRepository() throws Exception {
    final File pom = getTestPomFile();
    write(
        pom,
        "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n"
            + "<project>\n"
            + "    <!-- Repositories --> \n"
            + "    <repositories>\n"
            + "        <repository>\n"
            + "            <id>central</id>\n"
            + "            <name>Central Repository</name>\n"
            + "            <url>http://repo.maven.apache.org/maven2</url>\n"
            + "            <layout>default</layout>\n"
            + "            <releases>\n"
            + "                <enabled>true</enabled>\n"
            + "                <updatePolicy>daily</updatePolicy>\n"
            + "                <checksumPolicy>warn</checksumPolicy>\n"
            + "            </releases>\n"
            + "        </repository>\n"
            + "    </repositories>\n"
            + "</project>");

    final Model model =
        Model.readFrom(pom)
            .addRepository(
                new Repository().setId("id").setLayout("default").setUrl("url").setName("name"));
    model.save();
    assertEquals(model.getRepositories().size(), 2);
    assertEquals(
        read(pom),
        "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n"
            + "<project>\n"
            + "    <!-- Repositories --> \n"
            + "    <repositories>\n"
            + "        <repository>\n"
            + "            <id>central</id>\n"
            + "            <name>Central Repository</name>\n"
            + "            <url>http://repo.maven.apache.org/maven2</url>\n"
            + "            <layout>default</layout>\n"
            + "            <releases>\n"
            + "                <enabled>true</enabled>\n"
            + "                <updatePolicy>daily</updatePolicy>\n"
            + "                <checksumPolicy>warn</checksumPolicy>\n"
            + "            </releases>\n"
            + "        </repository>\n"
            + "        <repository>\n"
            + "            <id>id</id>\n"
            + "            <name>name</name>\n"
            + "            <url>url</url>\n"
            + "            <layout>default</layout>\n"
            + "        </repository>\n"
            + "    </repositories>\n"
            + "</project>");
  }

