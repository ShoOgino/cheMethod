  @Test
  public void shouldAddConfigurationWhenFirstConfigurationPropertyAdded() throws Exception {
    final File pom = getTestPomFile();
    write(
        pom,
        "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n"
            + "<project>\n"
            + "    <build>\n"
            + "        <plugins>\n"
            + "            <plugin>\n"
            + "                <artifactId>artifactId</artifactId>\n"
            + "                <groupId>groupId</groupId>\n"
            + "            </plugin>\n"
            + "        </plugins>\n"
            + "    </build>\n"
            + "</project>");
    final Model model = Model.readFrom(pom);

    final Plugin plugin = model.getBuild().getPlugins().get(0);
    plugin.setConfigProperty("item1", "value1");
    model.save();

    assertEquals(
        read(pom),
        "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n"
            + "<project>\n"
            + "    <build>\n"
            + "        <plugins>\n"
            + "            <plugin>\n"
            + "                <artifactId>artifactId</artifactId>\n"
            + "                <groupId>groupId</groupId>\n"
            + "                <configuration>\n"
            + "                    <item1>value1</item1>\n"
            + "                </configuration>\n"
            + "            </plugin>\n"
            + "        </plugins>\n"
            + "    </build>\n"
            + "</project>");
    assertEquals(plugin.getConfiguration(), singletonMap("item1", "value1"));
  }

