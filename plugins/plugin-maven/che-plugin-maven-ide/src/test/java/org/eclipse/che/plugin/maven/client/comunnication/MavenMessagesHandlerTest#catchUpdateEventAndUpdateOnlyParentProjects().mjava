    @Test
    public void catchUpdateEventAndUpdateOnlyParentProjects() throws Exception {
        final List<String> updatedProjects = Arrays.asList("/che/core",
                                                           "/project",
                                                           "/che/core/che-core-db-vendor-postgresql",
                                                           "/che/plugins/plugin-svn",
                                                           "/che/samples/sample-plugin-json",
                                                           "/che/wsmaster/che-core-api-auth",
                                                           "/project/api",
                                                           "/che/wsagent",
                                                           "/che",
                                                           "/che/plugins/plugin-github/che-plugin-github-pullrequest",
                                                           "/che/plugins/plugin-java-debugger");

        when(factory.createDtoFromJson(eq(JSON_MESSAGE), eq(ProjectsUpdateMessage.class))).thenReturn(projectsUpdateMessage);
        when(projectsUpdateMessage.getUpdatedProjects()).thenReturn(updatedProjects);
        when(rootContainer.getContainer(anyString())).thenReturn(optionalContainer);

        verify(eventBus).addHandler(eq(WsAgentStateEvent.TYPE), wsAgentStateHandlerArgumentCaptor.capture());
        wsAgentStateHandlerArgumentCaptor.getValue().onWsAgentStarted(wsAgentStateEvent);

        verify(messageBusPromise).then(operationArgumentCaptor.capture());
        operationArgumentCaptor.getValue().apply(messageBus);

        verify(messageBus).subscribe(eq(MAVEN_CHANEL_NAME), messageHandlerArgumentCaptor.capture());
        messageHandlerArgumentCaptor.getValue().onMessage(JSON_MESSAGE);

        verify(factory).createDtoFromJson(JSON_MESSAGE, ProjectsUpdateMessage.class);
        verify(pomEditorReconciler).reconcilePoms(updatedProjects);
        verify(rootContainer).getContainer(eq("/che"));
        verify(rootContainer).getContainer(eq("/project"));
    }

