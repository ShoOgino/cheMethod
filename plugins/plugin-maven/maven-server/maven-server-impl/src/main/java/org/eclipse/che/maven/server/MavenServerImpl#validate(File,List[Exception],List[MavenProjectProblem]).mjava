    private void validate(File pom, List<Exception> exceptions, List<MavenProjectProblem> problems)
            throws RemoteException {
        for (Throwable exception : exceptions) {

            if (exception instanceof IllegalStateException && exception.getCause() != null) {
                exception = exception.getCause();
            }

            if (exception instanceof InvalidProjectModelException) {
                ModelValidationResult validationResult = ((InvalidProjectModelException)exception).getValidationResult();
                if (validationResult != null) {
                    problems.addAll(validationResult.getMessages().stream()
                                                    .map(s -> MavenProjectProblem.newStructureProblem(pom.getPath(), s))
                                                    .collect(Collectors.toList()));
                } else {
                    problems.add(MavenProjectProblem.newStructureProblem(pom.getPath(), exception.getCause().getMessage()));
                }
            }
            if (exception instanceof ProjectBuildingException) {
                String message = exception.getCause() == null ? exception.getMessage() : exception.getCause().getMessage();
                problems.add(MavenProjectProblem.newStructureProblem(pom.getPath(), message));
            } else {
                MavenServerContext.getLogger().info(exception);
                problems.add(MavenProjectProblem.newStructureProblem(pom.getPath(), exception.getMessage()));
            }
        }
    }

