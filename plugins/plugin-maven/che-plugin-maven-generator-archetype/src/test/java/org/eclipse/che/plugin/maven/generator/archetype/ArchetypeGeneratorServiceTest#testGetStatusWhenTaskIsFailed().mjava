    @Test
    public void testGetStatusWhenTaskIsFailed() throws Exception {
        final Path testLogFile = Paths.get(Thread.currentThread().getContextClassLoader().getResource("test.log").toURI());
        doReturn(true).when(taskMock).isDone();

        GenerationResult generationResult = mock(GenerationResult.class);
        doReturn(false).when(generationResult).isSuccessful();
        doReturn(new File(testLogFile.toString())).when(generationResult).getGenerationReport();

        doReturn(generationResult).when(taskMock).getResult();
        doReturn(taskMock).when(archetypeGenerator).getTaskById(anyLong());

        GenerationTaskDescriptor task = service.getStatus(uriInfo, String.valueOf(taskId));

        Assert.assertEquals(GenerationTaskDescriptor.Status.FAILED, task.getStatus());
        Assert.assertEquals(new String(Files.readAllBytes(testLogFile)), task.getReport());
    }

