    private ModelReadingResult doRead(File pom) {
        List<MavenProjectProblem> problems = new ArrayList<>();
        Set<String> enabledProfiles = new HashSet<>();
        MavenModel result = new MavenModel();

        Model model = null;
        try {
            model = Model.readFrom(pom);
        } catch (IOException e) {
            problems.add(MavenProjectProblem.newProblem(pom.getPath(), e.getMessage(), MavenProblemType.SYNTAX));
        }

        if (model == null) {
            result.setMavenKey(new MavenKey("unknown", "unknown", "unknown"));
            result.setPackaging("jar");
            return new ModelReadingResult(result, problems, enabledProfiles);
        }

        MavenKey parentKey;

        if (model.getParent() == null) {
            parentKey = new MavenKey("unknown", "unknown", "unknown");
            result.setParent(new MavenParent(parentKey, "../pom.xml"));
        } else {
            Parent modelParent = model.getParent();
            parentKey = new MavenKey(modelParent.getGroupId(), modelParent.getArtifactId(), modelParent.getVersion());
            MavenParent parent =
                    new MavenParent(parentKey, modelParent.getRelativePath());
            result.setParent(parent);
        }

        MavenKey mavenKey =
                new MavenKey(getNotNull(model.getGroupId(), parentKey.getGroupId()), model.getArtifactId(),
                             getNotNull(model.getVersion(), parentKey.getVersion()));
        result.setMavenKey(mavenKey);

        result.setPackaging(model.getPackaging() == null ? "jar" : model.getPackaging());
        result.setName(model.getName());
        result.setModules(model.getModules() == null ? Collections.emptyList() : new ArrayList<>(model.getModules()));

        Map<String, String> properties = model.getProperties();
        Properties prop = new Properties();
        if (properties != null) {
            prop.putAll(properties);
        }
        result.setProperties(prop);

        Build build = model.getBuild();
        if (build == null) {
            result.getBuild().setSources(Collections.singletonList(DEFAULT_SOURCE_FOLDER));
            result.getBuild().setTestSources(Collections.singletonList(DEFAULT_TEST_SOURCE_FOLDER));
            result.getBuild().setResources(Collections.singletonList(
                    new MavenResource(DEFAULT_RESOURCES_FOLDER, false, null, Collections.emptyList(), Collections.emptyList())));
            result.getBuild().setTestResources(Collections.singletonList(
                    new MavenResource(DEFAULT_TEST_RESOURCES_FOLDER, false, null, Collections.emptyList(), Collections.emptyList())));
        } else {
            String sourceDirectory = build.getSourceDirectory();
            if (sourceDirectory == null) {
                sourceDirectory = DEFAULT_SOURCE_FOLDER;
            }
            String testSourceDirectory = build.getTestSourceDirectory();
            if (testSourceDirectory == null) {
                testSourceDirectory = DEFAULT_TEST_SOURCE_FOLDER;
            }
            result.getBuild().setSources(Collections.singletonList(sourceDirectory));
            result.getBuild().setTestSources(Collections.singletonList(testSourceDirectory));
            result.getBuild().setResources(convertResources(build.getResources()));
        }
        //TODO add profiles
        return new ModelReadingResult(result, problems, enabledProfiles);
    }

