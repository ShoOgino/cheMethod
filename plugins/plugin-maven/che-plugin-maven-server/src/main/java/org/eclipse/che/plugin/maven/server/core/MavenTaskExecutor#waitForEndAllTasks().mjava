  public void waitForEndAllTasks() {
    if (!isWorking) {
      return;
    }

    Semaphore semaphore = new Semaphore(1);
    try {
      semaphore.acquire();
      submitTask(semaphore::release);

      while (true) {
        if (!isWorking || semaphore.tryAcquire(1, TimeUnit.SECONDS)) {
          return;
        }
      }
    } catch (InterruptedException e) {
      LOG.debug(e.getMessage(), e);
    }
  }

