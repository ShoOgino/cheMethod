  private void doRunTasks(MavenProjectTask task) {
    int taskDone = 0;
    notifier.start();
    while (true) {
      taskDone++;
      int restTasks;
      synchronized (queue) {
        restTasks = queue.size();
      }

      notifier.setPercent((double) taskDone / (double) (restTasks + taskDone));
      try {
        task.perform();
      } catch (Throwable throwable) {
        LOG.error(throwable.getMessage(), throwable);
        //TODO need to notify user some how
      }

      synchronized (queue) {
        task = queue.poll();
        if (task == null) {
          isWorking = false;
          notifier.stop();
          return;
        }
      }
    }
  }

