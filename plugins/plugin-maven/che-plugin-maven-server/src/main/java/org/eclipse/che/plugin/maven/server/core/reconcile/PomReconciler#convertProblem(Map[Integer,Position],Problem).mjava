  private static Diagnostic convertProblem(Map<Integer, Position> positionMap, Problem problem) {
    Diagnostic result = new Diagnostic();
    Position start = positionMap.get(problem.getSourceStart());
    Position end = positionMap.get(problem.getSourceEnd());
    if (start == null || end == null) {
      LOG.error("Could not map problem range: " + problem);
      return null;
    }
    result.setRange(new Range(start, end));
    result.setMessage(problem.getMessage());
    result.setSeverity(problem.isError() ? DiagnosticSeverity.Error : DiagnosticSeverity.Warning);
    return result;
  }

