    public BufferOutputFixedRateSender(String channel, long delay) {
        this.channel = channel;
        ThreadFactory threadFactory = new ThreadFactoryBuilder().setNameFormat(BufferOutputFixedRateSender.class.getSimpleName() + "-%d")
                                                                .setDaemon(true)
                                                                .build();

        executor = Executors.newScheduledThreadPool(1, threadFactory);

        executor.scheduleAtFixedRate(this::sendMessage, 1_000, delay, MILLISECONDS);
    }

