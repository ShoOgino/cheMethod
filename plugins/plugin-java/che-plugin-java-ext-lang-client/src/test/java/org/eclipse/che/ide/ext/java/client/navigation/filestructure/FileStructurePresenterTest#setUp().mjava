    @Before
    public void setUp() throws Exception {
        when(editorPartPresenter.getEditorInput()).thenReturn(editorInput);
        when(editorPartPresenter.getDocument()).thenReturn(document);
        when(editorInput.getFile()).thenReturn(file);
        when(editorPartPresenter.getCursorOffset()).thenReturn(0);
        when(file.getRelatedProject()).thenReturn(Optional.of(relatedProject));
        when(file.getParentWithMarker(eq(SourceFolderMarker.ID))).thenReturn(Optional.of(srcFolder));
        when(file.getName()).thenReturn("A.java");
        when(file.getExtension()).thenReturn("java");
        when(file.getResourceType()).thenReturn(Resource.FILE);
        when(file.getLocation()).thenReturn(Path.valueOf("/project/src/a/b/c/A.java"));
        when(srcFolder.getLocation()).thenReturn(Path.valueOf("/project/src"));
        when(relatedProject.getLocation()).thenReturn(Path.valueOf("/project"));
        when(javaNavigationService.getCompilationUnit(any(Path.class), anyString(), anyBoolean())).thenReturn(promise);
        when(promise.then(Matchers.<Operation<CompilationUnit>>anyObject())).thenReturn(promise);
        when(promise.catchError(Matchers.<Operation<PromiseError>>anyObject())).thenReturn(promise);
        when(loaderFactory.newLoader()).thenReturn(loader);


        presenter = new FileStructurePresenter(view,
                                               javaNavigationService,
                                               context,
                                               editorAgent,
                                               loaderFactory);
    }

