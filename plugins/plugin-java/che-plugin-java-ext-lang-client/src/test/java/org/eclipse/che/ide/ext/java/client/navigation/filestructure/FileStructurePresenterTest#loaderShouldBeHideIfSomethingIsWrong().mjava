  @Test
  public void loaderShouldBeHideIfSomethingIsWrong() throws Exception {
    PromiseError promiseError = Mockito.mock(PromiseError.class);
    presenter.show(editor);

    verify(promise).catchError(operationErrorCapture.capture());
    operationErrorCapture.getValue().apply(promiseError);

    verify(view, never()).setStructure(compilationUnit, false);
    verify(promiseError).getMessage();
    verify(loader).hide();
  }

