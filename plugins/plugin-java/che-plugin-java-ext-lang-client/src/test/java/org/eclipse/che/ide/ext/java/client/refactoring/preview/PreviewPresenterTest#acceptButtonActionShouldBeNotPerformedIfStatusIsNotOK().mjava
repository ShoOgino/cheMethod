  @Test
  public void acceptButtonActionShouldBeNotPerformedIfStatusIsNotOK() throws Exception {
    VirtualFile virtualFile = Mockito.mock(VirtualFile.class);
    EditorInput editorInput = Mockito.mock(EditorInput.class);
    when(refactoringStatus.getSeverity()).thenReturn(2);
    when(editor.getEditorInput()).thenReturn(editorInput);
    when(editorInput.getFile()).thenReturn(virtualFile);

    presenter.onAcceptButtonClicked();

    verify(fileTrackingSuspendEventPromise).then(clientServerSuspendOperation.capture());
    clientServerSuspendOperation.getValue().apply(null);
    verify(refactoringStatusPromise).then(refactoringStatusOperation.capture());
    refactoringStatusOperation.getValue().apply(refactoringStatus);
    verify(clientServerEventService).sendFileTrackingResumeEvent();
    verify(refactoringUpdater).handleMovingFiles(anyList());
    verify(view, never()).close();
    verify(editor, never()).getEditorInput();
    verify(editorInput, never()).getFile();
    verify(virtualFile, never()).getLocation();
    verify(view).showErrorMessage(refactoringStatus);
  }

