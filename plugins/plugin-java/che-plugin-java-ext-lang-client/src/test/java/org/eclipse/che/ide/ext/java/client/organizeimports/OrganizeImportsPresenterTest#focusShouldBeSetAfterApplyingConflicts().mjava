  @Test
  public void focusShouldBeSetAfterApplyingConflicts() throws Exception {
    when(view.getSelectedImport()).thenReturn("import1");
    when(dtoFactory.createDto(ConflictImportDTO.class)).thenReturn(conflict1);
    when(conflict1.withTypeMatches(org.mockito.ArgumentMatchers.<List<String>>anyObject()))
        .thenReturn(conflict1);
    when(javaCodeAssistClient.applyChosenImports(anyString(), anyString(), any()))
        .thenReturn(resolveConflictsPromise);
    when(resolveConflictsPromise.then(
            org.mockito.ArgumentMatchers.<Operation<List<Change>>>anyObject()))
        .thenReturn(resolveConflictsPromise);

    showOrganizeImportsWindow();
    presenter.onFinishButtonClicked();

    verify(resolveConflictsPromise).then(resolveConflictsOperation.capture());
    resolveConflictsOperation.getValue().apply(null);

    verify(editor).setFocus();
    verify(view).hide();
    verify(clientServerEventService).sendFileTrackingResumeEvent();
  }

