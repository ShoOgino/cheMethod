    @Test
    public void organizeImportsShouldBeDoneWithoutConflicts() throws Exception {
        when(file.getContent()).thenReturn(contentPromise);
        when(contentPromise.then(any(Operation.class))).thenReturn(contentPromise);
        when(organizeImportResult.getConflicts()).thenReturn(null);
        when(organizeImportResult.getChanges()).thenReturn(Collections.singletonList(change));
        when(change.getOffset()).thenReturn(0);
        when(change.getLength()).thenReturn("content".length());
        when(change.getText()).thenReturn("content");
        presenter.organizeImports(editor);

        verify(javaCodeAssistClient).organizeImports(eq("/project"), eq("a.b.A"));
        verify(importsPromise).then(importsOperation.capture());
        importsOperation.getValue().apply(organizeImportResult);

        verify(document).replace(eq(0), eq("content".length()), eq("content"));
    }

