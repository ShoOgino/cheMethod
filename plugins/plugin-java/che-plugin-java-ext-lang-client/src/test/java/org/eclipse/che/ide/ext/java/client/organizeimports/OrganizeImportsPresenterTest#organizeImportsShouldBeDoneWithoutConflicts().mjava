    @Test
    public void organizeImportsShouldBeDoneWithoutConflicts() throws Exception {
        when(file.getContent()).thenReturn(contentPromise);
        when(contentPromise.then(any(Operation.class))).thenReturn(contentPromise);

        presenter.organizeImports(editor);

        verify(javaCodeAssistClient).organizeImports(eq("/project"), eq("a.b.A"));
        verify(importsPromise).then(importsOperation.capture());
        importsOperation.getValue().apply(Collections.emptyList());

        verify(file.getContent()).then(contentCaptor.capture());
        contentCaptor.getValue().apply("content");

        verify(document).replace(eq(0), eq("content".length()), eq("content"));
    }

