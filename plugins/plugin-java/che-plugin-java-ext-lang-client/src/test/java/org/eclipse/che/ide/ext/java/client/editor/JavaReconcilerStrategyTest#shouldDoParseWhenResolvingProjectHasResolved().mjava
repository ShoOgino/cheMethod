  @Test
  public void shouldDoParseWhenResolvingProjectHasResolved() throws Exception {
    when(resolvingProjectStateHolder.getState()).thenReturn(RESOLVED);
    HighlightedPosition highlightedPosition = mock(HighlightedPosition.class);
    List<HighlightedPosition> positions = new ArrayList<>();
    positions.add(highlightedPosition);
    when(reconcileResult.getHighlightedPositions()).thenReturn(positions);

    javaReconcilerStrategy.parse();

    verify(reconcileResultPromise).onSuccess(reconcileResultCaptor.capture());
    reconcileResultCaptor.getValue().accept(reconcileResult);

    verify(reconcileResult).getProblems();
    verify(reconcileResult).getHighlightedPositions();
    verify(codeAssistProcessor).enableCodeAssistant();
    verify(codeAssistProcessor, never()).disableCodeAssistant(anyString());
    verify(highlighter).reconcile(eq(positions));
  }

