  @Test
  public void moveDestinationPathChangedWithERRORStatus() throws Exception {
    when(refactoringStatus.getSeverity()).thenReturn(ERROR);

    presenter.setMoveDestinationPath(DESTINATION, PROJECT_PATH);

    verify(destination).setType(ReorgDestination.DestinationType.PACKAGE);
    verify(destination).setSessionId(nullable(String.class));
    verify(destination).setProjectPath(PROJECT_PATH);
    verify(destination).setDestination(DESTINATION);

    verify(refactoringStatusPromise).then(refactoringStatusOperation.capture());
    refactoringStatusOperation.getValue().apply(refactoringStatus);
    verify(moveView).setEnableAcceptButton(true);
    verify(moveView).setEnablePreviewButton(true);

    verify(moveView).showErrorMessage(refactoringStatus);
    verify(moveView).setEnableAcceptButton(false);
    verify(moveView).setEnablePreviewButton(false);
  }

