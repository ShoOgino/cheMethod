    @Override
    public Promise<String> expand() {
        final Resource[] resources = appContext.getResources();

        if (resources == null || resources.length != 1) {
            return promises.resolve("");
        }

        final Resource resource = resources[0];
        final Optional<Project> project = resource.getRelatedProject();

        if (!JavaUtil.isJavaProject(project.get())) {
            return promises.resolve("");
        }

        final String projectPath = project.get().getLocation().toString();

        return classpathContainer.getClasspathEntries(projectPath).then(new Function<List<ClasspathEntryDto>, String>() {
            @Override
            public String apply(List<ClasspathEntryDto> arg) throws FunctionException {
                classpathResolver.resolveClasspathEntries(arg);
                Set<String> sources = classpathResolver.getSources();
                StringBuilder classpath = new StringBuilder();
                for (String source : sources) {
                    classpath.append(source.substring(projectPath.length() + 1)).append(':');
                }

                if (classpath.toString().isEmpty()) {
                    classpath.append(appContext.getProjectsRoot().toString()).append(projectPath);
                }

                return classpath.toString();
            }
        });
    }

