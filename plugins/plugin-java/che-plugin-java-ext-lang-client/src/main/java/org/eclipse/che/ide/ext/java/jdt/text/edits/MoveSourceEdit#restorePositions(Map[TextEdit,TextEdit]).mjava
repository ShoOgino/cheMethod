    private static void restorePositions(Map<TextEdit, TextEdit> editMap) {
        for (Iterator<TextEdit> iter = editMap.keySet().iterator(); iter.hasNext(); ) {
            TextEdit marker = iter.next();
            TextEdit edit = editMap.get(marker);
            if (marker.isDeleted()) {
                edit.markAsDeleted();
            } else {
                edit.adjustOffset(marker.getOffset() - edit.getOffset());
                edit.adjustLength(marker.getLength() - edit.getLength());
            }
        }
    }

