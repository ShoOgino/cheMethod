    /**
     * A list of positions in the given category with an end position inside the given region. The order of the positions is
     * arbitrary.
     *
     * @param category
     *         the position category
     * @param offset
     *         the offset of the region
     * @param length
     *         the length of the region
     * @return a list of the positions in the region
     * @throws BadPositionCategoryException
     *         if category is undefined in this document
     * @since 3.4
     */
    private List<Position> getEndingPositions(String category, int offset, int length)
            throws BadPositionCategoryException {
        List<Position> positions = fEndPositions.get(category);
        if (positions == null)
            throw new BadPositionCategoryException();

        int indexStart = computeIndexInPositionList(positions, offset, false);
        int indexEnd = computeIndexInPositionList(positions, offset + length, false);

        return positions.subList(indexStart, indexEnd);
    }

