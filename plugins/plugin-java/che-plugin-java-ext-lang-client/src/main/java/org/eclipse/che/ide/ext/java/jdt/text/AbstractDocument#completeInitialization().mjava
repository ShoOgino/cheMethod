    /**
     * Initializes document listeners, positions, and position updaters. Must be called inside the constructor after the
     * implementation plug-ins have been set.
     */
    protected void completeInitialization() {

        fPositions = new HashMap<String, List<Position>>();
        fEndPositions = new HashMap<String, List<Position>>();
        fPositionUpdaters = new ArrayList<PositionUpdater>();
        fDocumentListeners = new ListenerList(ListenerList.IDENTITY);
        fPrenotifiedDocumentListeners = new ListenerList(ListenerList.IDENTITY);
        fDocumentPartitioningListeners = new ListenerList(ListenerList.IDENTITY);
        //      fDocumentRewriteSessionListeners = new ArrayList();

        addPositionCategory(DEFAULT_CATEGORY);
        addPositionUpdater(new DefaultPositionUpdater(DEFAULT_CATEGORY));
    }

