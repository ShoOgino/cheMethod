  UndoEdit executeDo() throws BadLocationException {
    UndoCollector collector = new UndoCollector(fRoot);
    try {
      if (createUndo()) collector.connect(fDocument);
      computeSources();
      fRoot.traverseDocumentUpdating(this, fDocument);
      if (updateRegions()) {
        fRoot.traverseRegionUpdating(this, fDocument, 0, false);
      }
    } finally {
      collector.disconnect(fDocument);
    }
    return collector.undo;
  }

