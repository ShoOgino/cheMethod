  private Promise<ChangeCreationResult> prepareRenameChanges(final RefactoringSession session) {
    RenameSettings renameSettings = createRenameSettingsDto(session);

    return refactorService
        .setRenameSettings(renameSettings)
        .thenPromise(
            new Function<Void, Promise<ChangeCreationResult>>() {
              @Override
              public Promise<ChangeCreationResult> apply(Void arg) throws FunctionException {
                return refactorService.createChange(session);
              }
            });
  }

