  @Override
  public Promise<Map<String, String>> loadPreferences() {
    return service
        .getCompileParameters()
        .then(
            new Function<Map<String, String>, Map<String, String>>() {
              @Override
              public Map<String, String> apply(Map<String, String> properties)
                  throws FunctionException {
                persistedPreferences.putAll(properties);
                return properties;
              }
            });
  }

