    /**
     * Update content of the file.
     *
     * @param file
     *         current file
     */
    private void applyChanges(VirtualFile file) {
        HandlesUndoRedo undoRedo = null;
        if (editor instanceof UndoableEditor) {
            undoRedo = ((UndoableEditor)editor).getUndoRedo();
        }
        try {
            if (undoRedo != null) {
                undoRedo.beginCompoundChange();
            }
            replaceContent(file, document);
        } catch (final Exception e) {
            Log.error(getClass(), e);
        } finally {
            if (undoRedo != null) {
                undoRedo.endCompoundChange();
            }
        }
    }

