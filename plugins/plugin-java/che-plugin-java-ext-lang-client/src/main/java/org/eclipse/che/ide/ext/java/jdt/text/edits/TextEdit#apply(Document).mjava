  /**
   * Applies the edit tree rooted by this edit to the given document. This method is a convenience
   * method for <code>apply(document, CREATE_UNDO | UPDATE_REGIONS)
   * </code>
   *
   * @param document the document to which to apply this edit
   * @return a undo edit, if <code>CREATE_UNDO</code> is specified. Otherwise <code>null</code> is
   *     returned.
   * @throws MalformedTreeException is thrown if the tree isn't in a valid state. This exception is
   *     thrown before any edit is executed. So the document is still in its original state.
   * @throws BadLocationException is thrown if one of the edits in the tree can't be executed. The
   *     state of the document is undefined if this exception is thrown.
   * @see #apply(Document, int)
   */
  public final UndoEdit apply(Document document)
      throws MalformedTreeException, BadLocationException {
    return apply(document, CREATE_UNDO | UPDATE_REGIONS);
  }

