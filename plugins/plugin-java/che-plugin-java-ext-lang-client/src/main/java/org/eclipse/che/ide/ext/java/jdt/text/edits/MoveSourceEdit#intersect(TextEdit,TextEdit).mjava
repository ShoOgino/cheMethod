  public static Region intersect(TextEdit op1, TextEdit op2) {
    int offset1 = op1.getOffset();
    int length1 = op1.getLength();
    int end1 = offset1 + length1 - 1;
    int offset2 = op2.getOffset();
    if (end1 < offset2) return null;
    int length2 = op2.getLength();
    int end2 = offset2 + length2 - 1;
    if (end2 < offset1) return null;

    int end = Math.min(end1, end2);
    if (offset1 < offset2) {
      return new RegionImpl(offset2, end - offset2 + 1);
    }
    return new RegionImpl(offset1, end - offset1 + 1);
  }

