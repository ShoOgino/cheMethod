    private Node findNextNodeToExpand(Node node) {
      Node descendant = findExpandableInTree(node);
      if (descendant != null) {
        return descendant;
      }
      NodeStorage nodes = tree.getNodeStorage();

      Node parent = nodes.getParent(node);
      if (parent == null) {
        return null;
      }
      List<Node> siblings = nodes.getChildren(parent);
      for (Node sibling : siblings) {
        if (canExpand(sibling)) {
          return sibling;
        }
      }
      return findNextNodeToExpand(parent);
    }

