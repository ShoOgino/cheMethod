  /*
   * @see org.eclipse.jface.text.IPositionUpdater#update(org.eclipse.jface.text. DocumentEvent)
   */
  public void update(DocumentEvent event) {

    try {

      fOffset = event.getOffset();
      fLength = event.getLength();
      fReplaceLength = (event.getText() == null ? 0 : event.getText().length());
      fDocument = event.getDocument();

      Position[] category = fDocument.getPositions(fCategory);
      for (int i = 0; i < category.length; i++) {

        fPosition = category[i];
        fOriginalPosition.offset = fPosition.offset;
        fOriginalPosition.length = fPosition.length;

        if (notDeleted()) adaptToReplace();
      }

    } catch (BadPositionCategoryException x) {
      // do nothing
    } finally {
      fDocument = null;
    }
  }

