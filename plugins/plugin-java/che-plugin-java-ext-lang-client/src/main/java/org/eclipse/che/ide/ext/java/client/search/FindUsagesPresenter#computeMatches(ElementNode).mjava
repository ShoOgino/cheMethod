  public Promise<List<MatchNode>> computeMatches(ElementNode elementNode) {
    Node ancestor = elementNode.getParent();
    SearchResult rootElement = elementNode.getElement();

    while ((ancestor instanceof ElementNode)
        && ((ElementNode) ancestor)
            .getElement()
            .getUri()
            .equals(elementNode.getElement().getUri())) {
      rootElement = ((ElementNode) ancestor).getElement();
      ancestor = ancestor.getParent();
    }

    return loadMatches(rootElement)
        .then(
            (Function<Map<LinearRange, SnippetResult>, List<MatchNode>>)
                matches -> {
                  return filterMatches(elementNode.getElement(), matches);
                });
  }

