    /**
     * Returns the content type at the given offset of the given document.
     *
     * @param document
     *         the document
     * @param partitioning
     *         the partitioning to be used
     * @param offset
     *         the offset
     * @param preferOpenPartitions
     *         <code>true</code> if precedence should be given to a open partition ending at
     *         <code>offset</code> over a closed partition starting at <code>offset</code>
     * @return the content type at the given offset of the document
     * @throws BadLocationException
     *         if offset is invalid in the document
     */
    public static String getContentType(Document document, String partitioning, int offset, boolean preferOpenPartitions)
            throws BadLocationException {
        try {
            return document.getContentType(partitioning, offset, preferOpenPartitions);
        } catch (BadPartitioningException x) {
            return Document.DEFAULT_CONTENT_TYPE;
        }

        //      return document.getContentType(offset);
    }

