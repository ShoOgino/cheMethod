    /**
     * Adds a listener to this list. This method has no effect if the <a href="ListenerList.html#same">same</a> listener is already
     * registered.
     *
     * @param listener
     *         the non-<code>null</code> listener to add
     */
    public synchronized void add(Object listener) {
        // This method is synchronized to protect against multiple threads adding
        // or removing listeners concurrently. This does not block concurrent readers.
        if (listener == null)
            throw new IllegalArgumentException();
        // check for duplicates
        final int oldSize = listeners.length;
        for (int i = 0; i < oldSize; ++i) {
            Object listener2 = listeners[i];
            if (identity ? listener == listener2 : listener.equals(listener2))
                return;
        }
        // Thread safety: create new array to avoid affecting concurrent readers
        Object[] newListeners = new Object[oldSize + 1];
        System.arraycopy(listeners, 0, newListeners, 0, oldSize);
        newListeners[oldSize] = listener;
        // atomic assignment
        this.listeners = newListeners;
    }

