  /**
   * Applies the edit tree rooted by this edit to the given document. To check if the edit tree can
   * be applied to the document either catch <code>
   * MalformedTreeException</code> or use <code>TextEditProcessor</code> to execute an edit tree.
   *
   * @param document the document to be manipulated
   * @param style flags controlling the execution of the edit tree. Valid flags are: <code>
   *     CREATE_UNDO</code> and </code>UPDATE_REGIONS</code>.
   * @return a undo edit, if <code>CREATE_UNDO</code> is specified. Otherwise <code>null</code> is
   *     returned.
   * @throws MalformedTreeException is thrown if the tree isn't in a valid state. This exception is
   *     thrown before any edit is executed. So the document is still in its original state.
   * @throws BadLocationException is thrown if one of the edits in the tree can't be executed. The
   *     state of the document is undefined if this exception is thrown.
   * @see TextEditProcessor#performEdits()
   */
  public final UndoEdit apply(Document document, int style)
      throws MalformedTreeException, BadLocationException {
    try {
      TextEditProcessor processor = new TextEditProcessor(document, this, style);
      return processor.performEdits();
    } finally {
      // disconnect from text edit processor
      fParent = null;
    }
  }

