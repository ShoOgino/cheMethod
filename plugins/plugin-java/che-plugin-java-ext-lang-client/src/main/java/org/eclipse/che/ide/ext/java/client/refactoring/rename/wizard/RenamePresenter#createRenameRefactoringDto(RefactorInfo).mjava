    private CreateRenameRefactoring createRenameRefactoringDto(RefactorInfo refactorInfo) {
        CreateRenameRefactoring dto = dtoFactory.createDto(CreateRenameRefactoring.class);

        dto.setRefactorLightweight(false);

        if (refactorInfo == null) {
            dto.setType(JAVA_ELEMENT);
            dto.setPath(JavaSourceFolderUtil.getFQNForFile(editorAgent.getActiveEditor().getEditorInput().getFile()));
            dto.setOffset(((TextEditor)editorAgent.getActiveEditor()).getCursorOffset());
        } else {
            Object selectedElement = refactorInfo.getSelectedItems().get(0);
            if (selectedElement instanceof JavaFileNode) {
                dto.setPath(JavaSourceFolderUtil.getFQNForFile((JavaFileNode)selectedElement));
                dto.setType(COMPILATION_UNIT);
            } else if (selectedElement instanceof PackageNode) {
                dto.setPath(((PackageNode)selectedElement).getStorablePath());
                dto.setType(PACKAGE);
            }
        }

        String projectPath = appContext.getCurrentProject().getProjectConfig().getPath();
        dto.setProjectPath(projectPath);

        return dto;
    }

