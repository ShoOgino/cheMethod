    private void createSourceFile(final String nameWithoutExtension, String packageFragment, final String content) {
        if (!isNullOrEmpty(packageFragment)) {
            parent.newFolder(packageFragment.replace('.', '/')).then(new Operation<Folder>() {
                @Override
                public void apply(Folder pkg) throws OperationException {
                    pkg.newFile(nameWithoutExtension + ".java", content).then(new Operation<File>() {
                        @Override
                        public void apply(File file) throws OperationException {
                            eventBus.fireEvent(FileEvent.createOpenFileEvent(file));
                            eventBus.fireEvent(new RevealResourceEvent(file));
                        }
                    });
                }
            });
        } else {
            parent.newFile(nameWithoutExtension + ".java", content).then(new Operation<File>() {
                @Override
                public void apply(File file) throws OperationException {
                    eventBus.fireEvent(FileEvent.createOpenFileEvent(file));
                    eventBus.fireEvent(new RevealResourceEvent(file));
                }
            });
        }
    }

