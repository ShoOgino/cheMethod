    @Override
    public void actionPerformed(ActionEvent e) {
        final Resource[] resources = appContext.getResources();
        final boolean inJavaProject = resources != null && resources.length == 1 && isJavaProject(resources[0].getRelatedProject().get());

        checkState(inJavaProject && resources[0].getParentWithMarker(SourceFolderMarker.ID).isPresent());

        final Resource resource = resources[0];

        if (resource instanceof Container) {
            newJavaSourceFilePresenter.showDialog((Container)resource);
        } else {
            final Optional<Container> parent = resource.getParent();
            if (parent.isPresent()) {
                newJavaSourceFilePresenter.showDialog(parent.get());
            } else {
                throw new IllegalStateException("Failed to get parent container");
            }
        }

    }

