  /**
   * Returns the partition of the given offset of the given document.
   *
   * @param document the document
   * @param partitioning the partitioning to be used
   * @param offset the offset
   * @param preferOpenPartitions <code>true</code> if precedence should be given to a open partition
   *     ending at <code>offset</code> over a closed partition starting at <code>offset</code>
   * @return the content type at the given offset of this viewer's input document
   * @throws BadLocationException if offset is invalid in the given document
   */
  public static TypedRegion getPartition(
      Document document, String partitioning, int offset, boolean preferOpenPartitions)
      throws BadLocationException {
    try {
      return document.getPartition(partitioning, offset, preferOpenPartitions);
    } catch (BadPartitioningException x) {
      return new TypedRegionImpl(0, document.getLength(), Document.DEFAULT_CONTENT_TYPE);
    }
    //      return document.getPartition(offset);
  }

