  /* @since 3.4 */
  private int getOffset(boolean orderedByOffset, Position position) {
    if (orderedByOffset || position.getLength() == 0) return position.getOffset();
    return position.getOffset() + position.getLength() - 1;
  }

