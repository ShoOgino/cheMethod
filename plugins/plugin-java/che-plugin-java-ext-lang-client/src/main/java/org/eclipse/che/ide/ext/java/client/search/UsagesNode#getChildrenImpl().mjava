  @Override
  protected Promise<List<Node>> getChildrenImpl() {
    try {
      Map<String, List<SearchResult>> children = new HashMap<>();
      for (SearchResult result : response.getSearchResults()) {
        Path p = toPath(result.getUri());
        if (p.isEmpty()) {
          throw new IllegalArgumentException("Path of length 0: " + result.getUri());
        }
        List<SearchResult> results = children.get(p.segment(0));
        if (results == null) {
          results = new ArrayList<>();
          children.put(p.segment(0), results);
        }
        results.add(result);
      }

      return promiseProvider.resolve(
          children
              .entrySet()
              .stream()
              .map(entry -> nodeFactory.createProject(entry.getKey(), entry.getValue()))
              .collect(Collectors.toList()));
    } catch (Exception e) {
      return promiseProvider.reject(e);
    }
  }

