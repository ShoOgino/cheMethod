  void performSourceComputation(TextEditProcessor processor, Document document) {
    try {
      MultiTextEdit root = new MultiTextEdit(getOffset(), getLength());
      root.internalSetChildren(internalGetChildren());
      fSourceContent = document.get(getOffset(), getLength());
      fSourceRoot = PartialCopier.perform(root);
      fSourceRoot.internalMoveTree(-getOffset());
      if (fSourceRoot.hasChildren()) {
        EditDocument subDocument = new EditDocument(fSourceContent);
        TextEditProcessor subProcessor =
            TextEditProcessor.createSourceComputationProcessor(
                subDocument, fSourceRoot, TextEdit.NONE);
        subProcessor.performEdits();
        if (needsTransformation()) applyTransformation(subDocument);
        fSourceContent = subDocument.get();
        fSourceRoot = null;
      } else {
        if (needsTransformation()) {
          EditDocument subDocument = new EditDocument(fSourceContent);
          applyTransformation(subDocument);
          fSourceContent = subDocument.get();
        }
      }
    } catch (BadLocationException cannotHappen) {
      // Assert.isTrue(false);
      // skip
    }
  }

