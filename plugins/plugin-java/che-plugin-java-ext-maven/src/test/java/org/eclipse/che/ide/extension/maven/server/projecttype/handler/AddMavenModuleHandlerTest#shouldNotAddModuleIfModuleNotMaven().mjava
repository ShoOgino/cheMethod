    @Test(expected = IllegalArgumentException.class)
    public void shouldNotAddModuleIfModuleNotMaven() throws Exception {
        ProjectTypeDef notMaven = Mockito.mock(ProjectTypeDef.class);
        Mockito.when(notMaven.getId()).thenReturn("notMaven");
        Mockito.when(notMaven.getDisplayName()).thenReturn("notMaven");
        Mockito.when(notMaven.isPrimaryable()).thenReturn(true);
        projectTypeRegistry.registerProjectType(notMaven);

        String parent = NameGenerator.generate("parent", 5);
        String module = NameGenerator.generate("module", 5);

        Project project = projectManager.createProject(WORKSPACE,
                                                       parent,
                                                       DtoFactory.getInstance()
                                                                 .createDto(ProjectConfigDto.class)
                                                                 .withType(MavenAttributes.MAVEN_ID), null);

        project.getBaseFolder().createFile("pom.xml", String.format(POM_XML_TEMPL, "pom").getBytes());

        addMavenModuleHandler.onCreateModule(project.getBaseFolder(),
                                             project.getPath() + "/" + module,
                                             "notMaven",
                                             Collections.<String, String>emptyMap());
    }

