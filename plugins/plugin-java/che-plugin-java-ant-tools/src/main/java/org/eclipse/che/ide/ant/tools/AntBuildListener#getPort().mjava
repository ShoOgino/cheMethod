    private int getPort() {
        final String commandLine = System.getProperty("sun.java.command");
        final String myProperty = "-D" + getClass().getName() + ".port";
        String myPort = null;
        int start = commandLine.indexOf(myProperty);
        if (start > 0) {
            start = commandLine.indexOf('=', start);
            int end = commandLine.indexOf(' ', start);
            if (end < 0) {
                end = commandLine.length();
            }
            myPort = commandLine.substring(start + 1, end);
        }
        try {
            return Integer.parseInt(myPort);
        } catch (NumberFormatException e) {
            throw new IllegalStateException("Unable connect to the builder, connection port is not set.");
        }
    }

