    @Test
    public void testGetStatusWhenTaskIsSuccessful() throws Exception {
        doReturn(true).when(taskMock).isDone();

        GenerationResult generationResult = mock(GenerationResult.class);
        doReturn(true).when(generationResult).isSuccessful();

        doReturn(generationResult).when(taskMock).getResult();
        doReturn(taskMock).when(archetypeGenerator).getTaskById(anyLong());

        GenerationTaskDescriptor task = service.getStatus(uriInfo, String.valueOf(taskId));

        Assert.assertEquals(GenerationTaskDescriptor.Status.SUCCESSFUL, task.getStatus());
        Assert.assertEquals("http://localhost:8080/generator-archetype/download/1", task.getDownloadUrl());
    }

