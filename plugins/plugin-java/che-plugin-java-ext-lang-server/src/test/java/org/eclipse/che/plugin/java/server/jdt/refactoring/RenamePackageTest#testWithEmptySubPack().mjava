    @Test
    public void testWithEmptySubPack() throws Exception {
        fRenameSubpackages = true;

        PackageRename rename = new PackageRename(new String[]{"p", "p.q"}, new String[][]{{}, {}}, "p1");
        IPackageFragment p = rename.fPackages[0];
        IPackageFragment pq = rename.fPackages[1];

        ParticipantTesting.reset();
        String[] renameHandles = ParticipantTesting.createHandles(p, pq, p.getResource());

        rename.createAndPerform(RefactoringStatus.OK);
        assertFalse(p.exists());
        assertFalse(pq.exists());
        IPackageFragment p1 = getRoot().getPackageFragment("p1");
        IPackageFragment p1q = getRoot().getPackageFragment("p1.q");
        assertTrue(p1.exists());
        assertTrue(p1q.exists());

        ParticipantTesting.testRename(renameHandles, new RenameArguments[]{
                new RenameArguments(rename.getNewPackageName(rename.fPackageNames[0]), true),
                new RenameArguments(rename.getNewPackageName(rename.fPackageNames[1]), true),
                new RenameArguments("p1", true)
        });
    }

