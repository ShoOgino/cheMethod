  private ISourceRange getSelection(ICompilationUnit cu) throws Exception {
    String source = cu.getSource();
    //Warning: this *includes* the SQUARE_BRACKET_OPEN!
    int offset = source.indexOf(SQUARE_BRACKET_OPEN);
    int end = source.indexOf(SQUARE_BRACKET_CLOSE);
    return new SourceRange(offset + SQUARE_BRACKET_OPEN.length(), end - offset);
  }

