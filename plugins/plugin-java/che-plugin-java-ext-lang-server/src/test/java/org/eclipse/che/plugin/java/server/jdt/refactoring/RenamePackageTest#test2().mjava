  @Test
  public void test2() throws Exception {
    fIsPreDeltaTest = true;
    RenamePackageProcessor processor =
        helper2(new String[] {"r", "fred"}, new String[][] {{"A"}, {"A"}}, "p1");

    // test that participants are correctly informed after '< Back': https://bugs.eclipse.org/bugs/show_bug.cgi?id=280068
    performUndo();

    ParticipantTesting.reset();
    String secondName = "pipapo";
    processor.setNewElementName(secondName);
    String[] renameHandles =
        ParticipantTesting.createHandles(
            new Object[] {processor.getPackage(), processor.getPackage().getResource()});

    RenameRefactoring refactoring = (RenameRefactoring) processor.getRefactoring();
    refactoring.checkFinalConditions(new NullProgressMonitor());
    refactoring.createChange(new NullProgressMonitor());

    ParticipantTesting.testRename(
        renameHandles,
        new RenameArguments[] {
          new RenameArguments(secondName, true), new RenameArguments(secondName, true)
        });
  }

