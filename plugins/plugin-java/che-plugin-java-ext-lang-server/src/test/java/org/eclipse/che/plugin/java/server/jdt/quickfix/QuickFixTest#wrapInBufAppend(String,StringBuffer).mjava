  private static void wrapInBufAppend(String curr, StringBuffer buf) {
    buf.append("buf.append(\"");

    int last = curr.length() - 1;
    for (int k = 0; k <= last; k++) {
      char ch = curr.charAt(k);
      if (ch == '\n') {
        buf.append("\\n\");\n");
        if (k < last) {
          buf.append("buf.append(\"");
        }
      } else if (ch == '\r') {
        // ignore
      } else if (ch == '\t') {
        buf.append("    "); // 4 spaces
      } else if (ch == '"' || ch == '\\') {
        buf.append('\\').append(ch);
      } else {
        buf.append(ch);
      }
    }
    if (buf.length() > 0 && buf.charAt(buf.length() - 1) != '\n') {
      buf.append("\\n\");\n");
    }
  }

