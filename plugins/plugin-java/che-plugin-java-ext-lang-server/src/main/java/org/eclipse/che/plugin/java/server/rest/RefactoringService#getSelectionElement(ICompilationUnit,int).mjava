  private IJavaElement getSelectionElement(ICompilationUnit compilationUnit, int offset)
      throws JavaModelException, RefactoringException {
    IJavaElement[] javaElements = compilationUnit.codeSelect(offset, 0);
    if (javaElements != null && javaElements.length > 0) {
      return javaElements[0];
    }
    throw new RefactoringException("Can't find java element to rename.");
  }

