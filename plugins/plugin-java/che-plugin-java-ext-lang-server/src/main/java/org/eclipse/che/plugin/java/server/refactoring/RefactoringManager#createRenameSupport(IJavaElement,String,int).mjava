    private static RenameSupport createRenameSupport(IJavaElement element, String newName, int flags) throws CoreException {
        switch (element.getElementType()) {
            case IJavaElement.PACKAGE_FRAGMENT:
                return RenameSupport.create((IPackageFragment)element, newName, flags);
            case IJavaElement.COMPILATION_UNIT:
                return RenameSupport.create((ICompilationUnit)element, newName, flags);
            case IJavaElement.TYPE:
                return RenameSupport.create((IType)element, newName, flags);
            case IJavaElement.METHOD:
                final IMethod method = (IMethod)element;
                if (method.isConstructor())
                    return createRenameSupport(method.getDeclaringType(), newName, flags);
                else
                    return RenameSupport.create((IMethod)element, newName, flags);
            case IJavaElement.FIELD:
                return RenameSupport.create((IField)element, newName, flags);
            case IJavaElement.TYPE_PARAMETER:
                return RenameSupport.create((ITypeParameter)element, newName, flags);
            case IJavaElement.LOCAL_VARIABLE:
                return RenameSupport.create((ILocalVariable)element, newName, flags);
        }
        return null;
    }

