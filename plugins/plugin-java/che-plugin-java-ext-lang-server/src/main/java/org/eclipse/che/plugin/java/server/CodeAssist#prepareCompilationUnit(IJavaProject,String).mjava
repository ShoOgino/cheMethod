    private ICompilationUnit prepareCompilationUnit(IJavaProject project, String fqn) throws JavaModelException {
        ICompilationUnit compilationUnit;

        IType type = project.findType(fqn);
        if (type == null) {
            throw new JavaModelException(
                    new JavaModelStatus(IJavaModelStatusConstants.CORE_EXCEPTION, "Can't find a file: " + fqn));
        }
        if (type.isBinary()) {
            throw new JavaModelException(
                    new JavaModelStatus(IJavaModelStatusConstants.CORE_EXCEPTION, "Can't organize imports on binary file"));
        } else {
            compilationUnit = type.getCompilationUnit();
        }
        return compilationUnit;
    }

