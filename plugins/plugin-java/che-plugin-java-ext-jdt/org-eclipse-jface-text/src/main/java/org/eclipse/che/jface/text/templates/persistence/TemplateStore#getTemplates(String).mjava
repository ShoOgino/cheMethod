  /**
   * Returns all enabled templates for the given context type.
   *
   * @param contextTypeId the id of the context type of the requested templates, or <code>null
   *     </code> if all templates should be returned
   * @return all enabled templates for the given context type
   */
  public Template[] getTemplates(String contextTypeId) {
    List templates = new ArrayList();
    for (Iterator it = fTemplates.iterator(); it.hasNext(); ) {
      TemplatePersistenceData data = (TemplatePersistenceData) it.next();
      if (data.isEnabled()
          && !data.isDeleted()
          && (contextTypeId == null || contextTypeId.equals(data.getTemplate().getContextTypeId())))
        templates.add(data.getTemplate());
    }

    return (Template[]) templates.toArray(new Template[templates.size()]);
  }

