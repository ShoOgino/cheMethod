  /**
   * Returns the index of the first position which starts at or after the given offset.
   *
   * @param positions the positions in linear order
   * @param offset the offset
   * @return the index of the first position which starts after the offset
   */
  private int getFirstIndexStartingAfterOffset(Position[] positions, int offset) {
    int i = -1, j = positions.length;
    while (j - i > 1) {
      int k = (i + j) >> 1;
      Position p = positions[k];
      if (p.getOffset() >= offset) j = k;
      else i = k;
    }
    return j;
  }

