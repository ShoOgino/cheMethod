  /**
   * Returns the executable extension for the given configuration element. If there is no
   * instantiated extension remembered for this element, a new extension is created and put into the
   * cache if it is of the requested type.
   *
   * @param entry the configuration element
   * @param extensions the map of instantiated extensions
   * @param extensionType the requested result type
   * @return the executable extension for the given configuration element.
   */
  private Object getExtension(IConfigurationElement entry, Map extensions, Class extensionType) {
    Object extension = extensions.get(entry);
    if (extension != null) return extension;

    try {
      extension = entry.createExecutableExtension("class"); // $NON-NLS-1$
    } catch (CoreException x) {
      log(x.getStatus());
    }

    if (extensionType.isInstance(extension)) {
      extensions.put(entry, extension);
      return extension;
    }

    return null;
  }

