  /** Copies the document prior to modification and removes the document listener. */
  private void handleDocumentAboutToBeChanged() {
    IDocument document = fDocument;
    if (fCharSequence == null || document == null) return;
    String content = document.get();
    synchronized (this) {
      if (fCharSequence == null) return;
      fCharSequence = content;
    }
    releaseDocument();
  }

