    /**
     * Creates the folders that appear in the specified resource path.
     * These folders are created relative to the destination container.
     *
     * @param path the relative path of the resource
     * @return the container resource coresponding to the given path
     * @exception CoreException if this method failed
     */
    IContainer createContainersFor(IPath path) throws CoreException {

        IContainer currentFolder = destinationContainer;

        int segmentCount = path.segmentCount();

        //No containers to create
        if (segmentCount == 0) {
            return currentFolder;
        }

        //Needs to be handles differently at the root
        if (currentFolder.getType() == IResource.ROOT) {
            return createFromRoot(path);
        }

        for (int i = 0; i < segmentCount; i++) {
            currentFolder = currentFolder.getFolder(new Path(path.segment(i)));
            if (!currentFolder.exists()) {
                if (createVirtualFolder)
                    ((IFolder)currentFolder).create(IResource.VIRTUAL, true,
                                                    null);
                else if (createLinks)
                    ((IFolder)currentFolder).createLink(createRelativePath(
                            path, currentFolder), 0, null);
                else
                    ((IFolder)currentFolder).create(false, true, null);
            }
        }

        return currentFolder;
    }

