    /**
     * Transform an absolute path URI to a relative path one (i.e. from
     * "C:\foo\bar\file.txt" to "VAR\file.txt" granted that the relativeVariable
     * is "VAR" and points to "C:\foo\bar\").
     *
     * @param location
     * @param resource
     * @return an URI that was made relative to a variable
     */
    private IPath createRelativePath(IPath location, IResource resource) {
        if (relativeVariable == null)
            return location;
        if (relativeVariable.equals(ABSOLUTE_PATH))
            return location;
        IPathVariableManager pathVariableManager = resource.getPathVariableManager();
        try {
            return URIUtil.toPath(pathVariableManager.convertToRelative(URIUtil.toURI(location), true, relativeVariable));
        } catch (CoreException e) {
            return location;
        }
    }

