	/**
	 * Releases the document.
	 *
	 * @param document
	 *            the document to release
	 * @param monitor
	 *            the progress monitor
	 * @throws CoreException if the document could not successfully be released
	 */
	private void releaseDocument(final IDocument document, final IProgressMonitor monitor) throws CoreException {
		Assert.isTrue(fCount > 0);

		if (fCount == 1)
			FileBuffers.getTextFileBufferManager().disconnect(fFile.getFullPath(), LocationKind.IFILE, monitor);

		fCount--;
	}

