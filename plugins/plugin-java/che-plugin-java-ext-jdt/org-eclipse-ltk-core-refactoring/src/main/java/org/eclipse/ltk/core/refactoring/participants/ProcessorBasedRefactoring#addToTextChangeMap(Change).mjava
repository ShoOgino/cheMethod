  private void addToTextChangeMap(Change change) {
    if (change instanceof TextChange) {
      Object element = ((TextChange) change).getModifiedElement();
      if (element != null) {
        fTextChangeMap.put(element, change);
      }
      // check if we have a subclass of TextFileChange. If so also put the change
      // under the file resource into the hash table if possible.
      if (change instanceof TextFileChange && !change.getClass().equals(TextFileChange.class)) {
        IFile file = ((TextFileChange) change).getFile();
        fTextChangeMap.put(file, change);
      }
    } else if (change instanceof CompositeChange) {
      Change[] children = ((CompositeChange) change).getChildren();
      for (int i = 0; i < children.length; i++) {
        addToTextChangeMap(children[i]);
      }
    }
  }

