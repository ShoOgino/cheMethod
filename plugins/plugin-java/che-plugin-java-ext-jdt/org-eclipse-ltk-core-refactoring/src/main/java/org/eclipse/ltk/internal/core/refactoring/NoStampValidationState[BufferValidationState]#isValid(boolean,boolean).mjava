  public RefactoringStatus isValid(boolean needsSaving, boolean resilientForDerived)
      throws CoreException {
    RefactoringStatus result = super.isValid(needsSaving, resilientForDerived);
    if (result.hasFatalError()) return result;
    // If we have initialized the content stamp with the 'null' stamp then we can't compare it with
    // the current stamp since a change executed later could have set a concrete stamp for the
    // current content
    // if (fChanged || (fContentStamp != IResource.NULL_STAMP && fContentStamp !=
    // fFile.getModificationStamp())
    if (fChanged || fContentStamp != fFile.getModificationStamp()) {
      result.addFatalError(
          Messages.format(
              RefactoringCoreMessages.TextChanges_error_content_changed,
              BasicElementLabels.getPathLabel(fFile.getFullPath(), false)));
    }
    return result;
  }

