	public void recordStateFromHistory(IResource resource,
			IProgressMonitor monitor) throws CoreException {
		monitor.beginTask(
				RefactoringCoreMessages.FolderDescription_SavingUndoInfoProgress, 100);
		if (members != null) {
			for (int i = 0; i < members.length; i++) {
				if (members[i] instanceof FileUndoState) {
					IPath path = resource.getFullPath().append(
							((FileUndoState) members[i]).name);
					IFile fileHandle = resource.getWorkspace().getRoot().getFile(
							path);
					members[i].recordStateFromHistory(fileHandle,
							new SubProgressMonitor(monitor, 100 / members.length));
				} else if (members[i] instanceof FolderUndoState) {
					IPath path = resource.getFullPath().append(
							((FolderUndoState) members[i]).name);
					IFolder folderHandle = resource.getWorkspace().getRoot()
							.getFolder(path);
					members[i].recordStateFromHistory(folderHandle,
							new SubProgressMonitor(monitor, 100 / members.length));
				}
			}
		}
		monitor.done();
	}

