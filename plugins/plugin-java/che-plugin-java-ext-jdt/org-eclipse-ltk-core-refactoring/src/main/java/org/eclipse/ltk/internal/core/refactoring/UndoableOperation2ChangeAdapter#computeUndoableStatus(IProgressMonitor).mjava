  public IStatus computeUndoableStatus(IProgressMonitor monitor) throws ExecutionException {
    if (fUndoChange == null)
      return new Status(
          IStatus.ERROR,
          RefactoringCorePlugin.getPluginId(),
          IStatus.ERROR,
          RefactoringCoreMessages.UndoableOperation2ChangeAdapter_no_undo_available,
          null);
    try {
      if (monitor == null) monitor = new NullProgressMonitor();
      RefactoringStatus status = fUndoChange.isValid(monitor);
      if (status.hasFatalError()) {
        // The operation can no longer be undo.
        fUndoChange = null;
        clearActiveChange();
        return asStatus(status);
      } else {
        // return OK in all other cases. This by passes the dialog shown
        // in the operation approver and allows refactoring to show its
        // own dialog again inside the runnable.
        return Status.OK_STATUS;
      }
    } catch (CoreException e) {
      throw new ExecutionException(e.getStatus().getMessage(), e);
    }
  }

