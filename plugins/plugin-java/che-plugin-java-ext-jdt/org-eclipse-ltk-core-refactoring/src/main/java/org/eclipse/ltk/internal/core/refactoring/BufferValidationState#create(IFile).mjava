  public static BufferValidationState create(IFile file) {
    ITextFileBuffer buffer = getBuffer(file);
    if (buffer == null) {
      return new ModificationStampValidationState(file);
    } else {
      IDocument document = buffer.getDocument();
      if (document instanceof IDocumentExtension4) {
        return new ModificationStampValidationState(file);
      } else {
        if (buffer.isDirty()) {
          return new NoStampValidationState(file);
        } else {
          return new ModificationStampValidationState(file);
        }
      }
    }
  }

