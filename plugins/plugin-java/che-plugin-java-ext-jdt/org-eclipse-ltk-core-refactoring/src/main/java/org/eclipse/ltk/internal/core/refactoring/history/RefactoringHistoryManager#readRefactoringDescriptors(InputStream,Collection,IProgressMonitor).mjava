  /**
   * Reads default refactoring descriptors from the specified input stream.
   *
   * @param stream the input stream where to read from
   * @param collection the list of descriptors read from the history
   * @param monitor the progress monitor to use
   * @throws CoreException if an error occurs while reading the descriptors
   */
  private static void readRefactoringDescriptors(
      final InputStream stream, final Collection collection, final IProgressMonitor monitor)
      throws CoreException {
    try {
      monitor.beginTask(RefactoringCoreMessages.RefactoringHistoryService_retrieving_history, 1);
      final RefactoringDescriptor[] results =
          new RefactoringSessionReader(true, null)
              .readSession(new InputSource(new BufferedInputStream(stream)))
              .getRefactorings();
      for (int index = 0; index < results.length; index++) collection.add(results[index]);
    } finally {
      monitor.done();
    }
  }

