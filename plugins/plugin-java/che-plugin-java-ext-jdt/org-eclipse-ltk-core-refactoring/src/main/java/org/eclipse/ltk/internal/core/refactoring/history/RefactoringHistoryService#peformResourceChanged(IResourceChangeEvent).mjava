  private void peformResourceChanged(final IResourceChangeEvent event) {
    final int type = event.getType();
    if ((type & IResourceChangeEvent.POST_CHANGE) != 0) {
      final IResourceDelta delta = event.getDelta();
      if (delta != null) {
        final IResourceDelta[] deltas = delta.getAffectedChildren();
        if (deltas.length == 2) {
          final IPath toPath = deltas[0].getMovedToPath();
          final IPath fromPath = deltas[1].getMovedFromPath();
          if (fromPath != null && toPath != null) {
            final IResource oldResource = deltas[0].getResource();
            final IResource newResource = deltas[1].getResource();
            if (oldResource.getType() == IResource.PROJECT
                && newResource.getType() == IResource.PROJECT)
              moveHistory(
                  (IProject) oldResource, (IProject) newResource, new NullProgressMonitor());
          } else {
            if (deltas[0].getKind() == IResourceDelta.ADDED
                && deltas[1].getKind() == IResourceDelta.REMOVED) {
              final IResource newResource = deltas[0].getResource();
              final IResource oldResource = deltas[1].getResource();
              if (oldResource.getType() == IResource.PROJECT
                  && newResource.getType() == IResource.PROJECT)
                moveHistory(
                    (IProject) oldResource, (IProject) newResource, new NullProgressMonitor());
            }
          }
        }
      }
    }
  }

