    /*
 * Helper method to convert this node to a Properties file suitable
 * for persistence.
 */
    protected Properties convertToProperties(Properties result, String prefix) throws BackingStoreException {
        // add the key/value pairs from this node
        boolean addSeparator = prefix.length() != 0;
        //thread safety: copy reference in case of concurrent change
        ImmutableMap temp;
        synchronized (childAndPropertyLock) {
            temp = properties;
        }
        String[] keys = temp.keys();
        for (int i = 0, imax = keys.length; i < imax; i++) {
            String value = temp.get(keys[i]);
            if (value != null)
                result.put(encodePath(prefix, keys[i]), value);
        }
//        // recursively add the child information
//        IEclipsePreferences[] childNodes = getChildren(true);
//        for (int i = 0; i < childNodes.length; i++) {
//            ChePreferences child = (ChePreferences) childNodes[i];
//            String fullPath = addSeparator ? prefix + PATH_SEPARATOR + child.name() : child.name();
//            child.convertToProperties(result, fullPath);
//        }
        return result;
    }

