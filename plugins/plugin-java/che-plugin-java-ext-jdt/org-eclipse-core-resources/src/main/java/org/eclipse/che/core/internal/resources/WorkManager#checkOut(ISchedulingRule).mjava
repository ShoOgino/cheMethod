  /** Inform that an operation has finished. */
  public synchronized void checkOut(ISchedulingRule rule) {
    decrementPreparedOperations();
    rebalanceNestedOperations();
    // reset state if this is the end of a top level operation
    if (preparedOperations == 0) hasBuildChanges = false;
    // don't let cancelation of this operation affect other operations
    operationCanceled = false;
    try {
      lock.release();
    } finally {
      // end rule in finally in case lock.release throws an exception
      jobManager.endRule(rule);
    }
  }

