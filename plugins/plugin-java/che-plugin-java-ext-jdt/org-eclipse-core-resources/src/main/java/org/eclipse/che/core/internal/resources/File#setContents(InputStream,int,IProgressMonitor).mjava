    @Override
    public void setContents(InputStream content, int updateFlags, IProgressMonitor monitor) throws CoreException {
        monitor = Policy.monitorFor(monitor);
        try {
            String message = NLS.bind(Messages.resources_settingContents, getFullPath());
            monitor.beginTask(message, Policy.totalWork);
//            if (workspace.shouldValidate)
//                workspace.validateSave(this);
            final ISchedulingRule rule = workspace.getRuleFactory().modifyRule(this);
            try {
                workspace.prepareOperation(rule, monitor);
                ResourceInfo info = getResourceInfo(false, false);
//                checkAccessible(getFlags(info));
                workspace.beginOperation(true);
//                IFileInfo fileInfo = getStore().fetchInfo();
                internalSetContents(content, updateFlags, false, Policy.subMonitorFor(monitor, Policy.opWork));
            } catch (OperationCanceledException e) {
                workspace.getWorkManager().operationCanceled();
                throw e;
            } finally {
                workspace.endOperation(rule, true, Policy.subMonitorFor(monitor, Policy.endOpWork));
            }
        } finally {
            monitor.done();
            FileUtil.safeClose(content);
        }
    }

