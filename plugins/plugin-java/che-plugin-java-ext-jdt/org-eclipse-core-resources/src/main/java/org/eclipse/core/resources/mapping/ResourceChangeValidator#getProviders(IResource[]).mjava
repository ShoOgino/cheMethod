  private ModelProvider[] getProviders(IResource[] resources) {
    IModelProviderDescriptor[] descriptors = ModelProvider.getModelProviderDescriptors();
    List<ModelProvider> result = new ArrayList<ModelProvider>();
    for (int i = 0; i < descriptors.length; i++) {
      IModelProviderDescriptor descriptor = descriptors[i];
      try {
        IResource[] matchingResources = descriptor.getMatchingResources(resources);
        if (matchingResources.length > 0) {
          result.add(descriptor.getModelProvider());
        }
      } catch (CoreException e) {
        Policy.log(
            e.getStatus().getSeverity(),
            NLS.bind("Could not instantiate provider {0}", descriptor.getId()),
            e); // $NON-NLS-1$
      }
    }
    return result.toArray(new ModelProvider[result.size()]);
  }

