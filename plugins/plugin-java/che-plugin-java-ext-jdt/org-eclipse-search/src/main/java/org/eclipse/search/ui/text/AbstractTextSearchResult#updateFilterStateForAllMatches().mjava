  private void updateFilterStateForAllMatches() {
    boolean disableFiltering = getActiveMatchFilters() == null;
    ArrayList changed = new ArrayList();
    Object[] elements = getElements();
    for (int i = 0; i < elements.length; i++) {
      Match[] matches = getMatches(elements[i]);
      for (int k = 0; k < matches.length; k++) {
        if (disableFiltering || updateFilterState(matches[k])) {
          changed.add(matches[k]);
        }
      }
    }
    Match[] allChanges = (Match[]) changed.toArray(new Match[changed.size()]);
    fireChange(new FilterUpdateEvent(this, allChanges, getActiveMatchFilters()));
  }

