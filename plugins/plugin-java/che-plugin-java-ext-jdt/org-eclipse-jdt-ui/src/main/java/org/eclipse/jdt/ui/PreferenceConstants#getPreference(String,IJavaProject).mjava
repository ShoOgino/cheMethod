  /**
   * Returns the value for the given key in the given context.
   *
   * @param key The preference key
   * @param project The current context or <code>null</code> if no context is available and the
   *     workspace setting should be taken. Note that passing <code>null</code> should be avoided.
   * @return Returns the current value for the string.
   * @since 3.1
   */
  public static String getPreference(String key, IJavaProject project) {
    String val;
    if (project != null) {
      val = new ProjectScope(project.getProject()).getNode(ID_PLUGIN).get(key, null);
      if (val != null && !val.isEmpty()) {
        return val;
      }
    }
    val = InstanceScope.INSTANCE.getNode(ID_PLUGIN).get(key, null);
    if (val != null) {
      return val;
    }
    return getPreferenceStore().getString(key);
  }

