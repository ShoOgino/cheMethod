    private Match[] computeContainedMatches(IAdaptable adaptable) {
        IJavaElement javaElement = (IJavaElement)adaptable.getAdapter(IJavaElement.class);
        Set<Match> matches = new HashSet<Match>();
        if (javaElement != null) {
            collectMatches(matches, javaElement);
        }
        IFile file = (IFile)adaptable.getAdapter(IFile.class);
        if (file != null) {
            collectMatches(matches, file);
        }
        if (!matches.isEmpty()) {
            return matches.toArray(new Match[matches.size()]);
        }
        return NO_MATCHES;
    }

