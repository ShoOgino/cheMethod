  public static IMethod isDeclaredInInterface(
      IMethod method, ITypeHierarchy hierarchy, IProgressMonitor monitor)
      throws JavaModelException {
    Assert.isTrue(isVirtual(method));
    IProgressMonitor subMonitor = new SubProgressMonitor(monitor, 1);
    try {
      IType[] classes = hierarchy.getAllClasses();
      subMonitor.beginTask("", classes.length); // $NON-NLS-1$
      for (int i = 0; i < classes.length; i++) {
        final IType clazz = classes[i];
        IType[] superinterfaces = null;
        if (clazz.equals(hierarchy.getType()))
          superinterfaces = hierarchy.getAllSuperInterfaces(clazz);
        else
          superinterfaces =
              clazz
                  .newSupertypeHierarchy(new SubProgressMonitor(subMonitor, 1))
                  .getAllSuperInterfaces(clazz);
        for (int j = 0; j < superinterfaces.length; j++) {
          IMethod found = Checks.findSimilarMethod(method, superinterfaces[j]);
          if (found != null && !found.equals(method)) return found;
        }
        subMonitor.worked(1);
      }
      return null;
    } finally {
      subMonitor.done();
    }
  }

