  /**
   * @param searchHits
   * @return the set of compilation units that will be affected by this particular invocation of
   *     this refactoring. This in general includes the class containing the constructor in
   *     question, as well as all call sites to the constructor.
   */
  private ICompilationUnit[] collectAffectedUnits(SearchResultGroup[] searchHits) {
    Collection<ICompilationUnit> result = new ArrayList<ICompilationUnit>();
    boolean hitInFactoryClass = false;

    for (int i = 0; i < searchHits.length; i++) {
      SearchResultGroup rg = searchHits[i];
      ICompilationUnit icu = rg.getCompilationUnit();

      result.add(icu);
      if (icu.equals(fFactoryUnitHandle)) hitInFactoryClass = true;
    }
    if (!hitInFactoryClass) result.add(fFactoryUnitHandle);
    return result.toArray(new ICompilationUnit[result.size()]);
  }

