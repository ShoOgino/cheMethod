    @Override
    public boolean match(SimpleName candidate, Object s) {
      if (!(s instanceof SimpleName)) return false;

      SimpleName snippet = (SimpleName) s;
      if (candidate.isDeclaration() != snippet.isDeclaration()) return false;

      IBinding cb = candidate.resolveBinding();
      IBinding sb = snippet.resolveBinding();
      if (cb == null || sb == null) return false;
      IVariableBinding vcb = ASTNodes.getVariableBinding(candidate);
      IVariableBinding vsb = ASTNodes.getVariableBinding(snippet);
      if (vcb == null || vsb == null) return Bindings.equals(cb, sb);
      if (!vcb.isField() && !vsb.isField() && Bindings.equals(vcb.getType(), vsb.getType())) {
        SimpleName mapped = fMatch.getMappedName(vsb);
        if (mapped != null) {
          IVariableBinding mappedBinding = ASTNodes.getVariableBinding(mapped);
          if (!Bindings.equals(vcb, mappedBinding)) return false;
        }
        fMatch.addLocal(vsb, candidate);
        return true;
      }
      return Bindings.equals(cb, sb);
    }

