    private void addJavaElements(Set<IJavaElement> javaElements, IResource resource) {
        IJavaElement javaElement = (IJavaElement)resource.getAdapter(IJavaElement.class);
        if (javaElement == null)
            // not a Java resource
            return;

        if (javaElement.getElementType() == IJavaElement.PACKAGE_FRAGMENT) {
            // add other possible package fragments
            try {
                addJavaElements(javaElements, ((IFolder)resource).members());
            } catch (CoreException ex) {
                // don't add elements
            }
        }

        javaElements.add(javaElement);
    }

