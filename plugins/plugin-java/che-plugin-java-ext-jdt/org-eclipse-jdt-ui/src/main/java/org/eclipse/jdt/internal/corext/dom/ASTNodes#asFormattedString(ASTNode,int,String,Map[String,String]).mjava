  public static String asFormattedString(
      ASTNode node, int indent, String lineDelim, Map<String, String> options) {
    String unformatted = asString(node);
    TextEdit edit = CodeFormatterUtil.format2(node, unformatted, indent, lineDelim, options);
    if (edit != null) {
      Document document = new Document(unformatted);
      try {
        edit.apply(document, TextEdit.NONE);
      } catch (BadLocationException e) {
        JavaPlugin.log(e);
      }
      return document.get();
    }
    return unformatted; // unknown node
  }

