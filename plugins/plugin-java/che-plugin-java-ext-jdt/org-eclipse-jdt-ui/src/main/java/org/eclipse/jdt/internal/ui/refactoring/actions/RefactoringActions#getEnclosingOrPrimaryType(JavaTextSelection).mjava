  /**
   * Converts the given selection into a type using the following rules:
   *
   * <ul>
   *   <li>if the selection is enclosed by a type than that type is returned.
   *   <li>if the selection is inside a compilation unit or class file than the primary type is
   *       returned.
   *   <li>otherwise <code>null</code> is returned.
   * </ul>
   */
  public static IType getEnclosingOrPrimaryType(JavaTextSelection selection)
      throws JavaModelException {
    final IJavaElement element = selection.resolveEnclosingElement();
    if (element != null) return convertToEnclosingOrPrimaryType(element);
    return null;
  }
  //	public static IType getEnclosingOrPrimaryType(JavaEditor editor) throws JavaModelException {
  //		return convertToEnclosingOrPrimaryType(SelectionConverter.resolveEnclosingElement(
  //				editor, (ITextSelection)editor.getSelectionProvider().getSelection()));
  //	}

