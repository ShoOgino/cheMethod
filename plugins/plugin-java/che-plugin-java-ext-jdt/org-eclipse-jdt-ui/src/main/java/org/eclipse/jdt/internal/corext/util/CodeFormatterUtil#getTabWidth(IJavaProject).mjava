  /**
   * Gets the current tab width.
   *
   * @param project The project where the source is used, used for project specific options or
   *     <code>null</code> if the project is unknown and the workspace default should be used
   * @return The tab width
   */
  public static int getTabWidth(IJavaProject project) {
    /*
     * If the tab-char is SPACE, FORMATTER_INDENTATION_SIZE is not used
     * by the core formatter.
     * We piggy back the visual tab length setting in that preference in
     * that case.
     */
    String key;
    if (JavaCore.SPACE.equals(
        getCoreOption(project, DefaultCodeFormatterConstants.FORMATTER_TAB_CHAR)))
      key = DefaultCodeFormatterConstants.FORMATTER_INDENTATION_SIZE;
    else key = DefaultCodeFormatterConstants.FORMATTER_TAB_SIZE;

    return getCoreOption(project, key, 4);
  }

