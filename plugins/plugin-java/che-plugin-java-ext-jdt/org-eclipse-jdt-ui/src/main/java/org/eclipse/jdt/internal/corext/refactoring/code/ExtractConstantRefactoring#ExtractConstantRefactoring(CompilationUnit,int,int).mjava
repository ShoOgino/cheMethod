  public ExtractConstantRefactoring(
      CompilationUnit astRoot, int selectionStart, int selectionLength) {
    Assert.isTrue(selectionStart >= 0);
    Assert.isTrue(selectionLength >= 0);
    Assert.isTrue(astRoot.getTypeRoot() instanceof ICompilationUnit);

    fSelectionStart = selectionStart;
    fSelectionLength = selectionLength;
    fCu = (ICompilationUnit) astRoot.getTypeRoot();
    fCuRewrite = new CompilationUnitRewrite(fCu, astRoot);
    fLinkedProposalModel = null;
    fConstantName = ""; //$NON-NLS-1$
    fCheckResultForCompileProblems = true;
  }

