  private static TemplateContextType createContextType(IConfigurationElement element)
      throws CoreException {
    String id = element.getAttribute(ID);
    try {
      TemplateContextType contextType =
          (TemplateContextType) element.createExecutableExtension(CLASS);
      String name = element.getAttribute(NAME);
      if (name == null) name = id;

      if (contextType.getId() == null) contextType.setId(id);
      if (contextType.getName() == null) contextType.setName(name);

      return contextType;
    } catch (ClassCastException e) {
      throw new CoreException(
          new Status(
              IStatus.ERROR,
              "org.eclipse.ui.editors",
              IStatus.OK,
              "extension does not implement " + TemplateContextType.class.getName(),
              e)); // $NON-NLS-1$
    }
  }

