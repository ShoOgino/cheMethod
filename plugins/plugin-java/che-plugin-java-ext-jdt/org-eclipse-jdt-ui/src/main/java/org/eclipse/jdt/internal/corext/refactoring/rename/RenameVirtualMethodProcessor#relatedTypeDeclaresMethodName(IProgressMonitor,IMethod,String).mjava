  private IMethod[] relatedTypeDeclaresMethodName(
      IProgressMonitor pm, IMethod method, String newName) throws CoreException {
    try {
      Set<IMethod> result = new HashSet<IMethod>();
      Set<IType> types = getRelatedTypes();
      pm.beginTask("", types.size()); // $NON-NLS-1$
      for (Iterator<IType> iter = types.iterator(); iter.hasNext(); ) {
        final IMethod found = Checks.findMethod(method, iter.next());
        final IType declaring = found.getDeclaringType();
        result.addAll(
            Arrays.asList(
                hierarchyDeclaresMethodName(
                    new SubProgressMonitor(pm, 1),
                    declaring.newTypeHierarchy(new SubProgressMonitor(pm, 1)),
                    found,
                    newName)));
      }
      return result.toArray(new IMethod[result.size()]);
    } finally {
      pm.done();
    }
  }

