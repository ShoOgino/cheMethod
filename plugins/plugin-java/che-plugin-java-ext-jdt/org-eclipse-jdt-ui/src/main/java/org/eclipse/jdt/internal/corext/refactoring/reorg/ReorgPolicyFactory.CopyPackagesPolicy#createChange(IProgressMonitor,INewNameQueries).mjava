    public Change createChange(IProgressMonitor pm, INewNameQueries newNameQueries)
        throws JavaModelException {
      NewNameProposer nameProposer = new NewNameProposer();
      IPackageFragment[] fragments = getPackages();
      pm.beginTask("", fragments.length); //$NON-NLS-1$
      CompositeChange composite =
          new DynamicValidationStateChange(RefactoringCoreMessages.ReorgPolicy_copy_package);
      composite.markAsSynthetic();
      IPackageFragmentRoot root = getDestinationAsPackageFragmentRoot();
      for (int i = 0; i < fragments.length; i++) {
        if (root == null) {
          composite.add(
              createChange(
                  fragments[i],
                  (IContainer) getResourceDestination(),
                  nameProposer,
                  newNameQueries));
        } else {
          composite.add(createChange(fragments[i], root, nameProposer, newNameQueries));
        }
        pm.worked(1);
      }
      pm.done();
      return composite;
    }

