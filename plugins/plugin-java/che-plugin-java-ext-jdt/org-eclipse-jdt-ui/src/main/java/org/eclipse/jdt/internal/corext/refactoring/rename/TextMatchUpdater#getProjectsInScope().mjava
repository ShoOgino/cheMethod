  private IProject[] getProjectsInScope() {
    IPath[] enclosingProjects = fScope.enclosingProjectsAndJars();
    Set<IPath> enclosingProjectSet = new HashSet<IPath>();
    enclosingProjectSet.addAll(Arrays.asList(enclosingProjects));

    ArrayList<IProject> projectsInScope = new ArrayList<IProject>();
    IProject[] projects = ResourcesPlugin.getWorkspace().getRoot().getProjects();
    for (int i = 0; i < projects.length; i++) {
      if (enclosingProjectSet.contains(projects[i].getFullPath())) projectsInScope.add(projects[i]);
    }

    return projectsInScope.toArray(new IProject[projectsInScope.size()]);
  }

