  private void addNestedClass(CompilationUnitRewrite rewrite, ITypeBinding[] typeParameters)
      throws CoreException {
    final AbstractTypeDeclaration declarations =
        (AbstractTypeDeclaration)
            ASTNodes.getParent(fAnonymousInnerClassNode, AbstractTypeDeclaration.class);
    int index = findIndexOfFistNestedClass(declarations.bodyDeclarations());
    if (index == -1) index = 0;
    rewrite
        .getASTRewrite()
        .getListRewrite(declarations, declarations.getBodyDeclarationsProperty())
        .insertAt(createNewNestedClass(rewrite, typeParameters), index, null);
  }

