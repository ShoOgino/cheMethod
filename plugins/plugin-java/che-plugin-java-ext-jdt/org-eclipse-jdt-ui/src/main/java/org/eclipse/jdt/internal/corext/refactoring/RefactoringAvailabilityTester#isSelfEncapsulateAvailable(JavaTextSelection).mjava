  public static boolean isSelfEncapsulateAvailable(final JavaTextSelection selection)
      throws JavaModelException {
    final IJavaElement[] elements = selection.resolveElementAtOffset();
    if (elements.length != 1) return false;
    return (elements[0] instanceof IField) && isSelfEncapsulateAvailable((IField) elements[0]);
  }

