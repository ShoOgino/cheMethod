  /* (non-Javadoc)
   * Method declared in ASTVisitor
   */
  @Override
  public void endVisit(CompilationUnit node) {
    if (!hasSelectedNodes()) {
      super.endVisit(node);
      return;
    }
    ASTNode selectedNode = getFirstSelectedNode();
    Selection selection = getSelection();
    if (node != selectedNode) {
      ASTNode parent = selectedNode.getParent();
      fStatus.merge(
          CommentAnalyzer.perform(
              selection, fScanner.getScanner(), parent.getStartPosition(), parent.getLength()));
    }
    if (!fStatus.hasFatalError()) checkSelectedNodes();
    super.endVisit(node);
  }

