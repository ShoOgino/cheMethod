  public static void insert(TextEdit parent, TextEdit edit) throws MalformedTreeException {
    if (!parent.hasChildren()) {
      parent.addChild(edit);
      return;
    }
    TextEdit[] children = parent.getChildren();
    // First dive down to find the right parent.
    for (int i = 0; i < children.length; i++) {
      TextEdit child = children[i];
      if (covers(child, edit)) {
        insert(child, edit);
        return;
      }
    }
    // We have the right parent. Now check if some of the children have to
    // be moved under the new edit since it is covering it.
    int removed = 0;
    for (int i = 0; i < children.length; i++) {
      TextEdit child = children[i];
      if (covers(edit, child)) {
        parent.removeChild(i - removed++);
        edit.addChild(child);
      }
    }
    parent.addChild(edit);
  }

