  public static int getIndentUsed(IBuffer buffer, int offset, IJavaProject project) {
    int i = offset;
    // find beginning of line
    while (i > 0 && !IndentManipulation.isLineDelimiterChar(buffer.getChar(i - 1))) {
      i--;
    }
    return Strings.computeIndentUnits(buffer.getText(i, offset - i), project);
  }

