  private static int getLeftMostLine(IDocument document, ILineRange lines, int tabSize)
      throws BadLocationException {
    int numberOfLines = lines.getNumberOfLines();
    int first = lines.getStartLine();
    int minLine = -1;
    int minIndent = Integer.MAX_VALUE;
    for (int line = 0; line < numberOfLines; line++) {
      int length = computeVisualLength(getCurrentIndent(document, line + first), tabSize);
      if (length < minIndent) {
        minIndent = length;
        minLine = line;
      }
    }
    return minLine;
  }

