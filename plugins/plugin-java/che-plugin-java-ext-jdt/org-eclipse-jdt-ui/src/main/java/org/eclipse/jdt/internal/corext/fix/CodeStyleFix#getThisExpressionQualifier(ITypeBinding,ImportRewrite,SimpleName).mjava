	private static String getThisExpressionQualifier(ITypeBinding declaringClass, ImportRewrite imports, SimpleName name) {
		ITypeBinding parentType = Bindings.getBindingOfParentType(name);
		ITypeBinding currType = parentType;
		while (currType != null && !Bindings.isSuperType(declaringClass, currType)) {
			currType = currType.getDeclaringClass();
		}
		if (currType == null) {
			declaringClass = declaringClass.getTypeDeclaration();
			currType = parentType;
			while (currType != null && !Bindings.isSuperType(declaringClass, currType)) {
				currType = currType.getDeclaringClass();
			}
		}
		if (currType != parentType) {
			if (currType == null)
				return null;

			if (currType.isAnonymous())
				//If we access a field of a super class of an anonymous class
				//then we can only qualify with 'this' but not with outer.this
				//see bug 115277
				return null;

			return imports.addImport(currType);
		} else {
			return ""; //$NON-NLS-1$
		}
	}

