  public static ITypeBinding[] perform(BodyDeclaration enclosingNode, Selection selection) {
    ExceptionAnalyzer analyzer = new ExceptionAnalyzer(selection);
    enclosingNode.accept(analyzer);
    List<ITypeBinding> exceptions = analyzer.getCurrentExceptions();
    if (enclosingNode.getNodeType() == ASTNode.METHOD_DECLARATION) {
      List<Type> thrownExceptions = ((MethodDeclaration) enclosingNode).thrownExceptionTypes();
      for (Iterator<Type> thrown = thrownExceptions.iterator(); thrown.hasNext(); ) {
        ITypeBinding thrownException = thrown.next().resolveBinding();
        if (thrownException != null) {
          for (Iterator<ITypeBinding> excep = exceptions.iterator(); excep.hasNext(); ) {
            ITypeBinding exception = excep.next();
            if (exception.isAssignmentCompatible(thrownException)) excep.remove();
          }
        }
      }
    }
    Collections.sort(exceptions, new ExceptionComparator());
    return exceptions.toArray(new ITypeBinding[exceptions.size()]);
  }

