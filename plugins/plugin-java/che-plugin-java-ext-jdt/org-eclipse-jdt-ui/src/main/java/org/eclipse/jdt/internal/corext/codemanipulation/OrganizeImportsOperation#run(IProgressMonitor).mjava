  /**
   * Runs the operation.
   *
   * @param monitor the progress monitor
   * @throws CoreException thrown when the operation failed
   * @throws OperationCanceledException Runtime error thrown when operation is canceled.
   */
  public void run(IProgressMonitor monitor) throws CoreException, OperationCanceledException {
    if (monitor == null) {
      monitor = new NullProgressMonitor();
    }
    try {
      monitor.beginTask(
          Messages.format(
              CodeGenerationMessages.OrganizeImportsOperation_description,
              BasicElementLabels.getFileName(fCompilationUnit)),
          10);

      edit = createTextEdit(new SubProgressMonitor(monitor, 9));
      if (edit == null) return;

      JavaModelUtil.applyEdit(fCompilationUnit, edit, fDoSave, new SubProgressMonitor(monitor, 1));
    } finally {
      monitor.done();
    }
  }

