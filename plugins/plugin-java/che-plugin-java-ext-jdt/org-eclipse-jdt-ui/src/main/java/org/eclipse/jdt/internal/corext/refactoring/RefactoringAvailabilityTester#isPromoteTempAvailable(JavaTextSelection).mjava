  public static boolean isPromoteTempAvailable(final JavaTextSelection selection)
      throws JavaModelException {
    final IJavaElement[] elements = selection.resolveElementAtOffset();
    if (elements.length != 1) return false;
    return (elements[0] instanceof ILocalVariable)
        && isPromoteTempAvailable((ILocalVariable) elements[0]);
  }

