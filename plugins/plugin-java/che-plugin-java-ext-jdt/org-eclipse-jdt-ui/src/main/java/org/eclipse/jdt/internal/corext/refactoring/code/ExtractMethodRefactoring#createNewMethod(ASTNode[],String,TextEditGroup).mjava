  private MethodDeclaration createNewMethod(
      ASTNode[] selectedNodes, String lineDelimiter, TextEditGroup substitute)
      throws CoreException {
    MethodDeclaration result = createNewMethodDeclaration();
    result.setBody(createMethodBody(selectedNodes, substitute, result.getModifiers()));
    if (fGenerateJavadoc) {
      AbstractTypeDeclaration enclosingType =
          (AbstractTypeDeclaration)
              ASTNodes.getParent(
                  fAnalyzer.getEnclosingBodyDeclaration(), AbstractTypeDeclaration.class);
      String string =
          CodeGeneration.getMethodComment(
              fCUnit, enclosingType.getName().getIdentifier(), result, null, lineDelimiter);
      if (string != null) {
        Javadoc javadoc = (Javadoc) fRewriter.createStringPlaceholder(string, ASTNode.JAVADOC);
        result.setJavadoc(javadoc);
      }
    }
    return result;
  }

