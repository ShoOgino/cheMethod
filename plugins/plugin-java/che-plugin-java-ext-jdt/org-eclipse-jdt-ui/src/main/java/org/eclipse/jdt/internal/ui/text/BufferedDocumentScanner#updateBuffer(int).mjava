  /**
   * Fills the buffer with the contents of the document starting at the given offset.
   *
   * @param offset the document offset at which the buffer starts
   */
  private final void updateBuffer(int offset) {

    fBufferOffset = offset;

    if (fBufferOffset + fBuffer.length > fRangeOffset + fRangeLength)
      fBufferLength = fRangeLength - (fBufferOffset - fRangeOffset);
    else fBufferLength = fBuffer.length;

    try {
      final String content = fDocument.get(fBufferOffset, fBufferLength);
      content.getChars(0, fBufferLength, fBuffer, 0);
    } catch (BadLocationException e) {
    }
  }

