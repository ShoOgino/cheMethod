  /**
   * Sets the granularity to use during the searches.
   *
   * <p>This method must be called before start searching. The default is a granularity of {@link
   * #GRANULARITY_SEARCH_MATCH}.
   *
   * @param granularity The granularity to use. Must be one of the <code>GRANULARITY_XXX</code>
   *     constants.
   */
  public final void setGranularity(final int granularity) {
    Assert.isTrue(
        granularity == GRANULARITY_COMPILATION_UNIT || granularity == GRANULARITY_SEARCH_MATCH);
    fGranularity = granularity;
  }

