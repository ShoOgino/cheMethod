  protected IResource[] collectResourcesOfInterest(IPackageFragment source) throws CoreException {
    IJavaElement[] children = source.getChildren();
    int childOfInterest = IJavaElement.COMPILATION_UNIT;
    if (source.getKind() == IPackageFragmentRoot.K_BINARY) {
      childOfInterest = IJavaElement.CLASS_FILE;
    }
    ArrayList<IResource> result = new ArrayList<IResource>(children.length);
    for (int i = 0; i < children.length; i++) {
      IJavaElement child = children[i];
      if (child.getElementType() == childOfInterest && child.getResource() != null) {
        result.add(child.getResource());
      }
    }
    // Gather non-java resources
    Object[] nonJavaResources = source.getNonJavaResources();
    for (int i = 0; i < nonJavaResources.length; i++) {
      Object element = nonJavaResources[i];
      if (element instanceof IResource) {
        result.add((IResource) element);
      }
    }
    return result.toArray(new IResource[result.size()]);
  }

