  /**
   * Creates a new extract constant refactoring
   *
   * @param unit the compilation unit, or <code>null</code> if invoked by scripting
   * @param selectionStart start
   * @param selectionLength length
   */
  public ExtractConstantRefactoring(
      ICompilationUnit unit, int selectionStart, int selectionLength) {
    Assert.isTrue(selectionStart >= 0);
    Assert.isTrue(selectionLength >= 0);
    fSelectionStart = selectionStart;
    fSelectionLength = selectionLength;
    fCu = unit;
    fCuRewrite = null;
    fLinkedProposalModel = null;
    fConstantName = ""; // $NON-NLS-1$
    fCheckResultForCompileProblems = true;
  }

