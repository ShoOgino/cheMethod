  private static SearchResultGroup[] getReferences(
      ICompilationUnit unit, IProgressMonitor pm, RefactoringStatus status) throws CoreException {
    final SearchPattern pattern =
        RefactoringSearchEngine.createOrPattern(unit.getTypes(), IJavaSearchConstants.REFERENCES);
    if (pattern != null) {
      String binaryRefsDescription =
          Messages.format(
              RefactoringCoreMessages.ReferencesInBinaryContext_ref_in_binaries_description,
              BasicElementLabels.getFileName(unit));
      ReferencesInBinaryContext binaryRefs = new ReferencesInBinaryContext(binaryRefsDescription);
      Collector requestor = new Collector(((IPackageFragment) unit.getParent()), binaryRefs);
      IJavaSearchScope scope = RefactoringScopeFactory.create(unit, true, false);

      SearchResultGroup[] result =
          RefactoringSearchEngine.search(
              pattern, scope, requestor, new SubProgressMonitor(pm, 1), status);
      binaryRefs.addErrorIfNecessary(status);
      return result;
    }
    return new SearchResultGroup[] {};
  }

