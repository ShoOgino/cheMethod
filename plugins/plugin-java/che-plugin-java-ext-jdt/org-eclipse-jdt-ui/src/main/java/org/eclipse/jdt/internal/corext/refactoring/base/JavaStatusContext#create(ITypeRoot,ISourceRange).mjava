  /**
   * Creates an status entry context for the given type root and source range.
   *
   * @param typeRoot the type root containing the error
   * @param range the source range that has caused the error or <code>null</code> if the source
   *     range is unknown
   * @return the status entry context or <code>null</code> if the context cannot be created
   */
  public static RefactoringStatusContext create(ITypeRoot typeRoot, ISourceRange range) {
    if (typeRoot instanceof ICompilationUnit)
      return new CompilationUnitSourceContext((ICompilationUnit) typeRoot, range);
    else if (typeRoot instanceof IClassFile)
      return new ClassFileSourceContext((IClassFile) typeRoot, range);
    else return null;
  }

