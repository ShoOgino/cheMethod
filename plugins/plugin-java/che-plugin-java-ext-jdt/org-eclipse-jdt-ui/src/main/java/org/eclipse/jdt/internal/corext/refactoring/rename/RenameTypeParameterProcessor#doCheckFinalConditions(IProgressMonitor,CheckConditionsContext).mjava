  @Override
  protected RefactoringStatus doCheckFinalConditions(
      IProgressMonitor monitor, CheckConditionsContext context)
      throws CoreException, OperationCanceledException {
    Assert.isNotNull(monitor);
    Assert.isNotNull(context);
    RefactoringStatus status = new RefactoringStatus();
    try {
      monitor.beginTask("", 5); //$NON-NLS-1$
      monitor.setTaskName(RefactoringCoreMessages.RenameTypeParameterRefactoring_checking);
      status.merge(Checks.checkIfCuBroken(fTypeParameter.getDeclaringMember()));
      monitor.worked(1);
      if (!status.hasFatalError()) {
        status.merge(checkNewElementName(getNewElementName()));
        monitor.worked(1);
        monitor.setTaskName(RefactoringCoreMessages.RenameTypeParameterRefactoring_searching);
        status.merge(createRenameChanges(new SubProgressMonitor(monitor, 2)));
        monitor.setTaskName(RefactoringCoreMessages.RenameTypeParameterRefactoring_checking);
        if (status.hasFatalError()) return status;
        monitor.worked(1);
      }
    } finally {
      monitor.done();
    }
    return status;
  }

