	@Override
	public void endVisit(CompilationUnit node) {
		BodyDeclaration enclosingNode = null;
		if (!getStatus().hasFatalError() && hasSelectedNodes())
			enclosingNode = (BodyDeclaration)ASTNodes.getParent(getFirstSelectedNode(), BodyDeclaration.class);

		super.endVisit(node);
		if (enclosingNode != null && !getStatus().hasFatalError()) {
			fExceptions = ExceptionAnalyzer.perform(enclosingNode, getSelection());
			if (fExceptions == null || fExceptions.length == 0) {
				fExceptions = new ITypeBinding[]{node.getAST().resolveWellKnownType("java.lang.Exception")}; //$NON-NLS-1$
			}
		}
	}

