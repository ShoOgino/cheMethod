  public static ICleanUpFix createCleanUp(
      CompilationUnit compilationUnit, boolean useLambda, boolean useAnonymous) {
    if (!JavaModelUtil.is18OrHigher(compilationUnit.getJavaElement().getJavaProject())) return null;

    if (useLambda) {
      ArrayList<ClassInstanceCreation> convertibleNodes =
          FunctionalAnonymousClassesFinder.perform(compilationUnit);
      if (convertibleNodes.isEmpty()) return null;

      CompilationUnitRewriteOperation op = new CreateLambdaOperation(convertibleNodes);
      return new LambdaExpressionsFix(
          FixMessages.LambdaExpressionsFix_convert_to_lambda_expression,
          compilationUnit,
          new CompilationUnitRewriteOperation[] {op});

    } else if (useAnonymous) {
      ArrayList<LambdaExpression> convertibleNodes =
          LambdaExpressionsFinder.perform(compilationUnit);
      if (convertibleNodes.isEmpty()) return null;

      CompilationUnitRewriteOperation op =
          new CreateAnonymousClassCreationOperation(convertibleNodes);
      return new LambdaExpressionsFix(
          FixMessages.LambdaExpressionsFix_convert_to_anonymous_class_creation,
          compilationUnit,
          new CompilationUnitRewriteOperation[] {op});
    }
    return null;
  }

