  /*
   * @see Refactoring#checkActivation(IProgressMonitor)
   */
  @Override
  public RefactoringStatus checkInitialConditions(IProgressMonitor pm) throws CoreException {
    try {
      pm.beginTask("", 1); //$NON-NLS-1$

      RefactoringStatus result =
          Checks.validateModifiesFiles(
              ResourceUtil.getFiles(new ICompilationUnit[] {fCu}), getValidationContext());
      if (result.hasFatalError()) return result;

      VariableDeclaration declaration = getVariableDeclaration();

      result.merge(checkSelection(declaration));
      if (result.hasFatalError()) return result;

      result.merge(checkInitializer(declaration));
      return result;
    } finally {
      pm.done();
    }
  }

