  /**
   * Adds a space before a brace if it is inserted after a parenthesis, equal sign, or one of the
   * keywords <code>try, else, do</code>.
   *
   * @param doc the document we are working on
   * @param position the insert position of <code>character</code>
   * @param character the character to be inserted
   * @return a <code>String</code> consisting of <code>character</code> plus any additional spacing
   */
  private String adjustSpacing(IDocument doc, int position, char character) {
    if (character == BRACECHAR) {
      if (position > 0 && position <= doc.getLength()) {
        int pos = position - 1;
        if (looksLike(doc, pos, ")") // $NON-NLS-1$
            || looksLike(doc, pos, "=") // $NON-NLS-1$
            || looksLike(doc, pos, "]") // $NON-NLS-1$
            || looksLike(doc, pos, "try") // $NON-NLS-1$
            || looksLike(doc, pos, "else") // $NON-NLS-1$
            || looksLike(doc, pos, "synchronized") // $NON-NLS-1$
            || looksLike(doc, pos, "static") // $NON-NLS-1$
            || looksLike(doc, pos, "finally") // $NON-NLS-1$
            || looksLike(doc, pos, "do")) // $NON-NLS-1$
        return new String(new char[] {' ', character});
      }
    }

    return new String(new char[] {character});
  }

