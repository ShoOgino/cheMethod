  /**
   * Configures the scanner by providing access to the document range over which to scan.
   *
   * @param document the document to scan
   * @param offset the offset of the document range to scan
   * @param length the length of the document range to scan
   */
  public final void setRange(IDocument document, int offset, int length) {

    fDocument = document;
    fRangeOffset = offset;
    fRangeLength = length;

    String[] delimiters = document.getLegalLineDelimiters();
    fDelimiters = new char[delimiters.length][];
    for (int i = 0; i < delimiters.length; i++) fDelimiters[i] = delimiters[i].toCharArray();

    updateBuffer(offset);
    fOffset = 0;
  }

