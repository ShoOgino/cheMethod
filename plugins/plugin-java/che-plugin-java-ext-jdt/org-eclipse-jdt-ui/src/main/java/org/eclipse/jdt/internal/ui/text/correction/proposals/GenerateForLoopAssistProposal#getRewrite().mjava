  /*
   * (non-Javadoc)
   * @see org.eclipse.jdt.ui.text.java.correction.ASTRewriteCorrectionProposal#getRewrite()
   */
  @Override
  protected ASTRewrite getRewrite() throws CoreException {

    AST ast = fCurrentNode.getAST();
    createImportRewrite((CompilationUnit) fCurrentExpression.getRoot());

    switch (fLoopTypeToGenerate) {
      case GenerateForLoopAssistProposal.GENERATE_FOREACH:
        return generateForEachRewrite(ast);
      case GenerateForLoopAssistProposal.GENERATE_ITERATOR_FOR:
        return generateIteratorBasedForRewrite(ast);
      case GenerateForLoopAssistProposal.GENERATE_ITERATE_ARRAY:
        return generateForRewrite(ast);
      case GenerateForLoopAssistProposal.GENERATE_ITERATE_LIST:
        return generateIndexBasedForRewrite(ast);
      default:
        return null;
    }
  }

