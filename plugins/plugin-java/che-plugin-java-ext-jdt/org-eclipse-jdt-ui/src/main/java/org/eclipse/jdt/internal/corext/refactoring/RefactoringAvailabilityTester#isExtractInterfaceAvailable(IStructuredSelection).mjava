  public static boolean isExtractInterfaceAvailable(final IStructuredSelection selection)
      throws JavaModelException {
    if (selection.size() == 1) {
      Object first = selection.getFirstElement();
      if (first instanceof IType) {
        return isExtractInterfaceAvailable((IType) first);
      } else if (first instanceof ICompilationUnit) {
        ICompilationUnit unit = (ICompilationUnit) first;
        if (!unit.exists() || unit.isReadOnly()) return false;

        return true;
      }
    }
    return false;
  }

