  /** {@inheritDoc} */
  @Override
  public ICleanUpFix createFix(CleanUpContext context) throws CoreException {
    CompilationUnit compilationUnit = context.getAST();
    if (compilationUnit == null) return null;

    boolean convertForLoops =
        isEnabled(CleanUpConstants.CONTROL_STATMENTS_CONVERT_FOR_LOOP_TO_ENHANCED);

    return ConvertLoopFix.createCleanUp(
        compilationUnit,
        convertForLoops,
        convertForLoops,
        isEnabled(CleanUpConstants.VARIABLE_DECLARATIONS_USE_FINAL)
            && isEnabled(CleanUpConstants.VARIABLE_DECLARATIONS_USE_FINAL_LOCAL_VARIABLES));
  }

