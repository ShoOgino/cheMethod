  private void addReferenceUpdates(TextChangeManager manager, IProgressMonitor pm) {
    pm.beginTask("", fReferences.length); //$NON-NLS-1$
    for (int i = 0; i < fReferences.length; i++) {
      ICompilationUnit cu = fReferences[i].getCompilationUnit();
      if (cu == null) continue;

      String name = RefactoringCoreMessages.RenameTypeRefactoring_update_reference;
      SearchMatch[] results = fReferences[i].getSearchResults();

      for (int j = 0; j < results.length; j++) {
        SearchMatch match = results[j];
        ReplaceEdit replaceEdit =
            new ReplaceEdit(match.getOffset(), match.getLength(), getNewElementName());
        TextChangeCompatibility.addTextEdit(
            manager.get(cu), name, replaceEdit, CATEGORY_TYPE_RENAME);
      }
      pm.worked(1);
    }
  }

