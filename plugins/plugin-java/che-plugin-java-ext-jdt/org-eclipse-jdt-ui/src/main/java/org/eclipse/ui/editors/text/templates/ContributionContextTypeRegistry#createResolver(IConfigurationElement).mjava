  private static TemplateVariableResolver createResolver(IConfigurationElement element)
      throws CoreException {
    try {
      String type = element.getAttribute(TYPE);
      if (type != null) {

        TemplateVariableResolver resolver =
            (TemplateVariableResolver) element.createExecutableExtension(CLASS);
        resolver.setType(type);

        String desc = element.getAttribute(DESCRIPTION);
        resolver.setDescription(desc == null ? "" : desc); // $NON-NLS-1$

        return resolver;
      }
    } catch (ClassCastException e) {
      throw new CoreException(
          new Status(
              IStatus.ERROR,
              "org.eclipse.ui.editors",
              IStatus.OK,
              "extension does not implement " + TemplateVariableResolver.class.getName(),
              e)); // $NON-NLS-1$
    }

    return null;
  }

