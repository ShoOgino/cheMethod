  /**
   * Returns the refactoring search collector.
   *
   * @return the refactoring search collector
   */
  private RefactoringSearchCollector getCollector() {
    if (fCollector == null) {
      if (fGranularity == GRANULARITY_COMPILATION_UNIT)
        fCollector = new RefactoringCompilationUnitCollector();
      else if (fGranularity == GRANULARITY_SEARCH_MATCH)
        fCollector = new RefactoringSearchMatchCollector();
      else Assert.isTrue(false);
    }
    return fCollector;
  }

