  /*
   * Finds, if possible, a classpathEntry in one given project such that this classpath entry references another given project. If more than one entry exists for the referenced project and at least one is exported, then an exported entry will be returned.
   */
  private static IClasspathEntry getReferencingClassPathEntry(
      IJavaProject referencingProject, IJavaProject referencedProject) throws JavaModelException {
    IClasspathEntry result = null;
    IPath path = referencedProject.getProject().getFullPath();
    IClasspathEntry[] classpath = referencingProject.getResolvedClasspath(true);
    for (int i = 0; i < classpath.length; i++) {
      IClasspathEntry entry = classpath[i];
      if (entry.getEntryKind() == IClasspathEntry.CPE_PROJECT && path.equals(entry.getPath())) {
        if (entry.isExported()) return entry;
        // Consider it as a candidate. May be there is another entry that is
        // exported.
        result = entry;
      }
    }
    return result;
  }

