  private static boolean getAddFinallyProposals(
      IInvocationContext context, ASTNode node, Collection<ICommandAccess> resultingCollections) {
    TryStatement tryStatement = ASTResolving.findParentTryStatement(node);
    if (tryStatement == null || tryStatement.getFinally() != null) {
      return false;
    }
    Statement statement = ASTResolving.findParentStatement(node);
    if (tryStatement != statement && tryStatement.getBody() != statement) {
      return false; // an node inside a catch or finally block
    }

    if (resultingCollections == null) {
      return true;
    }

    AST ast = tryStatement.getAST();
    ASTRewrite rewrite = ASTRewrite.create(ast);
    Block finallyBody = ast.newBlock();

    rewrite.set(tryStatement, TryStatement.FINALLY_PROPERTY, finallyBody, null);

    String label = CorrectionMessages.QuickAssistProcessor_addfinallyblock_description;
    Image image = JavaPluginImages.get(JavaPluginImages.IMG_CORRECTION_ADD);
    ASTRewriteCorrectionProposal proposal =
        new ASTRewriteCorrectionProposal(
            label,
            context.getCompilationUnit(),
            rewrite,
            IProposalRelevance.ADD_FINALLY_BLOCK,
            image);
    resultingCollections.add(proposal);
    return true;
  }

