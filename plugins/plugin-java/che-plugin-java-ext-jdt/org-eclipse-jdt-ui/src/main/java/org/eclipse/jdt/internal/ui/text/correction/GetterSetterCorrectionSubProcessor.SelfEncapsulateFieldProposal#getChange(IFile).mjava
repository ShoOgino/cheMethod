    public TextFileChange getChange(IFile file) throws CoreException {
      final SelfEncapsulateFieldRefactoring refactoring =
          new SelfEncapsulateFieldRefactoring(fField);
      refactoring.setVisibility(Flags.AccPublic);
      refactoring.setConsiderVisibility(
          false); //private field references are just searched in local file
      refactoring.checkInitialConditions(new NullProgressMonitor());
      refactoring.checkFinalConditions(new NullProgressMonitor());
      Change createdChange = refactoring.createChange(new NullProgressMonitor());
      if (createdChange instanceof CompositeChange) {
        Change[] children = ((CompositeChange) createdChange).getChildren();
        for (int i = 0; i < children.length; i++) {
          Change curr = children[i];
          if (curr instanceof TextFileChange && ((TextFileChange) curr).getFile().equals(file)) {
            return (TextFileChange) curr;
          }
        }
      }
      return null;
    }

