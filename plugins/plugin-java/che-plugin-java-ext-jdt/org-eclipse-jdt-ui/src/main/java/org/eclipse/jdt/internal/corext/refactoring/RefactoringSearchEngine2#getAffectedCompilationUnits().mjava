	/**
	 * Returns the affected compilation units of the previous search queries.
	 * <p>
	 * In order to retrieve the compilation units, grouping by resource must have been enabled before searching.
	 *
	 * @return the compilation units of the previous queries
	 */
	public final ICompilationUnit[] getAffectedCompilationUnits() {
		if (fGranularity == GRANULARITY_COMPILATION_UNIT) {
			final Collection<?> collection = getCollector().getCollectedMatches();
			final ICompilationUnit[] units = new ICompilationUnit[collection.size()];
			int index = 0;
			for (final Iterator<?> iterator = collection.iterator(); iterator.hasNext(); index++)
				units[index] = (ICompilationUnit)iterator.next();
			return units;
		} else {
			final SearchResultGroup[] groups = getGroupedMatches();
			final ICompilationUnit[] units = new ICompilationUnit[groups.length];
			for (int index = 0; index < groups.length; index++)
				units[index] = groups[index].getCompilationUnit();
			return units;
		}
	}

