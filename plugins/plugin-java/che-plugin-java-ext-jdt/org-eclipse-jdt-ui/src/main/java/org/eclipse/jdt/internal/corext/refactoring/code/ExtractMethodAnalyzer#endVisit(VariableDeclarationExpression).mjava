  @Override
  public void endVisit(VariableDeclarationExpression node) {
    if (getSelection().getEndVisitSelectionMode(node) == Selection.SELECTED
        && getFirstSelectedNode() == node) {
      if (node.getLocationInParent() == TryStatement.RESOURCES_PROPERTY) {
        invalidSelection(
            RefactoringCoreMessages.ExtractMethodAnalyzer_resource_in_try_with_resources,
            JavaStatusContext.create(fCUnit, getSelection()));
      }
    }
    checkTypeInDeclaration(node.getType());
    super.endVisit(node);
  }

