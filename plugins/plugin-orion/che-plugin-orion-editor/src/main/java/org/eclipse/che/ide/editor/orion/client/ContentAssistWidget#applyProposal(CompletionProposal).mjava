    private void applyProposal(CompletionProposal proposal) {
        CompletionProposal.CompletionCallback callback = this::applyCompletion;

        if (proposal instanceof CompletionProposalExtension) {
            ((CompletionProposalExtension)proposal).getCompletion(insert, callback);
        } else {
            proposal.getCompletion(callback);
        }

        hide();
    }

