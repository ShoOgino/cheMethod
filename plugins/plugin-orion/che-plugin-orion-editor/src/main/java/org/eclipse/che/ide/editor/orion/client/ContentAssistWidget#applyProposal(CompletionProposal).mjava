    private void applyProposal(CompletionProposal proposal) {
        CompletionProposal.CompletionCallback callback = new CompletionProposal.CompletionCallback() {
            @Override
            public void onCompletion(Completion completion) {
                applyCompletion(completion);
            }
        };

        if (proposal instanceof CompletionProposalExtension) {
            ((CompletionProposalExtension) proposal).getCompletion(insert, callback);
        } else {
            proposal.getCompletion(callback);
        }

        hide();
    }

