    private int[] columnWidths() {
      int maxColumnCount =
          rows.stream()
              .max(Comparator.comparingInt(o -> o.length))
              .map(row -> row.length)
              .orElse(-1);

      int[] columnWidths = new int[maxColumnCount];

      for (int column = 0; column < columnWidths.length; column++) {
        final int col = column; // effective final
        columnWidths[column] =
            rows.stream()
                .max(Comparator.comparingInt(row -> row.length <= col ? -1 : row[col].length()))
                .map(row -> row.length <= col ? 1 : row[col].length())
                .orElse(1);
      }

      return columnWidths;
    }

