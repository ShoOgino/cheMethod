    @Test
    public void shouldBeAbleToPullImagecreateRegistryRepository() throws IOException, InterruptedException {
        PullParams pullParams = PullParams.create(IMAGE)
                                          .withRegistry(REGISTRY);

        when(dockerResponse.getInputStream()).thenReturn(new ByteArrayInputStream(STREAM_DATA_BYTES));

        dockerConnector.pull(pullParams, progressMonitor);

        verify(dockerConnectionFactory).openConnection(any(URI.class));
        verify(dockerConnection).method(REQUEST_METHOD_POST);
        verify(dockerConnection).path("/images/create");
        verify(dockerConnection).query("fromImage", pullParams.getRegistry() + '/' + pullParams.getImage());
        verify(dockerConnection).header(eq("X-Registry-Auth"), any(AuthConfig.class));
        verify(dockerConnection).request();
        verify(dockerResponse).getStatus();
        verify(dockerResponse).getInputStream();
    }

