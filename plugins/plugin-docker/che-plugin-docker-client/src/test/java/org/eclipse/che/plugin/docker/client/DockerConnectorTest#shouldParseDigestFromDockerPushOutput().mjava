    @Test
    public void shouldParseDigestFromDockerPushOutput() throws IOException, InterruptedException {
        String digest = "hash:1234567890";
        String repository = "repository";
        String tag = "tag";
        String registry = "registry";

        String dockerPushOutput = "{\"progress\":\"[=====>              ] 25%\"}\n" +
                                  "{\"status\":\"Image already exists\"}\n" +
                                  "{\"progress\":\"[===============>    ] 75%\"}\n" +
                                  "{\"status\":\"" + tag + ": digest: " + digest + " size: 12345\"}";

        when(initialAuthConfig.getAuthConfigHeader()).thenReturn("authHeader");
        when(dockerResponse.getStatus()).thenReturn(200);
        when(dockerResponse.getInputStream()).thenReturn(new ByteArrayInputStream(dockerPushOutput.getBytes()));

        assertEquals(digest, dockerConnector.push(repository, tag, registry, progressMonitor));
    }

