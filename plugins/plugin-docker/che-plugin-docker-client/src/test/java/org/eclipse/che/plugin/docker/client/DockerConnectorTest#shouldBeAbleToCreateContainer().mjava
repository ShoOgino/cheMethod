  @Test
  public void shouldBeAbleToCreateContainer() throws IOException, JsonParseException {
    CreateContainerParams createContainerParams =
        CreateContainerParams.create(new ContainerConfig());

    ContainerCreated containerCreated = mock(ContainerCreated.class);

    when(dockerResponse.getStatus()).thenReturn(RESPONSE_CREATED_CODE);
    doReturn(containerCreated)
        .when(dockerConnector)
        .parseResponseStreamAndClose(inputStream, ContainerCreated.class);

    ContainerCreated returnedContainerCreated =
        dockerConnector.createContainer(createContainerParams);

    verify(dockerConnectionFactory).openConnection(any(URI.class));
    verify(dockerConnection).method(REQUEST_METHOD_POST);
    verify(dockerConnection).path("/containers/create");
    verify(dockerConnection).header("Content-Type", MediaType.APPLICATION_JSON);
    verify(dockerConnection).header(eq("Content-Length"), anyInt());
    verify(dockerConnection).entity(any(byte[].class));
    verify(dockerConnection).request();
    verify(dockerResponse).getStatus();
    verify(dockerResponse).getInputStream();

    assertEquals(returnedContainerCreated, containerCreated);
  }

