  @Test
  public void shouldBeAbleToPushImageToRegistryRepository()
      throws IOException, InterruptedException {
    PushParams pushParams = PushParams.create(REPOSITORY).withRegistry(REGISTRY);

    when(dockerResponse.getInputStream())
        .thenReturn(
            new ByteArrayInputStream(
                ("{\"status\":\"latest: digest: " + DIGEST + " size: 1234\"}").getBytes()));

    dockerConnector.push(pushParams, progressMonitor);

    verify(dockerConnectionFactory).openConnection(nullable(URI.class));
    verify(dockerConnection).method(REQUEST_METHOD_POST);
    verify(dockerConnection)
        .path("/images/" + pushParams.getRegistry() + '/' + pushParams.getRepository() + "/push");
    verify(dockerConnection).header(eq("X-Registry-Auth"), nullable(AuthConfig.class));
    verify(dockerConnection).request();
    verify(dockerResponse).getStatus();
    verify(dockerResponse).getInputStream();
  }

