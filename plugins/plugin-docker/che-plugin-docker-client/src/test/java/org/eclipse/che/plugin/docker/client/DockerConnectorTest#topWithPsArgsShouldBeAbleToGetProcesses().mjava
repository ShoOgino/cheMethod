    @Test
    public void topWithPsArgsShouldBeAbleToGetProcesses() throws IOException, JsonParseException {
        TopParams topParams = TopParams.create(CONTAINER)
                                       .withPsArgs(CMD_ARGS);

        ContainerProcesses containerProcesses = mock(ContainerProcesses.class);

        doReturn(containerProcesses).when(dockerConnector).parseResponseStreamAndClose(inputStream, ContainerProcesses.class);

        ContainerProcesses returnedContainerProcesses =
                dockerConnector.top(topParams);

        verify(dockerConnectionFactory).openConnection(any(URI.class));
        verify(dockerConnection).method(REQUEST_METHOD_GET);
        verify(dockerConnection).path("/containers/" + topParams.getContainer() + "/top");
        verify(dockerConnection).query(eq("ps_args"), anyString());
        verify(dockerConnection).request();
        verify(dockerResponse).getStatus();
        verify(dockerResponse).getInputStream();

        assertEquals(returnedContainerProcesses, containerProcesses);
    }

