  @Test
  public void shouldBeAbleToGetListContainersByFiltersInTheListContainersParams()
      throws IOException, JsonParseException {
    Filters filters = new Filters().withFilter("testKey", "testValue");
    ListContainersParams listContainersParams = ListContainersParams.create().withFilters(filters);
    ContainerListEntry containerListEntry = mock(ContainerListEntry.class);
    List<ContainerListEntry> expectedListContainers = singletonList(containerListEntry);

    doReturn(expectedListContainers)
        .when(dockerConnector)
        .parseResponseStreamAndClose(
            eq(inputStream),
            org.mockito.ArgumentMatchers.<TypeToken<List<ContainerListEntry>>>any());

    List<ContainerListEntry> containers = dockerConnector.listContainers(listContainersParams);

    verify(dockerConnection).query(eq("filters"), anyObject());
    assertEquals(containers, expectedListContainers);
  }

