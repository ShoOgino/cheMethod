    /**
     * Builds new image.
     *
     * @param progressMonitor
     *         ProgressMonitor for images creation process
     * @return image id
     * @throws IOException
     * @throws InterruptedException
     *         if build process was interrupted
     */
    public String buildImage(final BuildImageParams params,
                             final ProgressMonitor progressMonitor) throws IOException, InterruptedException {
        final File tar = Files.createTempFile(null, ".tar").toFile();
        try {
            File[] files = new File[params.getFiles().size()];
            files = params.getFiles().toArray(files);
            createTarArchive(tar, files);
            return buildImage(params, progressMonitor, tar, dockerDaemonUri);
        } finally {
            FileCleaner.addFile(tar);
        }
    }

