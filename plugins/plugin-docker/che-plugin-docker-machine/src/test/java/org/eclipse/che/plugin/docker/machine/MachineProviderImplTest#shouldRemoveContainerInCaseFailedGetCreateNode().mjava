  @Test(expectedExceptions = ServerException.class)
  public void shouldRemoveContainerInCaseFailedGetCreateNode() throws Exception {
    doThrow(IOException.class).when(dockerMachineFactory).createNode(any(), any());

    createInstanceFromRecipe(false, WORKSPACE_ID);

    verify(dockerConnector)
        .removeContainer(
            RemoveContainerParams.create(CONTAINER_ID).withRemoveVolumes(true).withForce(true));
  }

