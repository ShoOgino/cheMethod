  @Test(dataProvider = "securityOptTestProvider")
  public void shouldSetSecurityOptOnContainerCreation(String[] securityOpt) throws Exception {
    provider = new MachineProviderBuilder().setSecurityOpt(securityOpt).build();

    createInstanceFromRecipe();

    ArgumentCaptor<CreateContainerParams> argumentCaptor =
        ArgumentCaptor.forClass(CreateContainerParams.class);
    verify(dockerConnector).createContainer(argumentCaptor.capture());
    assertEqualsNoOrder(
        argumentCaptor.getValue().getContainerConfig().getHostConfig().getSecurityOpt(),
        securityOpt);
  }

