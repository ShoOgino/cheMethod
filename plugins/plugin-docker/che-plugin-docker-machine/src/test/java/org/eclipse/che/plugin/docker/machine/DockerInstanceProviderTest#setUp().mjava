    @BeforeMethod
    public void setUp() throws Exception {
        when(dockerConnectorConfiguration.getDockerHostIp()).thenReturn("123.123.123.123");

        dockerInstanceProvider = spy(new DockerInstanceProvider(dockerConnector,
                                                                dockerConnectorConfiguration,
                                                                dockerMachineFactory,
                                                                dockerInstanceStopDetector,
                                                                Collections.<ServerConf>emptySet(),
                                                                Collections.<ServerConf>emptySet(),
                                                                Collections.<String>emptySet(),
                                                                Collections.<String>emptySet(),
                                                                null,
                                                                workspaceFolderPathProvider,
                                                                PROJECT_FOLDER_PATH,
                                                                false,
                                                                Collections.<String>emptySet(),
                                                                Collections.<String>emptySet()));

        EnvironmentContext envCont = new EnvironmentContext();
        envCont.setUser(new UserImpl("user", "userId", USER_TOKEN, null, false));
        EnvironmentContext.setCurrent(envCont);

        when(dockerMachineFactory.createNode(anyString(), anyString())).thenReturn(dockerNode);
        when(dockerConnector.createContainer(any(ContainerConfig.class), anyString()))
                .thenReturn(new ContainerCreated(CONTAINER_ID, new String[0]));
    }

