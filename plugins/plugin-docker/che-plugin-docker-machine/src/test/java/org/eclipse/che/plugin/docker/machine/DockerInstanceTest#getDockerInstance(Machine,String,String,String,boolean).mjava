    private DockerInstance getDockerInstance(Machine machine,
                                             String registry,
                                             String container,
                                             String image,
                                             boolean snapshotUseRegistry) throws MachineException {
        DockerMachineFactory machineFactory = mock(DockerMachineFactory.class);
        when(machineFactory.createMetadata(any(), any(), any())).thenReturn(mock(DockerInstanceRuntimeInfo.class));
        return new DockerInstance(dockerConnectorMock,
                                  registry,
                                  USERNAME,
                                  machineFactory,
                                  machine,
                                  container,
                                  image,
                                  mock(DockerNode.class),
                                  outputConsumer,
                                  dockerInstanceStopDetectorMock,
                                  mock(DockerInstanceProcessesCleaner.class),
                                  snapshotUseRegistry);
    }

