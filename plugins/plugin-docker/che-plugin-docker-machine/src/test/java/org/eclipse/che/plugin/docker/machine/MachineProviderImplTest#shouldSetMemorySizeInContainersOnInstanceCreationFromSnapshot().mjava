  @Test
  public void shouldSetMemorySizeInContainersOnInstanceCreationFromSnapshot() throws Exception {
    int memorySizeMB = 234;

    createInstanceFromSnapshot(memorySizeMB);

    ArgumentCaptor<CreateContainerParams> argumentCaptor =
        ArgumentCaptor.forClass(CreateContainerParams.class);
    verify(dockerConnector).createContainer(argumentCaptor.capture());
    verify(dockerConnector).startContainer(any(StartContainerParams.class));
    // docker accepts memory size in bytes
    assertEquals(
        argumentCaptor.getValue().getContainerConfig().getHostConfig().getMemory(),
        memorySizeMB * 1024 * 1024);
  }

