    @Test
    public void shouldSetExternalAddressAsInternalAddressIfContainerExternalHostnameIsNull() throws Exception {
        // given
        Map<String, List<PortBinding>> ports = new HashMap<>();
        when(networkSettings.getPorts()).thenReturn(ports);
        ports.put("4301/tcp", Collections.singletonList(new PortBinding().withHostIp(DEFAULT_ADDRESS)
                                                                .withHostPort("32100")));
        ports.put("4305/udp", Collections.singletonList(new PortBinding().withHostIp(DEFAULT_ADDRESS)
                                                                .withHostPort("32103")));
        Set<ServerConf> commonSystemServersConfigs = new HashSet<>();
        commonSystemServersConfigs.add(new ServerConfImpl("sysServer1-tcp", "4301/tcp", "http", "/some/path1"));
        Set<ServerConf> devSystemServersConfigs = new HashSet<>();
        devSystemServersConfigs.add(new ServerConfImpl("devSysServer1-udp", "4305/udp", null, "some/path4"));
        when(machineConfig.isDev()).thenReturn(true);
        runtimeInfo = new DockerInstanceRuntimeInfo(containerInfo,
                                                           null,
                                                           CONTAINER_HOST,
                                                           machineConfig,
                                                           devSystemServersConfigs,
                                                           commonSystemServersConfigs);
        final HashMap<String, ServerImpl> expectedServers = new HashMap<>();
        expectedServers.put("4301/tcp", new ServerImpl("sysServer1-tcp",
                                                              "http",
                                                              CONTAINER_HOST + ":32100",
                                                              "http://" + CONTAINER_HOST + ":32100/some/path1",
                                                              new ServerPropertiesImpl("/some/path1",
                                                                                              CONTAINER_HOST + ":32100",
                                                                                              "http://" + CONTAINER_HOST + ":32100/some/path1")));
        expectedServers.put("4305/udp", new ServerImpl("devSysServer1-udp",
                                                              null,
                                                              CONTAINER_HOST + ":32103",
                                                              null,
                                                              new ServerPropertiesImpl("some/path4",
                                                                                              CONTAINER_HOST + ":32103",
                                                                                              null)));

        // when
        final Map<String, ServerImpl> servers = runtimeInfo.getServers();

        // then
        assertEquals(servers, expectedServers);
    }

