    @Test(expectedExceptions = MachineException.class)
    public void shouldRemoveContainerInCaseFailedCreateInstanceOnTheDockerMachineFactory() throws Exception {
        doThrow(IOException.class).when(dockerMachineFactory).createInstance(any(), any(), any(), any(), any());

        createInstanceFromRecipe(false, WORKSPACE_ID);

        verify(dockerConnector).removeContainer(RemoveContainerParams.create(CONTAINER_ID).withRemoveVolumes(true).withForce(true));
    }

