    @Test
    public void shouldSaveDockerInstanceStateIntoRepository() throws Exception {
        final String digest = "image12";
        dockerInstance = getDockerInstance(getMachine(), REGISTRY, CONTAINER, IMAGE, true);
        when(dockerConnectorMock.push(any(PushParams.class), any(ProgressMonitor.class))).thenReturn(digest);

        final InstanceKey result = dockerInstance.saveToSnapshot(OWNER);

        assertEquals(result.getFields().get("tag"), TAG);
        assertEquals(result.getFields().get("digest"), digest);
        assertTrue(result.getFields().containsKey("registry"));
    }

