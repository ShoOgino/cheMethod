  @Test
  public void
      shouldAddServersConfsPortsFromMachineConfigToExposedPortsOnNonDevInstanceCreationFromRecipe()
          throws Exception {
    // given
    final boolean isDev = false;
    CheServiceImpl machine = createService();
    machine.setExpose(asList("9090", "8080"));
    List<String> expectedExposedPorts = asList("9090", "8080");

    // when
    createInstanceFromRecipe(machine, isDev);

    // then
    ArgumentCaptor<CreateContainerParams> argumentCaptor =
        ArgumentCaptor.forClass(CreateContainerParams.class);
    verify(dockerConnector).createContainer(argumentCaptor.capture());

    assertTrue(
        new ArrayList<>(argumentCaptor.getValue().getContainerConfig().getExposedPorts().keySet())
            .containsAll(expectedExposedPorts));
  }

