  @Test
  public void shouldUseExternalAddressForSecuredInternalAddress() throws Exception {
    // given
    strategy =
        new AlwaysExternalCustomServerEvaluationStrategy(
                "10.0.0.1",
                CHE_DOCKER_IP_EXTERNAL,
                CHE_DOCKER_SERVER_EVALUATION_STRATEGY_CUSTOM_TEMPLATE,
                "https",
                null,
                null)
            .withThrowOnUnknownHost(false);

    final Map<String, ServerImpl> expectedServers =
        getExpectedServers(CHE_DOCKER_IP_EXTERNAL, CONTAINERCONFIG_HOSTNAME, "https");

    // when
    final Map<String, ServerImpl> servers =
        strategy.getServers(containerInfo, CHE_DOCKER_IP_EXTERNAL, serverConfs);

    // then
    assertEquals(servers, expectedServers);
  }

