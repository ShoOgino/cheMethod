  @Test
  public void shouldAddRefUrlProtocolPathToServerFromMachineConfig() throws Exception {
    // given
    prepareStrategyAndContainerInfoMocks();

    serverConfs.put("8080/tcp", new ServerConfImpl("myserv1", "8080/tcp", "http", null));
    serverConfs.put("9090/udp", new ServerConfImpl("myserv2", "9090/udp", "dhcp", "/some/path"));

    final HashMap<String, ServerImpl> expectedServers = new HashMap<>();
    expectedServers.put(
        "8080/tcp",
        new ServerImpl(
            "myserv1",
            "http",
            DEFAULT_HOSTNAME + ":32100",
            "http://" + DEFAULT_HOSTNAME + ":32100",
            new ServerPropertiesImpl(
                null, DEFAULT_HOSTNAME + ":32100", "http://" + DEFAULT_HOSTNAME + ":32100")));
    expectedServers.put(
        "9090/udp",
        new ServerImpl(
            "myserv2",
            "dhcp",
            DEFAULT_HOSTNAME + ":32101",
            "dhcp://" + DEFAULT_HOSTNAME + ":32101/some/path",
            new ServerPropertiesImpl(
                "/some/path",
                DEFAULT_HOSTNAME + ":32101",
                "dhcp://" + DEFAULT_HOSTNAME + ":32101/some/path")));

    // when
    final Map<String, ServerImpl> servers =
        strategy.getServers(containerInfo, DEFAULT_HOSTNAME, serverConfs);

    // then
    assertEquals(servers, expectedServers);
  }

