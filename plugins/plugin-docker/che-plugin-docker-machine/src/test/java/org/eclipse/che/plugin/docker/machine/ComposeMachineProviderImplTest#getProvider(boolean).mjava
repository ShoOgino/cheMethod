    private ComposeMachineProviderImpl getProvider(boolean snapshotUseRegistry) throws Exception {
        return spy(new ComposeMachineProviderImpl(dockerConnector,
                                                  dockerConnectorConfiguration,
                                                  credentialsReader,
                                                  dockerMachineFactory,
                                                  dockerInstanceStopDetector,
                                                  containerNameGenerator,
                                                  Collections.emptySet(),
                                                  Collections.emptySet(),
                                                  Collections.emptySet(),
                                                  Collections.emptySet(),
                                                  null,
                                                  workspaceFolderPathProvider,
                                                  PROJECT_FOLDER_PATH,
                                                  false,
                                                  false,
                                                  Collections.emptySet(),
                                                  Collections.emptySet(),
                                                  snapshotUseRegistry,
                                                  MEMORY_SWAP_MULTIPLIER,
                                                  emptySet()));
    }

