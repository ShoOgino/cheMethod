    @Test
    public void shouldUseLocalImageOnInstanceCreationFromSnapshot() throws Exception {
        final String repo = MACHINE_SNAPSHOT_PREFIX + "repo";
        final String tag = "latest";
        provider = getProvider(false);

        ComposeServiceImpl machine = createService();
        machine.setImage(repo + ":" + tag);
        machine.setBuild(null);

        provider.startService(USER_NAME,
                              WORKSPACE_ID,
                              ENV_NAME,
                              MACHINE_ID,
                              MACHINE_NAME,
                              false,
                              NETWORK_NAME,
                              machine,
                              LineConsumer.DEV_NULL);

        verify(dockerConnector, never()).pull(any(PullParams.class), any(ProgressMonitor.class));
    }

