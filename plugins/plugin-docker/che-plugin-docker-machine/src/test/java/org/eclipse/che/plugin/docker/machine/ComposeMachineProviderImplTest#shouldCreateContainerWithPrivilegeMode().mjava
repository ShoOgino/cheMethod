    @Test
    public void shouldCreateContainerWithPrivilegeMode() throws Exception {
        provider = spy(new ComposeMachineProviderImpl(dockerConnector,
                                                      dockerConnectorConfiguration,
                                                      credentialsReader,
                                                      dockerMachineFactory,
                                                      dockerInstanceStopDetector,
                                                      containerNameGenerator,
                                                      Collections.emptySet(),
                                                      Collections.emptySet(),
                                                      Collections.emptySet(),
                                                      Collections.emptySet(),
                                                      null,
                                                      workspaceFolderPathProvider,
                                                      PROJECT_FOLDER_PATH,
                                                      false,
                                                      true,
                                                      Collections.emptySet(),
                                                      Collections.emptySet(),
                                                      SNAPSHOT_USE_REGISTRY,
                                                      MEMORY_SWAP_MULTIPLIER,
                                                      emptySet()));

        createInstanceFromRecipe();

        ArgumentCaptor<CreateContainerParams> argumentCaptor = ArgumentCaptor.forClass(CreateContainerParams.class);
        verify(dockerConnector).createContainer(argumentCaptor.capture());
        assertTrue(argumentCaptor.getValue().getContainerConfig().getHostConfig().isPrivileged());
    }

