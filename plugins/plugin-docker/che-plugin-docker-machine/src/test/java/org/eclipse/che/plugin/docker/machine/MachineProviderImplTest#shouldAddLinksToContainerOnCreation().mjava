  @Test
  public void shouldAddLinksToContainerOnCreation() throws Exception {
    // given
    String links[] = new String[] {"container1", "container2:alias"};

    CheServiceImpl service = createService();
    service.setLinks(asList(links));

    // when
    createInstanceFromRecipe(service, true);

    // then
    ArgumentCaptor<CreateContainerParams> argumentCaptor =
        ArgumentCaptor.forClass(CreateContainerParams.class);
    verify(dockerConnector).createContainer(argumentCaptor.capture());
    ContainerConfig containerConfig = argumentCaptor.getValue().getContainerConfig();
    assertEquals(containerConfig.getHostConfig().getLinks(), links);
    assertEquals(
        containerConfig.getNetworkingConfig().getEndpointsConfig().get(NETWORK_NAME).getLinks(),
        links);
  }

