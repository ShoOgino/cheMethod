  /** Override the host for all ports by using the external template. */
  @Override
  protected Map<String, String> getExternalAddressesAndPorts(
      ContainerInfo containerInfo, String internalHost) {

    // create Rendering evaluation
    RenderingEvaluation renderingEvaluation =
        getOnlineRenderingEvaluation(containerInfo, internalHost);

    // get current ports
    Map<String, List<PortBinding>> ports = containerInfo.getNetworkSettings().getPorts();

    if (isNullOrEmpty(cheDockerCustomExternalTemplate)) {
      return getExposedPortsToAddressPorts(renderingEvaluation.getExternalAddress(), ports, false);
    }

    return ports
        .keySet()
        .stream()
        .collect(
            Collectors.toMap(
                portKey -> portKey,
                portKey -> renderingEvaluation.render(cheDockerCustomExternalTemplate, portKey)));
  }

