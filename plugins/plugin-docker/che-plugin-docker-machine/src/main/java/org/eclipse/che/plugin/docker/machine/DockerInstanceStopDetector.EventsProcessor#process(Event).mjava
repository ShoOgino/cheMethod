        @Override
        public void process(Event message) {
            switch (message.getStatus()) {
                case "oom":
                    containersOomTimestamps.put(message.getId(), message.getId());
                    break;
                case "die":
                    InstanceStateEvent.Type instanceStateChangeType;
                    if (containersOomTimestamps.getIfPresent(message.getId()) != null) {
                        instanceStateChangeType = InstanceStateEvent.Type.OOM;
                        containersOomTimestamps.invalidate(message.getId());
                        LOG.info("OOM of container '{}' has been detected", message.getId());
                    } else {
                        instanceStateChangeType = InstanceStateEvent.Type.DIE;
                    }
                    final String instanceId = instances.get(message.getId());
                    if (instanceId != null) {
                        eventService.publish(new InstanceStateEvent(instanceId, instanceStateChangeType));
                        lastProcessedEventDate = message.getTime();
                    }
                    break;
                default:
                    // we don't care about other event types
            }
        }

