  @Override
  public void destroy() throws MachineException {
    try {
      outputConsumer.close();
    } catch (IOException ignored) {
    }

    machineProcesses.clear();
    processesCleaner.untrackProcesses(getId());
    dockerInstanceStopDetector.stopDetection(container);
    try {
      if (getConfig().isDev()) {
        node.unbindWorkspace();
      }

      // kill container is not needed here, because we removing container with force flag
      docker.removeContainer(
          RemoveContainerParams.create(container).withRemoveVolumes(true).withForce(true));
    } catch (IOException | ServerException e) {
      LOG.error(e.getLocalizedMessage(), e);
      throw new MachineException(e.getLocalizedMessage());
    }

    try {
      docker.removeImage(RemoveImageParams.create(image).withForce(false));
    } catch (IOException ignore) {
      LOG.error("IOException during destroy(). Ignoring.");
    }
  }

