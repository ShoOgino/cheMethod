    private void pullImage(final DockerMachineSource dockerMachineSource, final LineConsumer creationLogsOutput) throws MachineException {
        if (dockerMachineSource.getRepository() == null) {
            throw new MachineException(String.format("Machine creation failed. Machine source is invalid. No repository is defined. Found %s.", dockerMachineSource));
        }

        final String tag;
        if (isNullOrEmpty(dockerMachineSource.getTag())) {
            tag = LATEST_TAG;
        } else {
            tag = dockerMachineSource.getTag();
        }
        PullParams pullParams = PullParams.create(dockerMachineSource.getRepository())
                  .withTag(tag)
                  .withRegistry(dockerMachineSource.getRegistry());
        try {
            final ProgressLineFormatterImpl progressLineFormatter = new ProgressLineFormatterImpl();
            docker.pull(pullParams,
                        currentProgressStatus -> {
                            try {
                                creationLogsOutput.writeLine(progressLineFormatter.format(currentProgressStatus));
                            } catch (IOException e) {
                                LOG.error(e.getLocalizedMessage(), e);
                            }
                        });
        } catch (IOException | InterruptedException e) {
            throw new MachineException(e.getLocalizedMessage(), e);
        }
    }

