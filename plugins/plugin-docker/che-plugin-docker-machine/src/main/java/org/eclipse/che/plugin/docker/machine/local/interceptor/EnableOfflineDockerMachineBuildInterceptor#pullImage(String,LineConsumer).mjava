    private void pullImage(String image, final LineConsumer creationLogsOutput)
            throws DockerFileException, IOException, InterruptedException {

        DockerImageIdentifier imageIdentifier = DockerImageIdentifierParser.parse(image);
        final ProgressLineFormatterImpl progressLineFormatter = new ProgressLineFormatterImpl();

        dockerConnector.pull(PullParams.create(imageIdentifier.getRepository())
                                       .withTag(MoreObjects.firstNonNull(imageIdentifier.getTag(), "latest"))
                                       .withRegistry(imageIdentifier.getRegistry())
                                       .withAuthConfigs(dockerCredentials.getCredentials()),
                             currentProgressStatus -> {
                                 try {
                                     creationLogsOutput.writeLine(progressLineFormatter.format(currentProgressStatus));
                                 } catch (IOException e) {
                                     LOG.error(e.getLocalizedMessage(), e);
                                 }
                             });
    }

