  @Test
  public void shouldDeleteWorkspaceInQueueOnServerIdleEvent() {
    //given
    OpenShiftWorkspaceFilesCleaner spyCleaner = spy(cleaner);
    doNothing().when(spyCleaner).deleteWorkspacesInQueue();

    EventService eventService = mock(EventService.class);
    spyCleaner.subscribe(eventService);
    verify(eventService).subscribe(subscriberCaptor.capture(), eq(ServerIdleEvent.class));
    EventSubscriber<ServerIdleEvent> subscriber = subscriberCaptor.getValue();

    //when
    subscriber.onEvent(new ServerIdleEvent(1000));

    //then
    verify(spyCleaner).deleteWorkspacesInQueue();
  }

