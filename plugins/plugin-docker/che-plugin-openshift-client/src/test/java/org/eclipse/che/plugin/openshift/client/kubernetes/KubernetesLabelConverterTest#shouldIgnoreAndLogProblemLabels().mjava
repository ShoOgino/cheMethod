  @Test
  public void shouldIgnoreAndLogProblemLabels() {
    // Given
    Map<String, String> originalLabels = new HashMap<>();
    Map<String, String> validLabels = new HashMap<>();
    validLabels.put(prefix + "4401/tcp:path:", "/api");
    validLabels.put(prefix + "8000/tcp:ref:", "tomcat-debug");
    Map<String, String> invalidLabels = new HashMap<>();
    invalidLabels.put(prefix + "9999/t.cp:path:", "/api");
    invalidLabels.put(prefix + "1111/tcp:path:", "/a_pi");

    originalLabels.putAll(validLabels);
    originalLabels.putAll(invalidLabels);

    // When
    Map<String, String> converted = KubernetesLabelConverter.labelsToNames(originalLabels);
    Map<String, String> unconverted = KubernetesLabelConverter.namesToLabels(converted);

    // Then
    assertTrue(
        validLabels.entrySet().stream().allMatch(unconverted.entrySet()::contains),
        "Valid labels should be there when converting + unconverting");
    assertTrue(
        invalidLabels.entrySet().stream().noneMatch(unconverted.entrySet()::contains),
        "Labels with invalid characters should be ignored");
  }

