    @Test
    public void shouldDeleteMultipleQueuedWorkspacesAtOnce() throws ServerException, IOException {
        // Given
        Workspace workspaceOne = generateWorkspace(WORKSPACE_ONE);
        Workspace workspaceTwo = generateWorkspace(WORKSPACE_TWO);
        String[] expectedDirs = new String[] {WORKSPACE_ONE, WORKSPACE_TWO};
        ArgumentCaptor<String> dirCaptor = ArgumentCaptor.forClass(String.class);

        // When
        cleaner.clear(workspaceOne);
        cleaner.clear(workspaceTwo);
        eventService.publish(serverIdleEvent);

        // Then
        verify(pvcHelper, times(1)).createJobPod(anyString(),
                                                 anyString(),
                                                 anyString(),
                                                 eq(OpenShiftPvcHelper.Command.REMOVE),
                                                 dirCaptor.capture(), // Varargs capture doesn't seem to work.
                                                 dirCaptor.capture());

        List<String> dirs = dirCaptor.getAllValues();
        String[] actualDirs = dirs.toArray(new String[dirs.size()]);
        // Sort arrays to ignore order
        Arrays.sort(actualDirs);
        Arrays.sort(expectedDirs);
        assertEquals(actualDirs, expectedDirs, "Expected all dirs to be deleted when server is idled.");
    }

