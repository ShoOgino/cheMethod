  @Test
  public void shouldRetainQueueIfDeletionFails() throws ServerException, IOException {
    // Given
    Workspace workspaceOne = generateWorkspace(WORKSPACE_ONE);
    when(pvcHelper.createJobPod(any(), any(), any(), any(), any())).thenReturn(false);

    // When
    cleaner.onEvent(new WorkspaceRemovedEvent(workspaceOne));
    cleaner.deleteWorkspacesInQueue();

    // Then
    verify(pvcHelper, times(1))
        .createJobPod(
            anyString(),
            anyString(),
            anyString(),
            eq(OpenShiftPvcHelper.Command.REMOVE),
            eq(WORKSPACE_ONE));

    // When
    cleaner.deleteWorkspacesInQueue();

    // Then
    verify(pvcHelper, times(2))
        .createJobPod(
            anyString(),
            anyString(),
            anyString(),
            eq(OpenShiftPvcHelper.Command.REMOVE),
            eq(WORKSPACE_ONE));
  }

