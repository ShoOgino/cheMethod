    @Override
    public void openFile(Location location, AsyncCallback<VirtualFile> callback) {
        VirtualFile activeFile = null;
        String activePath = null;
        final EditorPartPresenter activeEditor = editorAgent.getActiveEditor();
        if (activeEditor != null) {
            activeFile = editorAgent.getActiveEditor().getEditorInput().getFile();
            activePath = activeFile.getLocation().toString();
        }
        if (activePath != null && !activePath.equals(location.getTarget()) && !activePath.equals(location.getResourcePath())) {
            if (location.isExternalResource()) {
                openExternalResource(location, callback);
            } else {
                doOpenFile(location, callback);
            }
        } else {
            scrollEditorToExecutionPoint((TextEditor)activeEditor, location.getLineNumber());
            callback.onSuccess(activeFile);
        }
    }

