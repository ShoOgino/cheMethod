  @Override
  public void deleteBreakpoint(Location location) throws DebuggerException {
    final String target = location.getTarget();
    final String className =
        !target.endsWith(".java")
            ? target
            : languageServer.identifyFqnInResource(location.getTarget(), location.getLineNumber());

    final int lineNumber = location.getLineNumber();
    EventRequestManager requestManager = getEventManager();
    List<BreakpointRequest> snapshot = new ArrayList<>(requestManager.breakpointRequests());
    for (BreakpointRequest breakpointRequest : snapshot) {
      com.sun.jdi.Location jdiLocation = breakpointRequest.location();
      if (jdiLocation.declaringType().name().equals(className)
          && jdiLocation.lineNumber() == lineNumber) {
        requestManager.deleteEventRequest(breakpointRequest);
        LOG.debug("Delete breakpoint: {}", location);
      }
    }

    List<Breakpoint> defferedByClass = deferredBreakpoints.get(className);
    if (defferedByClass != null) {
      defferedByClass.removeIf(
          breakpoint -> {
            Location l = breakpoint.getLocation();
            return l.getLineNumber() == location.getLineNumber()
                && l.getTarget().equals(location.getTarget());
          });
    }
  }

