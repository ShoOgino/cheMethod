  /** Connects to process and starts debug. */
  public static JavaDebugger startJavaDebugger(
      Breakpoint breakpoint, BlockingQueue<DebuggerEvent> debuggerEvents) throws Exception {
    Map<String, String> connectionProperties =
        ImmutableMap.of("host", "localhost", "port", getProperty("debug.port"));

    JavaDebuggerFactory factory = new JavaDebuggerFactory();
    JavaDebugger debugger =
        (JavaDebugger) factory.create(connectionProperties, debuggerEvents::add);

    debugger.start(new StartActionImpl(singletonList(breakpoint)));

    return debugger;
  }

