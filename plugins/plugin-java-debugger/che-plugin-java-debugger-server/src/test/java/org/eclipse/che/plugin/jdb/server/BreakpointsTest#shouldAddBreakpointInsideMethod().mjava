  @Test
  public void shouldAddBreakpointInsideMethod() throws Exception {
    Location location = new LocationImpl("/test/src/org/eclipse/BreakpointsTest.java", 36, "/test");

    try {
      debugger.addBreakpoint(new BreakpointImpl(location, false, null));
    } catch (DebuggerException e) {
      // class might not be loaded yet
    }

    debugger.resume(new ResumeActionImpl());

    DebuggerEvent debuggerEvent = events.take();
    assertTrue(debuggerEvent instanceof BreakpointActivatedEvent);

    Breakpoint actualBreakpoint = ((BreakpointActivatedEvent) debuggerEvent).getBreakpoint();
    Location actualLocation = actualBreakpoint.getLocation();
    assertEquals(actualLocation.getLineNumber(), 36);
    assertEquals(actualLocation.getTarget(), "/test/src/org/eclipse/BreakpointsTest.java");
    assertTrue(actualBreakpoint.isEnabled());

    debuggerEvent = events.take();
    assertTrue(debuggerEvent instanceof SuspendEvent);

    Location suspendLocation = ((SuspendEvent) debuggerEvent).getLocation();
    assertEquals(suspendLocation.getLineNumber(), 36);
    assertEquals(actualLocation.getTarget(), "/test/src/org/eclipse/BreakpointsTest.java");
  }

