    @Override
    public EncryptResult encryptText(final String textToEncrypt) throws EncryptException {
        byte[] ivBlob;
        byte[] cipherBlob;
        try {
            final SecretKey secret = generateSecret();

            final Cipher cipher = Cipher.getInstance(this.transformation);
            cipher.init(Cipher.ENCRYPT_MODE, secret);

            final AlgorithmParameters params = cipher.getParameters();
            ivBlob = params.getParameterSpec(IvParameterSpec.class).getIV();
            cipherBlob = cipher.doFinal(textToEncrypt.getBytes("UTF-8"));
        } catch (final InvalidKeyException | NoSuchAlgorithmException | InvalidKeySpecException | NoSuchPaddingException
            | InvalidParameterSpecException | IllegalBlockSizeException | BadPaddingException | UnsupportedEncodingException e) {
            throw new EncryptException(e);
        }

        final String cipherText = Base64.encodeBase64String(cipherBlob);
        final String ivText = Base64.encodeBase64String(ivBlob);

        return new EncryptResult(cipherText, ivText);
    }

