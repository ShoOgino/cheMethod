    @Override
    public Promise<CLIOutputWithRevisionResponse> update(Path project,
                                                         Path[] paths,
                                                         String revision,
                                                         String depth,
                                                         boolean ignoreExternals,
                                                         String accept,
                                                         Credentials credentials) {
        final UpdateRequest request =
                dtoFactory.createDto(UpdateRequest.class)
                          .withProjectPath(project.toString())
                          .withPaths(toList(paths))
                          .withRevision(revision)
                          .withDepth(depth)
                          .withIgnoreExternals(ignoreExternals)
                          .withAccept(accept);
        if (credentials != null) {
            request.setUsername(credentials.getUsername());
            request.setPassword(credentials.getPassword());
        }

        return asyncRequestFactory.createPostRequest(getBaseUrl() + "/update", request)
                                  .loader(loader)
                                  .send(dtoUnmarshallerFactory.newUnmarshaller(CLIOutputWithRevisionResponse.class));
    }

