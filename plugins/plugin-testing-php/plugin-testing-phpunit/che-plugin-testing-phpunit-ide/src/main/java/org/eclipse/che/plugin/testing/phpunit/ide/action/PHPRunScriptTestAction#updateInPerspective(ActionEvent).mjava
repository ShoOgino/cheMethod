  @Override
  public void updateInPerspective(ActionEvent e) {
    if ((appContext.getRootProject() == null)) {
      e.getPresentation().setVisible(true);
      e.getPresentation().setEnabled(false);
      return;
    }
    final Selection<?> selection = selectionAgent.getSelection();
    if (selection == null || selection.isEmpty()) {
      e.getPresentation().setEnabled(false);
      return;
    }
    if (selection.isMultiSelection()) {
      e.getPresentation().setEnabled(false);
      return;
    }
    final Object possibleNode = selection.getHeadElement();
    boolean enable = false;
    if (possibleNode instanceof FileNode) {
      FileNode fileNode = (FileNode) possibleNode;
      File data = fileNode.getData();
      String extension = data.getExtension();
      if ("php".equals(extension) || "phtml".equals(extension)) {
        enable = true;
        selectedNodePath = data.getLocation().toString();
      }
    }

    e.getPresentation().setEnabled(enable);
    e.getPresentation().setVisible(enable);
  }

