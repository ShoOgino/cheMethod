  /** Is invoked when test or configuration is finished. */
  private void onTestFinish(ITestResult result) {
    if (result.getStatus() == ITestResult.FAILURE || result.getStatus() == ITestResult.SKIP) {
      String invocationLabel = "";
      if (result.getMethod().getCurrentInvocationCount() > 1) {
        invocationLabel = format(" (run %d)", result.getMethod().getCurrentInvocationCount());
      }

      if (result.getThrowable() != null) {
        LOG.error(
            "Test {}.{}{} failed. Error: {}",
            result.getTestClass().getRealClass().getSimpleName(),
            result.getMethod().getMethodName(),
            invocationLabel,
            result.getThrowable().getLocalizedMessage());
        LOG.debug(result.getThrowable().getLocalizedMessage(), result.getThrowable());
      } else {
        LOG.error(
            "Test {}.{}{} failed without exception.",
            result.getTestClass().getRealClass().getSimpleName(),
            result.getMethod().getMethodName(),
            invocationLabel);
      }

      captureScreenshot(result);
      captureHtmlSource(result);
      captureTestWorkspaceLogs(result);
      storeWebDriverLogs(result);
    }
  }

