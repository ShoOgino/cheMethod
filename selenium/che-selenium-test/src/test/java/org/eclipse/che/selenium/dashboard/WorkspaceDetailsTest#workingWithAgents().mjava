  @Test
  public void workingWithAgents() {
    dashboardWorkspace.selectTabInWorspaceMenu(TabNames.AGENTS);

    //check all needed agents in dev-machine exist
    dashboardWorkspace.selectMachine("Workspace Agents", "dev-machine");
    agents.forEach(
        (name, value) -> {
          dashboardWorkspace.checkAgentExists(name);
        });

    //switch all agents and save changes
    agents.forEach(
        (name, value) -> {
          Assert.assertEquals(dashboardWorkspace.getAgentState(name), value);
          dashboardWorkspace.switchAgentState(name);
          WaitUtils.sleepQuietly(1);
        });
    clickOnSaveButton();

    //switch all agents, save changes and check its states are as previous(by default for the Java-MySql stack)
    agents.forEach(
        (name, value) -> {
          dashboardWorkspace.switchAgentState(name);
          loader.waitOnClosed();
        });
    clickOnSaveButton();
    agents.forEach(
        (name, value) -> {
          Assert.assertEquals(dashboardWorkspace.getAgentState(name), value);
        });
  }

