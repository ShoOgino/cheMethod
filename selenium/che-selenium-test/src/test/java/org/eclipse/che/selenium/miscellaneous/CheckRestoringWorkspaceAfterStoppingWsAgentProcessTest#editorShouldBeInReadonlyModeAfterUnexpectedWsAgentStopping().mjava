  @Test
  public void editorShouldBeInReadonlyModeAfterUnexpectedWsAgentStopping() throws Exception {
    goToFileAndCheckText();

    // execute kill ws agent command
    projectExplorer.invokeCommandWithContextMenu(
        COMMON_GOAL, PROJECT_NAME, nameCommandForKillWsAgent);

    // check that ws agent has stopped and current editor tab is displayed
    notificationsPopupPanel.waitExpectedMessageOnProgressPanelAndClose(
        EXPECTED_POPUP_MESSAGE, WAITING_NOTIFICATION_TIMEOUT_IN_SEC);
    toastLoader.waitToastLoaderIsOpen();
    toastLoader.waitExpectedTextInToastLoader("Workspace agent is not running");
    editor.waitTabIsPresent(FILE_NAME);
    editor.waitTextIntoEditor(EXPECTED_EDITOR_TEXT);

    // check that editor is in read only mode
    editor.waitActive();
    editor.typeTextIntoEditor(TEXT_FOR_TYPING);
    editor.waitTextIntoEditor(EXPECTED_EDITOR_TEXT);

    // check ws agent restoring
    toastLoader.clickOnToastLoaderButton("Restart");
    toastLoader.waitExpectedTextInToastLoader("Starting workspace runtime...");
    waitWorkspaceRunningStatus();
    goToFileAndCheckText();
    editor.waitActive();
    editor.typeTextIntoEditor(TEXT_FOR_TYPING);
    editor.waitTextIntoEditor(TEXT_FOR_TYPING);
  }

