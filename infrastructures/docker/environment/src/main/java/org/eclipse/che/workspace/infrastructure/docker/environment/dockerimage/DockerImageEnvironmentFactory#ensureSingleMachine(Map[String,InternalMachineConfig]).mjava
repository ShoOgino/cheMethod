  private void ensureSingleMachine(Map<String, InternalMachineConfig> machines)
      throws ValidationException {
    int nofMachines = machines.size();
    if (nofMachines == 0) {
      // we create a "fake" machine definition where the rest of the code can put additional
      // definitions, if needed.
      InternalMachineConfig emptyConfig = new InternalMachineConfig();
      // let's just call the machine after the type. The name doesn't matter that much anyway.
      machines.put(DockerImageEnvironment.TYPE, emptyConfig);
    } else if (nofMachines > 1) {
      throw new ValidationException(
          format(
              "Docker image environment only supports a single machine definition but found %d.",
              nofMachines));
    }
  }

