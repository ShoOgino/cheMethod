  @Override
  protected DockerImageEnvironment doCreate(
      @Nullable InternalRecipe recipe,
      Map<String, InternalMachineConfig> machines,
      List<Warning> warnings)
      throws ValidationException {
    checkNotNull(recipe, "Null recipe is not supported by docker image environment factory");
    if (!DockerImageEnvironment.TYPE.equals(recipe.getType())) {
      throw new ValidationException(
          format(
              "Docker image environment parser doesn't support recipe type '%s'",
              recipe.getType()));
    }

    String dockerImage = recipe.getContent();

    checkArgument(dockerImage != null, "Docker image should not be null.");

    ensureSingleMachine(machines);

    addRamAttributes(machines);

    return new DockerImageEnvironment(dockerImage, recipe, machines, warnings);
  }

