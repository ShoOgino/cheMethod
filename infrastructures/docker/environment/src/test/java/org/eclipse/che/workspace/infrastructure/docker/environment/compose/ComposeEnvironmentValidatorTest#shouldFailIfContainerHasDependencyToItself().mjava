  @Test(
      expectedExceptions = ValidationException.class,
      expectedExceptionsMessageRegExp = "Container '.*' has illegal dependency to itself")
  public void shouldFailIfContainerHasDependencyToItself() throws Exception {
    // given
    when(service.getDependsOn()).thenReturn(singletonList(MACHINE_NAME));

    // when
    composeEnvironmentValidator.validate(composeEnv);
  }

