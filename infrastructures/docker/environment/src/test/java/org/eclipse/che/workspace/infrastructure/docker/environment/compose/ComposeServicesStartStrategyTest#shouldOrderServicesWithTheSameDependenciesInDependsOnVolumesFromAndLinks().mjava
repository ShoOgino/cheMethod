  @Test
  public void shouldOrderServicesWithTheSameDependenciesInDependsOnVolumesFromAndLinks()
      throws Exception {
    // given
    Map<String, ComposeService> services = new HashMap<>();
    services.put(
        "second",
        new ComposeService()
            .withVolumesFrom(singletonList("first"))
            .withDependsOn(singletonList("first"))
            .withLinks(singletonList("first:alias")));
    services.put(
        "third",
        new ComposeService()
            .withVolumesFrom(asList("first", "second"))
            .withDependsOn(asList("first", "second"))
            .withLinks(asList("first", "second")));
    services.put("first", new ComposeService());
    services.put(
        "forth",
        new ComposeService()
            .withVolumesFrom(singletonList("third"))
            .withDependsOn(singletonList("third"))
            .withLinks(singletonList("third")));
    services.put(
        "fifth",
        new ComposeService()
            .withVolumesFrom(asList("forth", "first"))
            .withDependsOn(asList("forth", "first"))
            .withLinks(asList("forth:alias", "first")));
    String[] expected = new String[] {"first", "second", "third", "forth", "fifth"};

    // when
    Map<String, ComposeService> actual = strategy.order(services);

    // then
    assertEquals(actual.keySet().toArray(), expected);
  }

