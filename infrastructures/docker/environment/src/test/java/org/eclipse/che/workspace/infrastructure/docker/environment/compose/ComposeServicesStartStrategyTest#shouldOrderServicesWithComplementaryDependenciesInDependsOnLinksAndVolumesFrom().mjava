  @Test
  public void shouldOrderServicesWithComplementaryDependenciesInDependsOnLinksAndVolumesFrom()
      throws Exception {
    // given
    Map<String, ComposeService> services = new HashMap<>();
    services.put("second", new ComposeService().withVolumesFrom(singletonList("first")));
    services.put(
        "third",
        new ComposeService()
            .withVolumesFrom(singletonList("second"))
            .withDependsOn(singletonList("first")));
    services.put("first", new ComposeService());
    services.put(
        "forth",
        new ComposeService()
            .withVolumesFrom(singletonList("third"))
            .withDependsOn(singletonList("second"))
            .withLinks(singletonList("first:alias")));
    services.put(
        "fifth",
        new ComposeService()
            .withVolumesFrom(singletonList("first"))
            .withLinks(singletonList("forth"))
            .withDependsOn(singletonList("second")));
    String[] expected = new String[] {"first", "second", "third", "forth", "fifth"};

    // when
    Map<String, ComposeService> actual = strategy.order(services);

    // then
    assertEquals(actual.keySet().toArray(), expected);
  }

