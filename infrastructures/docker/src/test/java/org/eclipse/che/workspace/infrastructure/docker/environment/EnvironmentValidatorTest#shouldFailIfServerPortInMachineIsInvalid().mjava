  @Test(
    expectedExceptions = ValidationException.class,
    expectedExceptionsMessageRegExp =
        "Machine '.*' in environment contains server conf '.*' with invalid port '.*'"
  )
  public void shouldFailIfServerPortInMachineIsInvalid() throws Exception {
    // given
    when(server.getPort()).thenReturn("aaaaa");
    when(machineConfig.getServers())
        .thenReturn(singletonMap(Constants.SERVER_WS_AGENT_HTTP_REFERENCE, server));

    // when
    environmentValidator.validate(environment, dockerEnvironment);
  }

