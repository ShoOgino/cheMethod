    @Test(expectedExceptions = InfrastructureException.class)
    public void throwsExceptionWhenBootstrappingOfInstallersFailed() throws Exception {
        mockInstallersBootstrapFailed(new InfrastructureException("bootstrap failed"));
        mockContainerStart();
        try {
            dockerRuntime.start(emptyMap());
        } catch (InfrastructureException ex) {
            verify(starter, times(1)).startContainer(anyString(), anyString(), any(), any(), anyBoolean(), any());
            verify(bootstrapper, times(1)).bootstrap();
            verify(eventService, times(3)).publish(any(MachineStatusEvent.class));
            verifyEventsOrder(newEvent(DEV_MACHINE, STARTING, null),
                              newEvent(DEV_MACHINE, FAILED, "bootstrap failed"),
                              newEvent(DEV_MACHINE, STOPPED, null));
            throw ex;
        }
    }

