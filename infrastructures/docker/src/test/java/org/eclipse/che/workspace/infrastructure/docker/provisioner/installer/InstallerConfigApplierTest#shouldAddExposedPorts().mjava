  @Test
  public void shouldAddExposedPorts() throws Exception {
    final ServerConfig serverConf1 = mock(ServerConfig.class);
    final ServerConfig serverConfig = mock(ServerConfig.class);
    when(serverConf1.getPort()).thenReturn("1111/udp");
    when(serverConfig.getPort()).thenReturn("2222/tcp");

    when(installerRegistry.getOrderedInstallers(any()))
        .thenReturn(asList(installer1, installer2, installer3));
    when(installer1.getServers()).thenAnswer(invocation -> singletonMap("a", serverConf1));
    when(installer2.getServers()).thenAnswer(invocation -> singletonMap("b", serverConfig));
    when(installer3.getServers()).thenReturn(emptyMap());
    DockerContainerConfig service = new DockerContainerConfig();

    installerConfigApplier.apply(
        new MachineConfigImpl(
            asList("installer1", "installer2", "installer3"), emptyMap(), emptyMap()),
        service);

    List<String> exposedPorts = service.getExpose();
    assertTrue(exposedPorts.contains("1111/udp"));
    assertTrue(exposedPorts.contains("2222/tcp"));
  }

