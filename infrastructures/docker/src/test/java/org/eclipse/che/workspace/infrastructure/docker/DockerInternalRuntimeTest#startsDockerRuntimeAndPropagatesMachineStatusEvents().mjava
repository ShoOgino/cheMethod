  @Test
  public void startsDockerRuntimeAndPropagatesMachineStatusEvents() throws Exception {
    mockInstallersBootstrap();
    mockContainerStart();
    dockerRuntime.start(emptyMap());

    verify(starter, times(2)).startContainer(anyString(), anyString(), any(), any(), any());
    verify(eventService, times(4)).publish(any(MachineStatusEvent.class));
    verifyEventsOrder(
        newEvent(DEV_MACHINE, STARTING, null),
        newEvent(DEV_MACHINE, RUNNING, null),
        newEvent(DB_MACHINE, STARTING, null),
        newEvent(DB_MACHINE, RUNNING, null));
  }

