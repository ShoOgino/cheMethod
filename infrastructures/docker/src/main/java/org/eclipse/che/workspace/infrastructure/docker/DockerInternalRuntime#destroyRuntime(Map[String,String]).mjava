    private void destroyRuntime(Map<String, String> stopOptions) throws InfrastructureException {
        if (stopOptions != null && "true".equals(stopOptions.get("create-snapshot"))) {
            snapshotMachines(startSynchronizer.removeMachines());
        } else {
            for (Map.Entry<String, DockerMachine> dockerMachineEntry : startSynchronizer.removeMachines().entrySet()) {
                try {
                    dockerMachineEntry.getValue().destroy();
                    eventService.publish(DtoFactory.newDto(MachineStatusEvent.class)
                                                   .withIdentity(DtoConverter.asDto(identity))
                                                   .withEventType(MachineStatus.STOPPED)
                                                   .withMachineName(dockerMachineEntry.getKey()));
                } catch (InfrastructureException e) {
                    LOG.error(format("Error occurs on destroying of docker machine '%s' in workspace '%s'. Container '%s'",
                                     dockerMachineEntry.getKey(),
                                     getContext().getIdentity().getWorkspaceId(),
                                     dockerMachineEntry.getValue().getContainer()),
                              e);
                }
            }
        }
        // TODO what happens when context throws exception here
        dockerNetworkLifecycle.destroyNetwork(dockerEnvironment.getNetwork());
    }

