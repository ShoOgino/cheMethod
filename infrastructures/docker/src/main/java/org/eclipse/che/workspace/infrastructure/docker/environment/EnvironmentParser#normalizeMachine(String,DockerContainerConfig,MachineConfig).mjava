    private void normalizeMachine(String name, DockerContainerConfig container, MachineConfig machineConfig)
            throws ValidationException {
        if (machineConfig.getAttributes().containsKey("memoryLimitBytes")) {
            try {
                container.setMemLimit(Long.parseLong(machineConfig.getAttributes().get("memoryLimitBytes")));
            } catch (NumberFormatException e) {
                throw new ValidationException(
                        format("Value of attribute 'memoryLimitBytes' of machine '%s' is illegal", name));
            }
        }
        container.setExpose(container.getExpose()
                                     .stream()
                                     .map(expose -> expose.contains("/") ?
                                                expose :
                                                expose + "/tcp")
                                     .collect(toList()));
        machineConfig.getServers().forEach((serverRef, serverConf) -> {
            String normalizedPort = serverConf.getPort().contains("/") ?
                                    serverConf.getPort() :
                                    serverConf.getPort() + "/tcp";

            container.getExpose().add(normalizedPort);

            String portLabelPrefix = SERVER_CONF_LABEL_PREFIX + normalizedPort;

            container.getLabels().put(portLabelPrefix +
                                      SERVER_CONF_LABEL_REF_SUFFIX,
                                      serverRef);
            if (serverConf.getPath() != null) {
                container.getLabels().put(portLabelPrefix +
                                          SERVER_CONF_LABEL_PATH_SUFFIX,
                                          serverConf.getPath());
            }
            if (serverConf.getProtocol() != null) {
                container.getLabels().put(portLabelPrefix +
                                          SERVER_CONF_LABEL_PROTOCOL_SUFFIX,
                                          serverConf.getProtocol());
            }
        });
    }

