    private void addSystemWideContainerSettings(String workspaceId,
                                                boolean isDev,
                                                DockerService composeService) throws IOException {
        List<String> portsToExpose;
        List<String> volumes;
        Map<String, String> env;
        if (isDev) {
            portsToExpose = devMachinePortsToExpose;
            volumes = devMachineSystemVolumes;

            env = new HashMap<>(devMachineEnvVariables);
            env.put(DockerInstanceRuntimeInfo.CHE_WORKSPACE_ID, workspaceId);
            env.put(DockerInstanceRuntimeInfo.USER_TOKEN, getUserToken(workspaceId));
        } else {
            portsToExpose = commonMachinePortsToExpose;
            env = commonMachineEnvVariables;
            volumes = commonMachineSystemVolumes;
        }
        composeService.getExpose().addAll(portsToExpose);
        composeService.getEnvironment().putAll(env);
        composeService.getVolumes().addAll(volumes);
        composeService.getNetworks().addAll(additionalNetworks);
    }

