    @Inject
    public MachineStarter(DockerConnector docker,
                          UserSpecificDockerRegistryCredentialsProvider dockerCredentials,
                          DockerMachineStopDetector dockerMachineStopDetector,
                          @Named("machine.docker.dev_machine.machine_servers") Set<ServerConfig> devMachineServers,
                          @Named("machine.docker.machine_servers") Set<ServerConfig> allMachinesServers,
                          @Named("machine.docker.dev_machine.machine_volumes") Set<String> devMachineSystemVolumes,
                          @Named("machine.docker.machine_volumes") Set<String> allMachinesSystemVolumes,
                          @Named("che.docker.always_pull_image") boolean doForcePullOnBuild,
                          @Named("che.docker.privileged") boolean privilegedMode,
                          @Named("che.docker.pids_limit") int pidsLimit,
                          @Named("machine.docker.dev_machine.machine_env") Set<String> devMachineEnvVariables,
                          @Named("machine.docker.machine_env") Set<String> allMachinesEnvVariables,
                          @Named("che.docker.registry_for_snapshots") boolean snapshotUseRegistry,
                          @Named("che.docker.swap") double memorySwapMultiplier,
                          @Named("machine.docker.networks") Set<Set<String>> additionalNetworks,
                          @Nullable @Named("che.docker.parent_cgroup") String parentCgroup,
                          @Nullable @Named("che.docker.cpuset_cpus") String cpusetCpus,
                          @Named("che.docker.cpu_period") long cpuPeriod,
                          @Named("che.docker.cpu_quota") long cpuQuota,
                          WindowsPathEscaper windowsPathEscaper,
                          @Named("che.docker.extra_hosts") Set<Set<String>> additionalHosts,
                          @Nullable @Named("che.docker.dns_resolvers") String[] dnsResolvers,
                          ServerEvaluationStrategyProvider serverEvaluationStrategyProvider,
                          @Named("che.docker.build_args") Map<String, String> buildArgs) {
        // TODO spi should we move all configuration stuff into infrastructure provisioner and left logic of container start here only
        this.docker = docker;
        this.dockerCredentials = dockerCredentials;
        this.dockerInstanceStopDetector = dockerMachineStopDetector;
        this.doForcePullOnBuild = doForcePullOnBuild;
        this.privilegedMode = privilegedMode;
        this.snapshotUseRegistry = snapshotUseRegistry;
        // use-cases:
        //  -1  enable unlimited swap
        //  0   disable swap
        //  0.5 enable swap with size equal to half of current memory size
        //  1   enable swap with size equal to current memory size
        //
        //  according to docker docs field  memorySwap should be equal to memory+swap
        //  we calculate this field as memorySwap=memory * (1 + multiplier) so we just add 1 to multiplier
        this.memorySwapMultiplier = memorySwapMultiplier == -1 ? -1 : memorySwapMultiplier + 1;
        this.parentCgroup = parentCgroup;
        this.cpusetCpus = cpusetCpus;
        this.cpuPeriod = cpuPeriod;
        this.cpuQuota = cpuQuota;
        this.windowsPathEscaper = windowsPathEscaper;
        this.pidsLimit = pidsLimit;
        this.dnsResolvers = dnsResolvers;
        this.buildArgs = buildArgs;
        this.serverEvaluationStrategyProvider = serverEvaluationStrategyProvider;

        allMachinesSystemVolumes = removeEmptyAndNullValues(allMachinesSystemVolumes);
        devMachineSystemVolumes = removeEmptyAndNullValues(devMachineSystemVolumes);

        allMachinesSystemVolumes = allMachinesSystemVolumes.stream()
                                                           .map(line -> line.split(";"))
                                                           .flatMap(Arrays::stream)
                                                           .distinct()
                                                           .collect(toSet());

        devMachineSystemVolumes = devMachineSystemVolumes.stream()
                                                         .map(line -> line.split(";"))
                                                         .flatMap(Arrays::stream)
                                                         .distinct()
                                                         .collect(toSet());

        if (SystemInfo.isWindows()) {
            allMachinesSystemVolumes = escapePaths(allMachinesSystemVolumes);
            devMachineSystemVolumes = escapePaths(devMachineSystemVolumes);
        }
        this.commonMachineSystemVolumes = new ArrayList<>(allMachinesSystemVolumes);
        List<String> devMachineVolumes = new ArrayList<>(allMachinesSystemVolumes.size()
                                                         + devMachineSystemVolumes.size());
        devMachineVolumes.addAll(allMachinesSystemVolumes);
        devMachineVolumes.addAll(devMachineSystemVolumes);
        this.devMachineSystemVolumes = devMachineVolumes;

        this.devMachinePortsToExpose = new ArrayList<>(allMachinesServers.size() + devMachineServers.size());
        this.commonMachinePortsToExpose = new ArrayList<>(allMachinesServers.size());
        for (ServerConfig serverConf : devMachineServers) {
            devMachinePortsToExpose.add(serverConf.getPort());
        }
        for (ServerConfig serverConf : allMachinesServers) {
            commonMachinePortsToExpose.add(serverConf.getPort());
            devMachinePortsToExpose.add(serverConf.getPort());
        }

        allMachinesEnvVariables = removeEmptyAndNullValues(allMachinesEnvVariables);
        devMachineEnvVariables = removeEmptyAndNullValues(devMachineEnvVariables);
        this.commonMachineEnvVariables = new HashMap<>();
        this.devMachineEnvVariables = new HashMap<>();
        allMachinesEnvVariables.forEach(envVar -> {
            String[] split = envVar.split("=", 2);
            this.commonMachineEnvVariables.put(split[0], split[1]);
            this.devMachineEnvVariables.put(split[0], split[1]);
        });
        devMachineEnvVariables.forEach(envVar -> {
            String[] split = envVar.split("=", 2);
            this.devMachineEnvVariables.put(split[0], split[1]);
        });

        this.allMachinesExtraHosts = additionalHosts.stream()
                                                    .flatMap(Set::stream)
                                                    .toArray(String[]::new);

        this.additionalNetworks = additionalNetworks.stream()
                                                    .flatMap(Set::stream)
                                                    .collect(toSet());

        // TODO spi fix in #5102
        // single point of failure in case of highly loaded system
        /*executor = Executors.newCachedThreadPool(new ThreadFactoryBuilder().setNameFormat("MachineLogsStreamer-%d")
                                                                           .setUncaughtExceptionHandler(
                                                                                   LoggingUncaughtExceptionHandler
                                                                                           .getInstance())
                                                                           .setDaemon(true)
                                                                           .build());*/
    }

