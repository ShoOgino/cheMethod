    @Override
    public void provision(Environment envConfig,
                          DockerEnvironment dockerEnvironment,
                          RuntimeIdentity runtimeIdentity) throws InfrastructureException {
        try {
            installerConfigApplier.apply(envConfig, dockerEnvironment);
        } catch (InstallerException e) {
            throw new InfrastructureException(e.getLocalizedMessage(), e);
        }

        for (Map.Entry<String, ? extends MachineConfig> entry : envConfig.getMachines().entrySet()) {
            String name = entry.getKey();
            DockerContainerConfig container = dockerEnvironment.getContainers().get(name);
            container.getLabels().putAll(Labels.newSerializer()
                                               .machineName(name)
                                               .runtimeId(runtimeIdentity)
                                               .servers(entry.getValue().getServers())
                                               .labels());
        }
    }

