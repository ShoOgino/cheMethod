  @Override
  public void provision(
      EnvironmentImpl envConfig, DockerEnvironment internalEnv, RuntimeIdentity identity)
      throws InfrastructureException {

    Map<String, String> envVars =
        providers
            .stream()
            .map(p -> p.get(identity))
            .filter(Objects::nonNull)
            .collect(Collectors.toMap(e -> e.first, e -> e.second));

    for (DockerContainerConfig containerConfig : internalEnv.getContainers().values()) {
      containerConfig.getEnvironment().putAll(envVars);
    }
  }

