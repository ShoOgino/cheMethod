  @BeforeMethod
  public void setUp() throws Exception {
    when(environment.getMachines()).thenReturn(singletonMap(MACHINE_NAME, machineConfig));
    when(dockerEnvironment.getContainers()).thenReturn(singletonMap(MACHINE_NAME, container));
    when(container.getImage()).thenReturn("test/image:latest");
    when(machineConfig.getInstallers()).thenReturn(singletonList(installer));
    when(installer.getId()).thenReturn(WsAgentMachineFinderUtil.WS_AGENT_INSTALLER);
    when(server.getPort()).thenReturn("8080/tcp");
    when(server.getPath()).thenReturn("/some/path");
    when(server.getProtocol()).thenReturn("https");
  }

