  @BeforeMethod
  public void setUp() throws Exception {
    when(environment.getRecipe()).thenReturn(recipe);
    when(environment.getMachines()).thenReturn(singletonMap(DEFAULT_MACHINE_NAME, machine));
    when(recipe.getType()).thenReturn("type1");
    when(recipe.getContent()).thenReturn(TEXT);
    when(envParser.parse(environment)).thenReturn(dockerEnv);
    when(dockerEnv.getContainers()).thenReturn(singletonMap(DEFAULT_MACHINE_NAME, containerConfig));

    parser =
        new EnvironmentParser(
            ImmutableMap.of(
                "type1", envParser,
                "type2", envParser,
                "type3", envParser));
  }

