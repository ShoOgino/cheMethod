  @Test
  public void shouldPerformMigrationOnSingleWorkspace() throws Exception {
    List<WorkspaceImpl> workspaces = createWorkspaces(1, "oldWorkspace", true);
    when(workspaceDao.getWorkspaces(anyBoolean(), anyInt(), anyLong()))
        .thenReturn(new Page<>(workspaces, 0, 1, 1));

    localProjectsMigrator.performMigration(workspacesRoot);

    Path oldWorkspacePath =
        Paths.get(workspacesRoot).resolve(WS_NAME_PREFIX + "ws_name_oldWorkspace1");
    Path newWorkspacePath = Paths.get(workspacesRoot).resolve(WS_ID_PREFIX + "oldWorkspace1");

    assertFalse(Files.exists(oldWorkspacePath));
    assertTrue(Files.exists(newWorkspacePath));
  }

