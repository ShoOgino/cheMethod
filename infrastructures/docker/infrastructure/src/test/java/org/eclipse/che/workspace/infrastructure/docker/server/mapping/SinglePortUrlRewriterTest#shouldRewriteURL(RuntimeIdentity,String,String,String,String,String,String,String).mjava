  @Test(dataProvider = "urlRewritingTestProvider")
  public void shouldRewriteURL(
      RuntimeIdentity identity,
      String externalIP,
      String internalIp,
      String machineName,
      String serverName,
      String nioHost,
      String incomeURL,
      String expectedURL)
      throws Exception {
    Provider<SinglePortHostnameBuilder> provider =
        () -> new SinglePortHostnameBuilder(externalIP, internalIp, nioHost);
    SinglePortUrlRewriter rewriter = new SinglePortUrlRewriter(8080, provider);

    String rewrittenURL = rewriter.rewriteURL(identity, machineName, serverName, incomeURL);

    assertEquals(rewrittenURL, expectedURL);
  }

