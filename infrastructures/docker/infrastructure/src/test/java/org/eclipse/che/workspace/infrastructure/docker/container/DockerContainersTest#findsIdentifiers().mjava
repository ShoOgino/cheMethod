  @Test
  public void findsIdentifiers() throws Exception {
    RuntimeIdentity id1 = new RuntimeIdentityImpl("workspace123", "default", "test", "id");
    RuntimeIdentity id2 = new RuntimeIdentityImpl("workspace234", "default", "test", "id");

    List<ContainerListEntry> entries =
        asList(mockContainer(id1, "container1"), mockContainer(id2, "container2"));
    when(docker.listContainers(anyObject())).thenReturn(entries);

    assertEquals(containers.findIdentities(), newHashSet(id1, id2));

    ArgumentCaptor<ListContainersParams> paramsCaptor =
        ArgumentCaptor.forClass(ListContainersParams.class);
    verify(docker).listContainers(paramsCaptor.capture());
    ListContainersParams params = paramsCaptor.getValue();
    assertEquals(
        new HashSet<>(params.getFilters().getFilter("label")),
        Sets.newHashSet(
            Labels.LABEL_WORKSPACE_ID, Labels.LABEL_WORKSPACE_ENV, Labels.LABEL_WORKSPACE_OWNER));
  }

