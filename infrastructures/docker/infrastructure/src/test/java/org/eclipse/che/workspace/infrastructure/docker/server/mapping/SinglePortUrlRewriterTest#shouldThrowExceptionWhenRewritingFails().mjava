  @Test(
    expectedExceptions = InternalInfrastructureException.class,
    expectedExceptionsMessageRegExp =
        "Rewriting of host 'server.machine1.ws123.172.12.0.2.nip.io' in URL ':' failed. Error: .*"
  )
  public void shouldThrowExceptionWhenRewritingFails() throws Exception {
    SinglePortUrlRewriter rewriter =
        new SinglePortUrlRewriter("127.0.0.1", 8080, "172.12.0.2", null, null);
    rewriter.rewriteURL(new RuntimeIdentityImpl("ws123", null, null), "machine1", "server", ":");
  }

