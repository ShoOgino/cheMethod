  @Test
  public void shouldNotAddNeitherExtConfVolumeNorEnvVarIfMachineDoesNotHaveServerButHasInstaller()
      throws Exception {
    // given
    DockerEnvironment expectedDockerEnv = new DockerEnvironment(dockerEnv);
    envConfig = createEnvironment(MACHINE_1_NAME, MACHINE_2_NAME, MACHINE_1_NAME);
    InternalMachineConfig machine = envConfig.getMachines().get(MACHINE_1_NAME);
    when(machine.getServers())
        .thenReturn(singletonMap(Constants.SERVER_WS_AGENT_HTTP_REFERENCE, new ServerConfigImpl()));

    // when
    provisioner.provision(envConfig, dockerEnv, RUNTIME_IDENTITY);

    // then
    assertEquals(dockerEnv, expectedDockerEnv);
  }

