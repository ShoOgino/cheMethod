  @Test
  void shouldPullAllImages() throws Throwable {
    DockerContainerConfig config1 =
        new DockerContainerConfig().setContainerName("container1").setImage("ubuntu/jdk8");
    DockerContainerConfig config2 =
        new DockerContainerConfig().setContainerName("container2").setImage("ubuntu/jdk9");

    Map<String, DockerContainerConfig> input = new HashMap<>();
    input.put("machine1", config1);
    input.put("machine2", config2);
    when(dockerConnector.listImages(any())).thenReturn(Collections.emptyList());
    Map<String, String> result = dockerImagesBuilder.prepareImages(input);

    verify(dockerConnector, times(input.size())).pull(any(), any());
    verify(dockerConnector, times(input.size())).tag(any());
    assertEquals(result.size(), input.size());
    assertTrue(result.keySet().containsAll(input.keySet()));
    assertTrue(result.values().contains("eclipse-che/" + config1.getContainerName()));
    assertTrue(result.values().contains("eclipse-che/" + config2.getContainerName()));
  }

