  @Test
  public void shouldAddExtConfVolumeAndEnvVarWhenVolumeProviderReturnsNotNullValue()
      throws Exception {
    // given
    String volumeValue = "/host/path:/container/path";
    when(extConfBindingProvider.get()).thenReturn(volumeValue);
    provisioner = new WsAgentServerConfigProvisioner(extConfBindingProvider);

    DockerEnvironment expectedDockerEnv = new DockerEnvironment(dockerEnv);
    DockerContainerConfig expectedContainerConfig =
        expectedDockerEnv.getContainers().get(MACHINE_1_NAME);
    expectedContainerConfig
        .getEnvironment()
        .put(CheBootstrap.CHE_LOCAL_CONF_DIR, DockerExtConfBindingProvider.EXT_CHE_LOCAL_CONF_DIR);
    expectedContainerConfig.getVolumes().add(volumeValue);

    // when
    provisioner.provision(envConfig, dockerEnv, RUNTIME_IDENTITY);

    // then
    assertEquals(dockerEnv, expectedDockerEnv);
  }

