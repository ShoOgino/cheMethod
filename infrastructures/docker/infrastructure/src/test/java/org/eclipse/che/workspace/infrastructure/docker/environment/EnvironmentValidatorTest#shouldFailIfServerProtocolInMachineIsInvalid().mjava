  @Test(
    expectedExceptions = ValidationException.class,
    expectedExceptionsMessageRegExp =
        "Machine '.*' in environment contains server conf '.*' with invalid protocol '.*'"
  )
  public void shouldFailIfServerProtocolInMachineIsInvalid() throws Exception {
    // given
    when(machineConfig.getServers()).thenReturn(singletonMap("server1", server));
    when(server.getProtocol()).thenReturn("0");

    // when
    environmentValidator.validate(environment, dockerEnvironment);
  }

