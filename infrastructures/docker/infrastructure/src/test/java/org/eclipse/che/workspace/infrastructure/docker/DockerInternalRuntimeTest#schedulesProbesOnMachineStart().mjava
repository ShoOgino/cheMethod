  @Test
  public void schedulesProbesOnMachineStart() throws Exception {
    mockInstallersBootstrap();
    mockContainerStart();
    WorkspaceProbes m1Probes = mock(WorkspaceProbes.class);
    WorkspaceProbes m2Probes = mock(WorkspaceProbes.class);
    when(workspaceProbesFactory.getProbes(eq(IDENTITY.getWorkspaceId()), eq(DB_MACHINE), any()))
        .thenReturn(m1Probes);
    when(workspaceProbesFactory.getProbes(eq(IDENTITY.getWorkspaceId()), eq(DEV_MACHINE), any()))
        .thenReturn(m2Probes);

    dockerRuntime.start(emptyMap());

    verify(probesScheduler).schedule(eq(m1Probes), any());
    verify(probesScheduler).schedule(eq(m2Probes), any());
  }

