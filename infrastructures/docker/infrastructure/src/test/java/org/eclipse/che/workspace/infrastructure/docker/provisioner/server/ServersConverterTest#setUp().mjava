  @BeforeMethod
  public void setUp() throws Exception {
    when(dockerEnvironment.getContainers())
        .thenReturn(
            new LinkedHashMap<>(ImmutableMap.of("machine1", container1, "machine2", container2)));
    when(dockerEnvironment.getMachines())
        .thenReturn(ImmutableMap.of("machine1", machine1, "machine2", machine2));
    when(container1.getLabels()).thenReturn(container1Labels);
    when(container2.getLabels()).thenReturn(container2Labels);
    servers1 =
        ImmutableMap.of(
            "server1",
            new ServerConfigImpl("7800", "http", "/path", singletonMap("key", "value")),
            "server2",
            new ServerConfigImpl(
                "7979",
                "tcp",
                "",
                singletonMap(ServerConfig.INTERNAL_SERVER_ATTRIBUTE, Boolean.TRUE.toString())));
    servers2 = ImmutableMap.of("server3", new ServerConfigImpl("20000/udp", "udp", null, null));
    when(machine1.getServers()).thenReturn(servers1);
    when(machine2.getServers()).thenReturn(servers2);
    when(container1.getPorts()).thenReturn(ports1);
    when(container2.getPorts()).thenReturn(ports2);
  }

