  /**
   * Makes url from given binding, protocol and path.
   *
   * <p>Examples:
   *
   * <pre>
   * |------------------------------------------------------------------------|
   * | binding           | protocol | path    | url                           |
   * |------------------------------------------------------------------------|
   * | 4011/tcp -> 32011 | http     | /api    | http://hostname:32011/api     |
   * | 4012/tcp -> 32012 | wss      | connect | wss://hostname:32012/connect  |
   * | 4013     -> 32013 | https    |         | https://hostname:32013        |
   * | 4014/upd -> 32014 |          |         | upd://hostname:32014          |
   * | 4015     -> 32015 |          |         | tcp://hostname:32015          |
   * |------------------------------------------------------------------------|
   * </pre>
   */
  private String makeUrl(ContainerPort port, String protocol, String path, String hostname)
      throws InternalInfrastructureException {
    if (protocol == null) {
      if (port.getType() == null) {
        protocol = "tcp";
      } else {
        protocol = port.getType();
      }
    }

    // null -> "", "path" -> "/path"
    if (path == null) {
      path = "";
    } else if (!path.startsWith("/")) {
      path = '/' + path;
    }

    int serverPort = port.getPublicPort() != 0 ? port.getPublicPort() : port.getPrivatePort();

    try {
      return new URI(protocol, null, hostname, serverPort, path, null, null).toString();
    } catch (URISyntaxException e) {
      throw new InternalInfrastructureException(
          "Constructing of URI of server failed. Error: " + e.getLocalizedMessage());
    }
  }

