  private File createArchive(String filename, String content) throws InfrastructureException {
    Path bootstrapperConfTmp = null;
    try {
      bootstrapperConfTmp = Files.createTempDirectory(filename);
      Path configFile = bootstrapperConfTmp.resolve(filename);
      Files.copy(new ByteArrayInputStream(content.getBytes()), configFile);
      Path bootstrapperConfArchive = Files.createTempFile(filename, ".tar.gz");
      TarUtils.tarFiles(bootstrapperConfArchive.toFile(), configFile.toFile());
      return bootstrapperConfArchive.toFile();
    } catch (IOException e) {
      throw new InternalInfrastructureException(
          "Error occurred while injecting bootstrapping conf. " + e.getMessage(), e);
    } finally {
      if (bootstrapperConfTmp != null) {
        FileCleaner.addFile(bootstrapperConfTmp.toFile());
      }
    }
  }

