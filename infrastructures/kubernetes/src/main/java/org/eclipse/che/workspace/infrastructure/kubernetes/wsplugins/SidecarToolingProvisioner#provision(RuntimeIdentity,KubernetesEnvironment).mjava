  @Beta
  public void provision(RuntimeIdentity id, KubernetesEnvironment environment)
      throws InfrastructureException {

    Collection<PluginMeta> pluginsMeta = pluginMetaRetriever.get(environment.getAttributes());
    if (pluginsMeta.isEmpty()) {
      return;
    }

    String recipeType = environment.getRecipe().getType();
    ChePluginsApplier pluginsApplier = workspaceNextAppliers.get(recipeType);
    if (pluginsApplier == null) {
      throw new InfrastructureException(
          "Sidecar tooling configuration is not supported with recipe type " + recipeType);
    }

    List<ChePlugin> chePlugins = pluginBrokerManager.getTooling(id, pluginsMeta, environment);

    pluginsApplier.apply(environment, chePlugins);
  }

