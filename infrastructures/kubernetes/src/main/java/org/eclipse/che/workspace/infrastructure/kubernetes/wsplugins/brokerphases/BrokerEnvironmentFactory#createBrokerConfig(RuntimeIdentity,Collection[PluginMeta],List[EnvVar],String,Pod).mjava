  private BrokerConfig createBrokerConfig(
      RuntimeIdentity runtimeId,
      Collection<PluginMeta> pluginsMeta,
      List<EnvVar> envVars,
      String image,
      Pod pod) {

    BrokerConfig data = new BrokerConfig();
    data.configMapName = generateUniqueName(CONFIG_MAP_NAME_SUFFIX);
    data.configMapVolume = generateUniqueName(BROKER_VOLUME);
    data.configMap = newConfigMap(data.configMapName, pluginsMeta);
    data.container = newContainer(runtimeId, envVars, image, data.configMapVolume);
    data.machineName = Names.machineName(pod, data.container);
    data.machineConfig = new InternalMachineConfig();
    data.machineConfig.getVolumes().put(PLUGINS_VOLUME_NAME, new VolumeImpl().withPath("/plugins"));

    return data;
  }

