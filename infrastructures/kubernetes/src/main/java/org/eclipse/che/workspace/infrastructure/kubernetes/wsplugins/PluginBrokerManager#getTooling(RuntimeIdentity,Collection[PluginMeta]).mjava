  /**
   * Deploys Che plugin brokers in a workspace, receives result of theirs execution and returns
   * resolved workspace tooling or error of plugins brokering execution.
   *
   * <p>This API is in <b>Beta</b> and is subject to changes or removal.
   */
  @Beta
  public List<ChePlugin> getTooling(RuntimeIdentity runtimeID, Collection<PluginMeta> pluginsMeta)
      throws InfrastructureException {

    String workspaceId = runtimeID.getWorkspaceId();
    KubernetesNamespace kubernetesNamespace = factory.create(workspaceId);
    BrokersResult brokersResult = new BrokersResult();

    E brokerEnvironment = brokerEnvironmentFactory.create(pluginsMeta, runtimeID, brokersResult);
    environmentProvisioner.provision(brokerEnvironment, runtimeID);

    ListenBrokerEvents listenBrokerEvents = getListenEventPhase(workspaceId, brokersResult);
    PrepareStorage prepareStorage = getPrepareStoragePhase(workspaceId, brokerEnvironment);
    WaitBrokerResult waitBrokerResult = getWaitBrokerPhase(brokersResult);
    DeployBroker deployBroker =
        getDeployBrokerPhase(
            runtimeID.getWorkspaceId(), kubernetesNamespace, brokerEnvironment, brokersResult);

    listenBrokerEvents.then(prepareStorage).then(deployBroker).then(waitBrokerResult);

    return listenBrokerEvents.execute();
  }

