  /**
   * Returns true if the namespace is fully managed by Che (e.g. created, used and deleted), false
   * otherwise.
   */
  public boolean isManagingNamespace(String workspaceId) throws InfrastructureException {
    // the new logic is quite simple.
    boolean newLogic =
        defaultNamespaceName != null && defaultNamespaceName.contains(WORKSPACEID_PLACEHOLDER);

    // but we must follow the same logic as #evalNamespaceName - we need to make sure that the old
    // logic can't be used first...
    // empty legacy namespace name ~ <workspaceid>
    if (isNullOrEmpty(legacyNamespaceName)
        || legacyNamespaceName.contains(WORKSPACEID_PLACEHOLDER)) {

      // there's a chance of using the old logic - if the namespace exists, we're managing it.
      // if it doesn't, we're using the new logic.
      return checkNamespaceExists(
              resolveLegacyNamespaceName(EnvironmentContext.getCurrent().getSubject(), workspaceId))
          || newLogic;
    } else {
      // there's no way the namespace of the workspace is managed using the old logic. Let's just
      // use the result of the new logic.
      return newLogic;
    }
  }

