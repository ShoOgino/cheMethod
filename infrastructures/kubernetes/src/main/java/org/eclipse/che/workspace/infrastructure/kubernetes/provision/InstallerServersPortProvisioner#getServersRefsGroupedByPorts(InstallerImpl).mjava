  @VisibleForTesting
  Map<Integer, Collection<String>> getServersRefsGroupedByPorts(InstallerImpl installer) {
    Multimap<Integer, String> portToServerNames = ArrayListMultimap.create();

    for (Entry<String, ? extends ServerConfig> serverEntry : installer.getServers().entrySet()) {
      String serverName = serverEntry.getKey();
      ServerConfig serverConfig = serverEntry.getValue();

      Pair<Integer, String> portProtocol = getPortProtocol(serverConfig.getPort());

      portToServerNames.put(portProtocol.first, serverName);
    }

    return portToServerNames.asMap();
  }

