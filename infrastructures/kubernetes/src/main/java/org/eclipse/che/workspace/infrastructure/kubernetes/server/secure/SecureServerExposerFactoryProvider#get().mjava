  /**
   * Creates instance of {@link SecureServerExposerFactory} that will expose secure servers for
   * runtime with the specified runtime identity.
   */
  @Override
  public SecureServerExposerFactory<T> get() {
    if (!agentsAuthEnabled) {
      // return default secure server exposer because no need to protect servers with authentication
      return defaultSecureServersFactory;
    }

    SecureServerExposerFactory<T> serverExposerFactory = factories.get(serverExposer);
    if (serverExposerFactory == null) {
      throw new ConfigurationException(
          "Unknown secure servers exposer is configured '" + serverExposer + "'. ");
    }

    return serverExposerFactory;
  }

