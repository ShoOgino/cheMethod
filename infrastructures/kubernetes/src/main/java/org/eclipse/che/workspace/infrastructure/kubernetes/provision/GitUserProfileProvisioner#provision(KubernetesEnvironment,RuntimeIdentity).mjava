  @Override
  public void provision(KubernetesEnvironment k8sEnv, RuntimeIdentity identity)
      throws InfrastructureException {
    getPreferenceValue(PREFERENCES_KEY_FILTER)
        .ifPresent(
            preferenceJsonValue -> {
              Map<String, String> theiaPreferences = getMapFromJsonObject(preferenceJsonValue);

              getGlobalGitConfigFileContent(
                      theiaPreferences.get(GIT_USER_NAME_PROPERTY),
                      theiaPreferences.get(GIT_USER_EMAIL_PROPERTY))
                  .ifPresent(
                      gitConfigFileContent -> {
                        String gitConfigMapName =
                            identity.getWorkspaceId() + GIT_CONFIG_MAP_NAME_SUFFIX;

                        doProvisionGlobalGitConfig(gitConfigMapName, gitConfigFileContent, k8sEnv);
                      });
            });
  }

