  @Test
  public void
      testEvalNamespaceUsesLegacyNamespaceIfWorkspaceDoesntRecordNamespaceAndLegacyNamespaceExists()
          throws Exception {

    namespaceFactory =
        new KubernetesNamespaceFactory(
            "blabol-<userid>-<username>-<userid>-<username>--",
            "",
            "",
            "che-<userid>",
            false,
            clientFactory,
            userManager);

    WorkspaceImpl workspace = new WorkspaceImplBuilder().build();

    EnvironmentContext.getCurrent().setSubject(new SubjectImpl("JonDoe", "123", null, false));

    String namespace = namespaceFactory.getNamespaceName(workspace);

    assertEquals(namespace, "blabol-123-JonDoe-123-JonDoe--");
  }

