  @Test
  public void testDoNotRethrowExceptionWhenErrorOnCleanupOccurs() throws Exception {
    doAnswer(
            invocationOnMock -> {
              final EventSubscriber<WorkspaceRemovedEvent> argument =
                  invocationOnMock.getArgument(0);
              final WorkspaceRemovedEvent event = mock(WorkspaceRemovedEvent.class);
              final Workspace removed = mock(Workspace.class);
              when(event.getWorkspace()).thenReturn(removed);
              when(removed.getId()).thenReturn(WORKSPACE_ID);
              argument.onEvent(event);
              return invocationOnMock;
            })
        .when(eventService)
        .subscribe(any(), eq(WorkspaceRemovedEvent.class));
    doThrow(InfrastructureException.class).when(pvcStrategy).cleanup(WORKSPACE_ID);

    workspacePVCCleaner.subscribe(eventService);

    verify(pvcStrategy).cleanup(WORKSPACE_ID);
  }

