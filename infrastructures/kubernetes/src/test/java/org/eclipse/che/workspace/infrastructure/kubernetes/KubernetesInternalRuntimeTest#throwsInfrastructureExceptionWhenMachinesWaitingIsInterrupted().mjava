  @Test(
    expectedExceptions = RuntimeStartInterruptedException.class,
    expectedExceptionsMessageRegExp =
        "Runtime start for identity 'workspace: workspace123, "
            + "environment: env1, ownerId: id1' is interrupted"
  )
  public void throwsInfrastructureExceptionWhenMachinesWaitingIsInterrupted() throws Exception {
    final Thread thread = Thread.currentThread();
    when(bootstrapper.bootstrapAsync()).thenReturn(new CompletableFuture<>());

    Executors.newSingleThreadScheduledExecutor()
        .schedule(thread::interrupt, 300, TimeUnit.MILLISECONDS);

    internalRuntime.internalStart(emptyMap());
  }

