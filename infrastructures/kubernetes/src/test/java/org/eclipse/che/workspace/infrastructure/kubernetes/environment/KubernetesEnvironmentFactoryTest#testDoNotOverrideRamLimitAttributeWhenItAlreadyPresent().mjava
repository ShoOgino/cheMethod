  @Test
  public void testDoNotOverrideRamLimitAttributeWhenItAlreadyPresent() throws Exception {
    final long customRamLimit = 3072;
    final Map<String, String> attributes =
        ImmutableMap.of(MEMORY_LIMIT_ATTRIBUTE, String.valueOf(customRamLimit));
    when(machineConfig1.getAttributes()).thenReturn(attributes);
    when(machineConfig2.getAttributes()).thenReturn(attributes);
    final Pod pod1 = mockPod(MACHINE_NAME_1, 0);
    final Pod pod2 = mockPod(MACHINE_NAME_2, 0);
    final Set<Pod> pods = ImmutableSet.of(pod1, pod2);

    k8sEnvironmentFactory.addRamLimitAttribute(machines, pods);

    final long[] actual = machinesRam(machines.values());
    final long[] expected = new long[actual.length];
    fill(expected, customRamLimit);
    assertTrue(Arrays.equals(actual, expected));
  }

