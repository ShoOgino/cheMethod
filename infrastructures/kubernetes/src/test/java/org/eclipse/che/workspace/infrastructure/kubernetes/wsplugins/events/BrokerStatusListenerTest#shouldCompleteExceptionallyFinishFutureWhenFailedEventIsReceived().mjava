  @Test
  public void shouldCompleteExceptionallyFinishFutureWhenFailedEventIsReceived() {
    // given
    BrokerEvent event =
        new BrokerEvent()
            .withRuntimeId(new RuntimeIdentityImpl(WORKSPACE_ID, null, null))
            .withStatus(BrokerStatus.FAILED)
            .withError("error");

    // when
    brokerStatusListener.onEvent(event);

    // then
    verify(finishFuture).completeExceptionally(any(InfrastructureException.class));
  }

