  @Test
  public void testEmptyDirVolumeMountsAdded() throws Exception {
    Container container = new Container();
    Pod pod = buildPod(POD_ID, container);
    when(k8sEnv.getPods()).thenReturn(ImmutableMap.of(POD_ID, pod));

    ephemeralWorkspaceAdapter.provision(k8sEnv, runtimeIdentity);

    Container podContainer = pod.getSpec().getContainers().get(0);
    assertEquals(podContainer.getVolumeMounts().size(), volumes.values().size());
    assertEquals(pod.getSpec().getVolumes().size(), volumes.values().size());
    assertTrue(pod.getSpec().getVolumes().stream().allMatch(vol -> (vol.getEmptyDir() != null)));
  }

