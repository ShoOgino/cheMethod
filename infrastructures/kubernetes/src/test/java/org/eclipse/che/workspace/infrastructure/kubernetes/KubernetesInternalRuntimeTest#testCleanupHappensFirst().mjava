  @Test
  public void testCleanupHappensFirst() throws InfrastructureException {
    internalRuntime.start(emptyMap());

    InOrder cleanupInOrderExecutionVerification =
        Mockito.inOrder(namespace, cheNamespace, deployments, toolingProvisioner);
    cleanupInOrderExecutionVerification.verify(namespace).cleanUp();
    cleanupInOrderExecutionVerification.verify(cheNamespace).cleanUp(WORKSPACE_ID);
    cleanupInOrderExecutionVerification
        .verify(toolingProvisioner)
        .provision(any(), any(), any(), any());
    cleanupInOrderExecutionVerification.verify(deployments).deploy(any(Pod.class));
  }

