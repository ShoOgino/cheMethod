  @Test
  public void addPodsWhenRecipeContainsThem() throws Exception {
    Pod pod =
        new PodBuilder()
            .withNewMetadata()
            .withName("pod-test")
            .endMetadata()
            .withNewSpec()
            .endSpec()
            .build();

    final List<HasMetadata> recipeObjects = singletonList(pod);
    when(validatedObjects.getItems()).thenReturn(recipeObjects);

    final KubernetesEnvironment parsed =
        k8sEnvironmentFactory.doCreate(internalRecipe, emptyMap(), emptyList());

    assertEquals(parsed.getPodsCopy().size(), 1);
    assertEquals(
        parsed.getPodsCopy().values().iterator().next().getMetadata().getName(),
        pod.getMetadata().getName());
    assertEquals(parsed.getPodData().size(), 1);
    assertEquals(
        parsed.getPodData().values().iterator().next().getMetadata().getName(),
        pod.getMetadata().getName());
  }

