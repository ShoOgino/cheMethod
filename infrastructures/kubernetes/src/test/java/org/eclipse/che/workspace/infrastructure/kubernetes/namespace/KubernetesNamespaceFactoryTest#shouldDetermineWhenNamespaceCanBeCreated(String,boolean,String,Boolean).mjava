  @Test(dataProvider = "creatingNamespaceConditions")
  public void shouldDetermineWhenNamespaceCanBeCreated(
      String legacyProperty,
      boolean legacyNamespaceExists,
      String namespaceProperty,
      Boolean expectedOutcome) {

    // given
    namespaceFactory =
        new KubernetesNamespaceFactory(
            legacyProperty, "", "", namespaceProperty, true, clientFactory, workspaceManager);

    Namespace existingLegacyNamespace = legacyNamespaceExists ? mock(Namespace.class) : null;
    when(namespaceResource.get()).thenReturn(existingLegacyNamespace);

    // when
    Boolean result;
    try {
      result = namespaceFactory.isCreatingNamespace("123");
    } catch (InfrastructureException e) {
      // this can happen and we test for it below...
      result = null;
    }

    // then
    assertEquals(result, expectedOutcome);
  }

