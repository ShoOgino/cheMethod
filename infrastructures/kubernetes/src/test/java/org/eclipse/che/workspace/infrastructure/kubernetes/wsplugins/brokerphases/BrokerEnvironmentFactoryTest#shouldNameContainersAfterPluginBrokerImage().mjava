  @Test
  public void shouldNameContainersAfterPluginBrokerImage() throws Exception {
    // given
    Collection<PluginMeta> metas = singletonList(new PluginMeta());
    ArgumentCaptor<BrokersConfigs> captor = ArgumentCaptor.forClass(BrokersConfigs.class);

    // when
    factory.create(metas, runtimeId, new BrokersResult());

    // then
    verify(factory).doCreate(captor.capture());
    BrokersConfigs brokersConfigs = captor.getValue();
    PodSpec brokerPodSpec = brokersConfigs.pod.getSpec();

    List<Container> initContainers = brokerPodSpec.getInitContainers();
    assertEquals(initContainers.size(), 1);
    assertEquals(initContainers.get(0).getName(), "init-image");

    List<Container> containers = brokerPodSpec.getContainers();
    assertEquals(containers.size(), 1);
    assertEquals(containers.get(0).getName(), "unified-image");
  }

