  @Test
  public void testSetsRamLimitAttributeFromKubernetesResource() throws Exception {
    final long firstMachineRamLimit = 3072;
    final long secondMachineRamLimit = 1024;
    when(machineConfig1.getAttributes()).thenReturn(new HashMap<>());
    when(machineConfig2.getAttributes()).thenReturn(new HashMap<>());
    final Set<Pod> pods =
        ImmutableSet.of(
            mockPod(MACHINE_NAME_1, firstMachineRamLimit),
            mockPod(MACHINE_NAME_2, secondMachineRamLimit));

    k8sEnvironmentFactory.addRamLimitAttribute(machines, pods);

    final long[] actual = machinesRam(machines.values());
    final long[] expected = new long[] {firstMachineRamLimit, secondMachineRamLimit};
    assertTrue(Arrays.equals(actual, expected));
  }

