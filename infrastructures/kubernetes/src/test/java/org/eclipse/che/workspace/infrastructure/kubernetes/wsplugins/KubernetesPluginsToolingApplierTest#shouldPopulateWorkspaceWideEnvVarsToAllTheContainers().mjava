  @Test
  public void shouldPopulateWorkspaceWideEnvVarsToAllTheContainers() throws Exception {
    // when
    Container container = mock(Container.class);
    containers.add(container);
    List<io.fabric8.kubernetes.api.model.EnvVar> workspaceWideEnvVars = new ArrayList<>();
    workspaceWideEnvVars.add();
    workspaceWideEnvVars.add();

    // when
    applier.apply(internalEnvironment, ImmutableList.of(createChePlugin(), createChePluginWith2Containers()));

    // then
    assertEquals(internalEnvironment.getPods().size(), 1);
    Pod pod = internalEnvironment.getPods().values().iterator().next();
    List<Container> actualContainers = pod.getSpec().getContainers();
    assertEquals(actualContainers.size(), 5);
    for (Container actualContainer : actualContainers) {
      assertTrue(actualContainer.getEnv().containsAll(workspaceWideEnvVars));
    }
  }

