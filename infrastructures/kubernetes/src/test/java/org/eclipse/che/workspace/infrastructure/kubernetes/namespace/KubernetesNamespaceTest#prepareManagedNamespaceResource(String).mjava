  private Resource prepareManagedNamespaceResource(String namespaceName) {
    Resource namespaceResource = mock(Resource.class);
    doReturn(namespaceResource).when(namespaceOperation).withName(namespaceName);
    doReturn(namespaceResource).when(namespaceResource).withPropagationPolicy(eq("Foreground"));
    when(namespaceResource.get())
        .thenReturn(
            new NamespaceBuilder()
                .withNewMetadata()
                .withName(namespaceName)
                .addToLabels("che-managed", "true")
                .endMetadata()
                .build());
    kubernetesClient.namespaces().withName(namespaceName).get();
    return namespaceResource;
  }

