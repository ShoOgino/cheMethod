  /**
   * Creates a OpenShift project for the specified workspace.
   *
   * <p>The project name will be chosen according to a configuration, and it will be prepared
   * (created if necessary).
   *
   * @param workspaceId identifier of the workspace
   * @return created project
   * @throws InfrastructureException if any exception occurs during project preparing
   */
  public OpenShiftProject create(String workspaceId) throws InfrastructureException {
    final String projectName;
    try {
      projectName = evalNamespaceName(workspaceId, EnvironmentContext.getCurrent().getSubject());
    } catch (NotFoundException | ServerException | ConflictException | ValidationException e) {
      throw new InfrastructureException(
          format(
              "Failed to evaluate the project name to use for workspace %s. The error message"
                  + " was: %s",
              workspaceId, e.getMessage()),
          e);
    }
    OpenShiftProject osProject = doCreateProject(workspaceId, projectName);
    osProject.prepare();

    if (isCreatingNamespace(workspaceId) && !isNullOrEmpty(getServiceAccountName())) {
      // prepare service account for workspace only if account name is configured
      // and project is not predefined
      // since predefined project should be prepared during Che deployment
      OpenShiftWorkspaceServiceAccount osWorkspaceServiceAccount =
          doCreateServiceAccount(workspaceId, projectName);
      osWorkspaceServiceAccount.prepare();
    }

    return osProject;
  }

