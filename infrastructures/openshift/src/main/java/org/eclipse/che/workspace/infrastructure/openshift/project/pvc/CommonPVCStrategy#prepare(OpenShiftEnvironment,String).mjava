  @Override
  public void prepare(OpenShiftEnvironment osEnv, String workspaceId)
      throws InfrastructureException {
    Set<String> subPaths = new HashSet<>();
    osEnv.getPersistentVolumeClaims().put(pvcName, newPVC(pvcName, pvcAccessMode, pvcQuantity));
    factory
        .create(workspaceId)
        .persistentVolumeClaims()
        .createIfNotExist(osEnv.getPersistentVolumeClaims().values());

    for (Pod pod : osEnv.getPods().values()) {
      PodSpec podSpec = pod.getSpec();
      for (Container container : podSpec.getContainers()) {
        String machineName = Names.machineName(pod, container);
        InternalMachineConfig machineConfig = osEnv.getMachines().get(machineName);
        addMachineVolumes(workspaceId, subPaths, podSpec, container, machineConfig);
      }
    }
    if (!subPaths.isEmpty()) {
      pvcSubPathHelper.createDirs(workspaceId, subPaths.toArray(new String[subPaths.size()]));
    }
  }

