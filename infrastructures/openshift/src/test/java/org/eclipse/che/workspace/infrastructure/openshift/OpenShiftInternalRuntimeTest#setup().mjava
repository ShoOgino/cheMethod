  @BeforeMethod
  public void setup() throws Exception {
    MockitoAnnotations.initMocks(this);
    internalRuntime =
        new OpenShiftInternalRuntime(
            13,
            new URLRewriter.NoOpURLRewriter(),
            eventService,
            bootstrapperFactory,
            serverCheckerFactory,
            context,
            project);
    when(context.getOpenShiftEnvironment()).thenReturn(osEnv);
    when(serverCheckerFactory.create(any(), anyString(), any())).thenReturn(serversChecker);
    when(context.getIdentity()).thenReturn(IDENTITY);
    doNothing().when(project).cleanUp();
    doReturn(ImmutableMap.of(PVC_NAME, mockPvc())).when(osEnv).getPersistentVolumeClaims();
    when(project.persistentVolumeClaims()).thenReturn(pvcs);
    when(project.services()).thenReturn(services);
    when(project.routes()).thenReturn(routes);
    when(project.pods()).thenReturn(pods);
    when(pvcs.get()).thenReturn(emptyList());
    when(bootstrapperFactory.create(any(), anyListOf(InstallerImpl.class), any()))
        .thenReturn(bootstrapper);
    when(context.getEnvironment()).thenReturn(environment);
    doReturn(ImmutableMap.of(M1_NAME, mockMachine(), M2_NAME, mockMachine()))
        .when(environment)
        .getMachines();
  }

