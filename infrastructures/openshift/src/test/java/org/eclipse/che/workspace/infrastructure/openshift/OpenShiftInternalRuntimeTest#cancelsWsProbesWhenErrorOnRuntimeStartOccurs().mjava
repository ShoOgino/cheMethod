  @Test
  public void cancelsWsProbesWhenErrorOnRuntimeStartOccurs() throws Exception {
    doNothing().when(project).cleanUp();
    when(osEnv.getServices()).thenThrow(new RuntimeException());

    try {
      internalRuntime.internalStart(emptyMap());
    } catch (Exception e) {
      verify(probesScheduler).cancel(WORKSPACE_ID);
      return;
    }
    fail();
  }

