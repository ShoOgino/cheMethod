  @Test
  public void addPVCWithConfiguredNameToOsEnv() throws Exception {
    when(pod.getSpec()).thenReturn(podSpec);
    mockName(pod, POD_NAME);
    when(osEnv.getPersistentVolumeClaims()).thenReturn(new HashMap<>());
    when(osEnv.getPods()).thenReturn(singletonMap(POD_NAME, pod));
    when(podSpec.getContainers()).thenReturn(singletonList(container));
    when(podSpec.getVolumes()).thenReturn(new ArrayList<>());
    when(container.getName()).thenReturn(CONTAINER_NAME);
    when(container.getVolumeMounts()).thenReturn(new ArrayList<>());

    commonPVCStrategy.prepare(osEnv, WORKSPACE_ID);

    verify(container).getVolumeMounts();
    verify(podSpec).getVolumes();
    verify(pvcSubPathHelper).createDirs(WORKSPACE_ID, WORKSPACE_ID + PROJECT_FOLDER_PATH);
    assertFalse(podSpec.getVolumes().isEmpty());
    assertFalse(container.getVolumeMounts().isEmpty());
    assertFalse(osEnv.getPersistentVolumeClaims().isEmpty());
    assertTrue(osEnv.getPersistentVolumeClaims().containsKey(PVC_NAME));
  }

