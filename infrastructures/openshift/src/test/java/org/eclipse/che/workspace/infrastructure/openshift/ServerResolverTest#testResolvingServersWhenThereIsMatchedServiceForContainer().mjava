  @Test
  public void testResolvingServersWhenThereIsMatchedServiceForContainer() {
    Container container = createContainer();
    Pod pod = createPod(ImmutableMap.of("kind", "web-app"));
    Service nonMatchedByPodService =
        createService("matched", CONTAINER_PORT, ImmutableMap.of("kind", "web-app"));
    Route route =
        createRoute(
            "matched",
            ImmutableMap.of(
                "http-server",
                new ServerConfigImpl("3054", "http", "/api", ATTRIBUTES_MAP),
                "ws-server",
                new ServerConfigImpl("3054", "ws", "/connect", ATTRIBUTES_MAP)));

    ServerResolver serverResolver =
        ServerResolver.of(singletonList(nonMatchedByPodService), singletonList(route));

    Map<String, ServerImpl> resolved = serverResolver.resolve(pod, container);

    assertEquals(resolved.size(), 2);
    assertEquals(
        resolved.get("http-server"),
        new ServerImpl()
            .withUrl("http://localhost/api")
            .withStatus(UNKNOWN)
            .withAttributes(ATTRIBUTES_MAP));
    assertEquals(
        resolved.get("ws-server"),
        new ServerImpl()
            .withUrl("ws://localhost/connect")
            .withStatus(UNKNOWN)
            .withAttributes(ATTRIBUTES_MAP));
  }

