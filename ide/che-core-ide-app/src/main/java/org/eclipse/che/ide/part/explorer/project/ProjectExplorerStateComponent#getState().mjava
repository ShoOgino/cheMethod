  @Override
  public JsonObject getState() {
    JsonObject state = Json.createObject();
    JsonArray array = Json.createArray();
    state.put(PATH_PARAM_ID, array);

    List<String> rawPaths =
        projectExplorer
            .getTree()
            .getNodeStorage()
            .getAll()
            .stream()
            .filter(node -> projectExplorer.getTree().isExpanded(node))
            .filter(node -> node instanceof ResourceNode)
            .map(node -> ((ResourceNode) node).getData().getLocation().toString())
            .collect(Collectors.toList());

    int i = 0;
    for (String path : rawPaths) {
      array.set(i++, path);
    }

    state.put(SHOW_HIDDEN_FILES, projectExplorer.isShowHiddenFiles());

    return state;
  }

