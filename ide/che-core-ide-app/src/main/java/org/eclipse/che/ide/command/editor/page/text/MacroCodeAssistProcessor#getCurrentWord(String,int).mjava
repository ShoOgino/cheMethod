  private String getCurrentWord(String text, int offset) {
    int i = offset - 1;
    while (i >= 0 && isWordChar(text.charAt(i))) {
      i--;
    }
    return text.substring(i + 1, offset);
  }

