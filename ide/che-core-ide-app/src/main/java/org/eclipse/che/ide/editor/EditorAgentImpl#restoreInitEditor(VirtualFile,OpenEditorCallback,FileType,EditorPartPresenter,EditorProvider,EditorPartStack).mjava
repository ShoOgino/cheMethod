  private Promise<Void> restoreInitEditor(
      final VirtualFile file,
      final OpenEditorCallback openEditorCallback,
      FileType fileType,
      final EditorPartPresenter editor,
      EditorProvider editorProvider,
      EditorPartStack editorPartStack) {
    return AsyncPromiseHelper.createFromAsyncRequest(
        (AsyncCallback<Void> promiseCallback) -> {
          OpenEditorCallback initializeCallback =
              new OpenEditorCallbackImpl() {
                @Override
                public void onEditorOpened(EditorPartPresenter editor) {
                  editorPartStack.addPart(editor);

                  promiseCallback.onSuccess(null);
                  openEditorCallback.onEditorOpened(editor);
                }

                @Override
                public void onInitializationFailed() {
                  promiseCallback.onFailure(
                      new Exception("Can not initialize editor for " + file.getLocation()));
                  openEditorCallback.onInitializationFailed();
                }
              };

          editor.init(new EditorInputImpl(fileType, file), initializeCallback);
          finalizeInit(file, editor, editorProvider);
        });
  }

