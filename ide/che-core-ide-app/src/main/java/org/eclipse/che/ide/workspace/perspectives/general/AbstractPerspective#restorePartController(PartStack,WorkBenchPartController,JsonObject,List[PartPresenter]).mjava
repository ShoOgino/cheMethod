    private double restorePartController(PartStack stack, WorkBenchPartController controller, JsonObject partStack,
                                         List<PartPresenter> activeParts) {
        double size = 0;
        if (partStack.hasKey("SIZE")) {
            size = partStack.getNumber("SIZE");
            controller.setSize(size);
        }

        if (partStack.hasKey("HIDDEN")) {
            controller.setHidden(partStack.getBoolean("HIDDEN"));
        }

        if (partStack.hasKey("PARTS")) {
            JsonArray parts = partStack.get("PARTS");
            for (int i = 0; i < parts.length(); i++) {
                JsonObject value = parts.get(i);
                if (value.hasKey("CLASS")) {
                    String className = value.getString("CLASS");
                    Provider<PartPresenter> provider = dynaProvider.getProvider(className);
                    if (provider != null) {
                        PartPresenter partPresenter = provider.get();
                        if (!stack.containsPart(partPresenter)) {
                            stack.addPart(partPresenter);
                        }
                    }
                }
            }
        }

        //hide part stack if we cannot restore opened parts
        if (stack.getParts().isEmpty()) {
            controller.setHidden(true);
        }

        if (partStack.hasKey("ACTIVE_PART")) {
            String className = partStack.getString("ACTIVE_PART");
            Provider<PartPresenter> provider = dynaProvider.getProvider(className);
            if (provider != null) {
                activeParts.add(provider.get());
            }
        }
        return size;
    }

