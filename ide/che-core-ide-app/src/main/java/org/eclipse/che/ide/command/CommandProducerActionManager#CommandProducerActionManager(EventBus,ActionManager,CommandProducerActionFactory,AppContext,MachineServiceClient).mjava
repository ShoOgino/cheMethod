    @Inject
    public CommandProducerActionManager(EventBus eventBus,
                                        ActionManager actionManager,
                                        CommandProducerActionFactory commandProducerActionFactory,
                                        AppContext appContext,
                                        MachineServiceClient machineServiceClient) {
        this.actionManager = actionManager;
        this.commandProducerActionFactory = commandProducerActionFactory;
        this.appContext = appContext;
        this.machineServiceClient = machineServiceClient;

        machines = new ArrayList<>();
        commandProducers = new HashSet<>();
        actionsToActionGroups = new HashMap<>();
        actionsByMachines = new HashMap<>();
        producersToActionGroups = new HashMap<>();

        eventBus.addHandler(MachineStateEvent.TYPE, this);
        eventBus.addHandler(WsAgentStateEvent.TYPE, this);
    }

