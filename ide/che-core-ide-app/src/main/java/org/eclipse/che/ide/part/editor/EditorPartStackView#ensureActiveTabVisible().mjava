  /** Ensures active tab and plus button are visible. */
  private void ensureActiveTabVisible() {
    // do nothing if selected tab is null
    if (activeTab == null) {
      return;
    }

    // do nothing if selected tab is visible and plus button is visible
    if (getAbsoluteTop(activeTab.getView().asWidget().getElement())
            == getAbsoluteTop(tabsPanel.getElement())
        && getAbsoluteTop(plusPanel.getElement()) == getAbsoluteTop(tabsPanel.getElement())
        && tabsPanelWidth == tabsPanel.getOffsetWidth()) {
      return;
    }

    tabsPanelWidth = tabsPanel.getOffsetWidth();

    // determine whether all widgets are visible
    boolean allWidgetVisible = true;
    for (int i = 0; i < tabsPanel.getWidgetCount(); i++) {
      Widget w = tabsPanel.getWidget(i);
      if (plusPanel == w) {
        continue;
      }

      if (!w.isVisible()) {
        allWidgetVisible = false;
        break;
      }
    }

    // do nothing if all widgets are visible and sum of children width less then panel width
    if (allWidgetVisible) {
      int childrenWidth = 0;
      for (int i = 0; i < tabsPanel.getWidgetCount(); i++) {
        Widget w = tabsPanel.getWidget(i);
        childrenWidth += w.getOffsetWidth();
      }

      if (childrenWidth < tabsPanelWidth) {
        return;
      }
    }

    // hide all widgets except plus button
    for (int i = 0; i < tabsPanel.getWidgetCount(); i++) {
      Widget w = tabsPanel.getWidget(i);
      if (plusPanel == w) {
        continue;
      }

      w.setVisible(false);
    }

    // determine selected tab index
    int selectedTabIndex = tabsPanel.getWidgetIndex(activeTab.getView().asWidget());

    // show all possible tabs before selected tab
    for (int i = selectedTabIndex; i >= 0; i--) {
      Widget w = tabsPanel.getWidget(i);

      // skip for plus button
      if (plusPanel == w) {
        continue;
      }

      // set tab visible
      w.setVisible(true);

      // continue cycle if plus button visible
      if (getAbsoluteTop(plusPanel.getElement()) == getAbsoluteTop(tabsPanel.getElement())) {
        continue;
      }

      // otherwise hide tab and break
      w.setVisible(false);
      break;
    }

    // show all possible tabs after selected tab
    for (int i = selectedTabIndex + 1; i < tabsPanel.getWidgetCount(); i++) {
      Widget w = tabsPanel.getWidget(i);

      // skip for plus button
      if (plusPanel == w) {
        continue;
      }

      // set tab visible
      w.setVisible(true);

      // continue cycle if plus button visible
      if (getAbsoluteTop(plusPanel.getElement()) == getAbsoluteTop(tabsPanel.getElement())) {
        continue;
      }

      // otherwise hide tab and break
      w.setVisible(false);
      break;
    }
  }

