    @Override
    public void onWorkspaceStopped(WorkspaceStoppedEvent event) {
      if (persistWorkspaceStatePromise != null) {
        persistWorkspaceStatePromise.then(
            arg -> {
              clearProjects();
              resourceManager = null;
              clearRuntime();
            });
      } else {
        clearProjects();
        resourceManager = null;
        clearRuntime();
      }
    }

