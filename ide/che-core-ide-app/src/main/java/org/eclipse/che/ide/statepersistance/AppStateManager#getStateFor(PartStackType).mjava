  /**
   * Gets cached state for given {@code partStackType}. Use {@link #readStateFromPreferences()}
   * first to get not cached state
   */
  @Nullable
  public JsonObject getStateFor(PartStackType partStackType) {
    String workspaceId = appContext.getWorkspace().getId();
    if (!allWsState.hasKey(workspaceId)) {
      return null;
    }

    JsonObject preferences = allWsState.getObject(workspaceId);
    if (!preferences.hasKey(WORKSPACE)) {
      return null;
    }

    JsonObject workspace = preferences.getObject(WORKSPACE);
    if (!workspace.hasKey(WORKSPACE)) {
      return null;
    }

    JsonObject workspaceState = workspace.getObject(WORKSPACE);
    if (!workspaceState.hasKey(PERSPECTIVES)) {
      return null;
    }

    String perspectiveId = perspectiveManagerProvider.get().getPerspectiveId();
    JsonObject perspectives = workspaceState.getObject(PERSPECTIVES);
    if (!perspectives.hasKey(perspectiveId)) {
      return null;
    }

    JsonObject projectPerspective = perspectives.getObject(perspectiveId);
    if (!projectPerspective.hasKey(PART_STACKS)) {
      return null;
    }

    JsonObject partStacks = projectPerspective.getObject(PART_STACKS);
    if (!partStacks.hasKey(partStackType.name())) {
      return null;
    }

    return partStacks.getObject(partStackType.name());
  }

