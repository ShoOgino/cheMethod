    private Set<Macro> getMacros(Machine machine) {
        Set<Macro> macros = Sets.newHashSet();
        for (Map.Entry<String, ? extends Server> entry : machine.getServers().entrySet()) {
            macros.add(new ServerAddressMacro(entry.getKey(),
                                              entry.getValue().getUrl()));

            if (entry.getKey().endsWith("/tcp")) {
                macros.add(new ServerAddressMacro(entry.getKey().substring(0, entry.getKey().length() - 4),
                                                  entry.getValue().getUrl()));
            }
        }

        return macros;
    }

