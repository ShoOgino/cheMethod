    public Promise<Void> persistWorkspaceState(String wsId) {
        final JsonObject settings = Json.createObject();
        JsonObject workspace = Json.createObject();
        settings.put(WORKSPACE, workspace);
        for (Map.Entry<String, Provider<StateComponent>> entry : persistenceComponents.entrySet()) {
            try {
                String key = entry.getKey();
                workspace.put(key, entry.getValue().get().getState());
            } catch (Exception e) {
                Log.error(getClass(), e);
            }
        }
        allWsState.put(wsId, settings);
        return writeStateToPreferences(allWsState);
    }

