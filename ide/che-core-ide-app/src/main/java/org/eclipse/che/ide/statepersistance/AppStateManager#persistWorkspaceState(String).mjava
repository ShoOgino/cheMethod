    public Promise<Void> persistWorkspaceState(String wsId) {
        final JsonObject settings = Json.createObject();
        JsonObject workspace = Json.createObject();
        settings.put(WORKSPACE, workspace);
        for (Map.Entry<String, StateComponent> entry : persistenceComponents.entrySet()) {
            String key = entry.getKey();
            workspace.put(key, entry.getValue().getState());
        }
        allWsState.put(wsId, settings);
        return writeStateToPreferences(allWsState);
    }

