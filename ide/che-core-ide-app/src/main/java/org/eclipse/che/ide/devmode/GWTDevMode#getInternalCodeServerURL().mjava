  /**
   * Returns a top-level URL of the GWT Code Server which is declared in the machine that contains
   * the "wsagent" server.
   *
   * @return {@code Optional} with a top-level URL of the GWT Code Server or an empty {@code
   *     Optional} if none
   */
  private Optional<String> getInternalCodeServerURL() {
    Optional<MachineImpl> wsAgentServerMachineOpt = wsAgentServerUtil.getWsAgentServerMachine();

    if (wsAgentServerMachineOpt.isPresent()) {
      MachineImpl wsAgentServerMachine = wsAgentServerMachineOpt.get();
      Optional<ServerImpl> codeServerOpt =
          wsAgentServerMachine.getServerByName(INT_CODE_SERVER_REF);

      if (codeServerOpt.isPresent()) {
        ServerImpl codeServer = codeServerOpt.get();
        String codeServerUrl = codeServer.getUrl();

        if (!isNullOrEmpty(codeServerUrl)) {
          return codeServerUrl.endsWith("/")
              ? Optional.of(codeServerUrl)
              : Optional.of(codeServerUrl + '/');
        }
      }
    }

    return Optional.empty();
  }

