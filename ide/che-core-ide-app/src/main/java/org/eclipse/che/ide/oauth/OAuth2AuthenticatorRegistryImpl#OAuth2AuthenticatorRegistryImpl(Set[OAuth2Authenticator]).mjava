  @Inject
  public OAuth2AuthenticatorRegistryImpl(Set<OAuth2Authenticator> oAuth2Authenticators) {
    authenticators = new HashMap<>(oAuth2Authenticators.size());
    for (OAuth2Authenticator authenticator : oAuth2Authenticators) {
      final String providerName = authenticator.getProviderName();
      if (authenticators.get(providerName) != null) {
        Log.warn(
            OAuth2AuthenticatorRegistryImpl.class,
            "OAuth2Authenticator provider "
                + providerName
                + " already registered. But can be only one");
      } else {
        registerAuthenticator(providerName, authenticator);
      }
    }
  }

