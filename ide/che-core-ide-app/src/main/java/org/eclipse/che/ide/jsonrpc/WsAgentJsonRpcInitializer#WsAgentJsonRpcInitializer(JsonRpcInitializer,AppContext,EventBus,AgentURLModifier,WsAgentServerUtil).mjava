  @Inject
  public WsAgentJsonRpcInitializer(
      JsonRpcInitializer initializer,
      AppContext appContext,
      EventBus eventBus,
      AgentURLModifier agentURLModifier,
      WsAgentServerUtil wsAgentServerUtil) {
    this.appContext = appContext;
    this.initializer = initializer;
    this.agentURLModifier = agentURLModifier;
    this.wsAgentServerUtil = wsAgentServerUtil;

    eventBus.addHandler(WsAgentServerRunningEvent.TYPE, event -> initializeJsonRpcService());
    eventBus.addHandler(
        WsAgentServerStoppedEvent.TYPE,
        event -> initializer.terminate(WS_AGENT_JSON_RPC_ENDPOINT_ID));

    // in case ws-agent is already running
    eventBus.addHandler(
        BasicIDEInitializedEvent.TYPE,
        event -> {
          if (appContext.getWorkspace().getStatus() == RUNNING) {
            initializeJsonRpcService();
          }
        });
  }

