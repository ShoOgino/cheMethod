  /**
   * Removes action for executing the given command and removes the appropriate action group in case
   * it's empty.
   */
  private void removeAction(CommandImpl command) {
    Action commandAction = commandActions.remove(command.getName());

    if (commandAction != null) {
      removeAction(commandAction);

      // remove action from it's action group
      String goalId = command.getGoal();
      if (isNullOrEmpty(goalId)) {
        goalId = goalRegistry.getDefaultGoal().getId();
      }

      // remove action group if it's empty
      DefaultActionGroup goalPopUpGroup = goalPopUpGroups.remove(goalId);

      if (goalPopUpGroup != null) {
        goalPopUpGroup.remove(commandAction);

        if (goalPopUpGroup.getChildrenCount() == 0) {
          removeAction(goalPopUpGroup);
        }
      }
    }
  }

