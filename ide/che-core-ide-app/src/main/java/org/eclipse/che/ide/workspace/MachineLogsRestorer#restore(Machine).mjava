    public void restore(Machine machine) {
        if (machine == null) {
            return;
        }

        // FIXME: spi
        String machineId = ""/*machine.getId()*/;

        execAgentCommandManager.getProcesses(machineId, false)
                               .then(processes -> {
                                   Consumer<Integer> pidConsumer = pid -> execAgentCommandManager
                                           .getProcessLogs(machineId, pid, null, null, 50, 0)
                                           .then(logs -> {
                                               logs.forEach(log -> {
                                                   String fixedLog = log.getText().replaceAll("\\[STDOUT\\] ", "");
                                                   // FIXME: spi
                                                   String machineName = ""/*machine.getConfig().getName()*/;
                                                   eventBus.fireEvent(new EnvironmentOutputEvent(fixedLog, machineName));
                                               });
                                           });

                                   processes.stream()
                                            .filter(it -> "CheWsAgent".equals(it.getName()))
                                            .map(DtoWithPid::getPid)
                                            .forEach(pidConsumer);
                               });
    }

