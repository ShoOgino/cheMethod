  @Inject
  public WsConnectionListener(
      EventBus eventBus,
      final MessageBusProvider messageBusProvider,
      ConnectionClosedInformer connectionClosedInformer) {
    this.eventBus = eventBus;
    this.connectionClosedInformer = connectionClosedInformer;

    eventBus.addHandler(
        WorkspaceStartedEvent.TYPE,
        new WorkspaceStartedEvent.Handler() {
          @Override
          public void onWorkspaceStarted(WorkspaceStartedEvent workspace) {
            messageBus = messageBusProvider.getMessageBus();

            messageBus.addOnCloseHandler(WsConnectionListener.this);
          }
        });
  }

