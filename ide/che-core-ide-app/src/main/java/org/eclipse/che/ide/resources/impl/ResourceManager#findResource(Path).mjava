  private Promise<Optional<Resource>> findResource(final Path absolutePath) {
    String[] segments = absolutePath.segments();

    Promise<Optional<Resource>> chain = promises.resolve(null);

    for (int i = 0; i <= segments.length; i++) {
      Path pathToRetrieve = absolutePath.removeLastSegments(segments.length - i);
      chain = chain.thenPromise(ignored -> doFindResource(pathToRetrieve));
    }

    return chain;
  }

