    private void collectActions(Map<Action, String> result, ActionGroup group, final String containingGroupName) {
        final Action[] actions = group.getChildren(null);
        includeGroup(result, group, actions, containingGroupName);
        for (Action action : actions) {
            if (action != null) {
                if (action instanceof ActionGroup) {
                    final ActionGroup actionGroup = (ActionGroup)action;
                    final String groupName = actionGroup.getTemplatePresentation().getText();
                    collectActions(result, actionGroup,
                                   StringUtils.isNullOrEmpty(groupName) || !actionGroup.isPopup() ? containingGroupName : groupName);
                } else {
                    final String groupName = group.getTemplatePresentation().getText();
                    if (result.containsKey(action)) {
                        result.put(action, null);
                    } else {
                        result.put(action, StringUtils.isNullOrEmpty(groupName) ? containingGroupName : groupName);
                    }
                }
            }
        }
    }

