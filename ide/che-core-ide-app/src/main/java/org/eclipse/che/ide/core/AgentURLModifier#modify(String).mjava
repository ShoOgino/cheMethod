  /**
   * Changes source url by adding of machine token.
   *
   * @param agentUrl any url to the agent
   * @return modified url
   */
  public String modify(String agentUrl) {
    Optional<String> machineToken = getMachineToken();
    return machineToken
        .map(s -> agentUrl + (agentUrl.contains("?") ? '&' : '?') + "token=" + s)
        .orElse(agentUrl);
  }

