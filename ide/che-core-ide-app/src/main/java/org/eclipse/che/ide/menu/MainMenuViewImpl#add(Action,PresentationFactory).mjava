    /**
     * Create and add new item in menu.
     */
    private void add(Action action, PresentationFactory presentationFactory) {
        Presentation presentation = presentationFactory.getPresentation(action);
        if (action instanceof ActionGroup) {
            ActionGroup group = (ActionGroup)action;
            table.setText(0, menuBarItems.size(), presentation.getText());
            Element element = table.getCellFormatter().getElement(0, menuBarItems.size());
            MenuBarItem item = new MenuBarItem(group,
                                               actionManager,
                                               managerProvider,
                                               presentationFactory,
                                               element,
                                               this,
                                               keyBindingAgent,
                                               resources.menuCss());

            item.onMouseOut();
            menuBarItems.put(element, item);
            action2barItem.put(group, item);
        } else if (action instanceof CustomComponentAction) {
            Widget widget = ((CustomComponentAction)action).createCustomComponent(presentation);
            table.setWidget(0, menuBarItems.size(), widget);
            Element element = table.getCellFormatter().getElement(0, menuBarItems.size());
            menuBarItems.put(element, null);
        }
    }

