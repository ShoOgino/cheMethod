    /**
     * Groups the given {@code commands} by its goal.
     *
     * @return map that contains the given {@code commands} grouped by its goal
     */
    public Map<CommandGoal, List<CommandImpl>> groupCommandsByGoal(List<CommandImpl> commands) {
        final Map<CommandGoal, List<CommandImpl>> commandsByGoal = new HashMap<>();

        for (CommandImpl command : commands) {
            final String goalId = command.getGoal();
            final CommandGoal commandGoal = goalRegistry.getGoalForId(goalId);

            commandsByGoal.computeIfAbsent(commandGoal, key -> new ArrayList<>())
                          .add(command);
        }

        return commandsByGoal;
    }

