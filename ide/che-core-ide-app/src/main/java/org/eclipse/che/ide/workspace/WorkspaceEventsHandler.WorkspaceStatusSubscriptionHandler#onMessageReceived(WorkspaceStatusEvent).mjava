        @Override
        protected void onMessageReceived(WorkspaceStatusEvent statusEvent) {
            final String workspaceId = statusEvent.getWorkspaceId();
            switch (statusEvent.getEventType()) {
                case STARTING:
                    onWorkspaceStarting(workspaceId);
                    break;

                case RUNNING:
                    onWorkspaceStarted(workspaceId);
                    break;

                case ERROR:
                    notificationManager.notify(locale.workspaceStartFailed(), FAIL, FLOAT_MODE);
                    startWorkspaceNotification.show(workspaceId);
                    final String workspaceName = workspace.getConfig().getName();
                    final String error = statusEvent.getError();
                    workspaceServiceClient.getWorkspaces(SKIP_COUNT, MAX_COUNT).then(showErrorDialog(workspaceName, error));
                    eventBus.fireEvent(new WorkspaceStoppedEvent(workspace));
                    eventBus.fireEvent(WsAgentStateEvent.createWsAgentStoppedEvent());
                    break;

                case STOPPING:
                    loader.show(LoaderPresenter.Phase.STOPPING_WORKSPACE);
                    break;

                case STOPPED:
                    loader.setSuccess(LoaderPresenter.Phase.STOPPING_WORKSPACE);
                    startWorkspaceNotification.show(statusEvent.getWorkspaceId());
                    eventBus.fireEvent(WsAgentStateEvent.createWsAgentStoppedEvent());
                    eventBus.fireEvent(new WorkspaceStoppedEvent(workspace));
                    break;

                case SNAPSHOT_CREATING:
                    loader.show(LoaderPresenter.Phase.CREATING_WORKSPACE_SNAPSHOT);
                    break;

                case SNAPSHOT_CREATED:
                    loader.setSuccess(LoaderPresenter.Phase.CREATING_WORKSPACE_SNAPSHOT);
                    snapshotCreator.successfullyCreated();
                    break;

                case SNAPSHOT_CREATION_ERROR:
                    loader.setError(LoaderPresenter.Phase.CREATING_WORKSPACE_SNAPSHOT);
                    snapshotCreator.creationError("Snapshot creation error: " + statusEvent.getError());
                    break;
            }
        }

