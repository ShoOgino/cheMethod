  /**
   * <pre>
   * Connects to Terminal Server by WebSocket. Which allows get information from terminal on server side. The
   * terminal is initialized only when the method is called the first time.
   *
   * @param options with options param can be set some initial states for new terminal like:
   *               - initial size (number of rows and cols);
   *               - set focused on open;
   *               - initial command (like change working dir 'cd directory' and etc)
   *
   * More details {@link TerminalOptionsJso}
   * </pre>
   */
  public void connect(TerminalOptionsJso options) {
    if (countRetry == 0) {
      return;
    }

    if (!connected) {
      terminalHolder
          .getInitializerPromise()
          .then(
              aVoid -> {
                ServerImpl terminalServer =
                    machine
                        .getServerByName(SERVER_TERMINAL_REFERENCE)
                        .orElseThrow(
                            () ->
                                new OperationException(
                                    "Machine "
                                        + machine.getName()
                                        + " doesn't provide terminal server."));
                connectToTerminal(agentURLModifier.modify(terminalServer.getUrl()), options);
              })
          .catchError(
              arg -> {
                notificationManager.notify(
                    locale.failedToConnectTheTerminal(),
                    locale.terminalCanNotLoadScript(),
                    FAIL,
                    NOT_EMERGE_MODE);
                reconnect();
              });
    }
  }

