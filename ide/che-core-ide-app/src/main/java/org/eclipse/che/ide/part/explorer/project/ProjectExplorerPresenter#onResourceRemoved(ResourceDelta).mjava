    @SuppressWarnings("unchecked")
    private void onResourceRemoved(final ResourceDelta delta) {
        final Tree tree = view.getTree();
        final Resource resource = delta.getResource();

        final Node node = getNode(resource.getLocation());

        if (node == null) {
            return;
        }

        if (resource.getLocation().segmentCount() == 1) {
                tree.getNodeStorage().remove(node);
            return;
        }

        final Node parentNode = getParentNode(resource.getLocation());

        if (parentNode == null) {
            return;
        }

        final Path parentLocation = ((ResourceNode)parentNode).getData().getLocation();

        if (resource.getLocation().parent().equals(parentLocation)) {
            tree.getNodeStorage().remove(node);
        } else {
            tree.getNodeStorage().remove(node);

            Scheduler.get().scheduleDeferred(new Scheduler.ScheduledCommand() {
                @Override
                public void execute() {
                    tree.getNodeLoader().loadChildren(parentNode, true);
                }
            });
        }
    }

