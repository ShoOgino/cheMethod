    @Override
    public void onWorkspaceStopped(WorkspaceStoppedEvent event) {
        appStateManager.get().persistWorkspaceState(getWorkspaceId()).then(new Operation<Void>() {
            @Override
            public void apply(Void arg) throws OperationException {
                browserQueryFieldRenderer.setProjectName("");
                for (Project project : projects) {
                    eventBus.fireEvent(new ResourceChangedEvent(new ResourceDeltaImpl(project, REMOVED)));
                }

                projects = null;
                resourceManager = null;
            }
        });
        devMachine = null;

        //goto close all editors
        final EditorAgent editorAgent = editorAgentProvider.get();
        final List<EditorPartPresenter> openedEditors = editorAgent.getOpenedEditors();
        for (EditorPartPresenter editor : openedEditors) {
            editorAgent.closeEditor(editor);
        }
    }

