  @Override
  public Promise<Void> removeCommand(String name) {
    final CommandImpl command = commands.get(name);

    if (command == null) {
      return promiseProvider.reject(new Exception("Command '" + name + "' does not exist."));
    }

    return doRemoveCommand(name)
        .then(
            aVoid -> {
              // listeners should be notified after returning from #removeCommand method
              // so let's postpone notification
              Scheduler.get().scheduleDeferred(() -> notifyCommandRemoved(command));
            });
  }

