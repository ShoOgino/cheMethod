    private void removeConsole(final OutputConsole console,
                               final ProcessTreeNode node,
                               final SubPanel.RemoveCallback removeCallback) {
        console.close();
        onStopProcess(node);

        consoles.remove(node.getId());
        consoleCommands.remove(console);
        view.removeWidget(node.getId());

        removeCallback.remove();

        if (console instanceof CommandOutputConsole) {
            eventBus.fireEvent(new ProcessOutputClosedEvent(((CommandOutputConsole)console).getPid()));
        }
    }

