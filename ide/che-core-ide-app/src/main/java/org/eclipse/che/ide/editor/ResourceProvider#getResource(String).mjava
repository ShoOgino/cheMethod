  Promise<Optional<VirtualFile>> getResource(String path) {
    if (path.startsWith("commands/")) {
      final String commandName = path.substring(path.lastIndexOf('/') + 1);
      final Optional<CommandImpl> command = commandManager.getCommand(commandName);

      if (command.isPresent()) {
        CommandFileNode node = nodeFactory.newCommandFileNode(command.get());
        return promiseProvider.resolve(Optional.of(node));
      } else {
        return promiseProvider.reject(new Exception("Command " + commandName + " not found"));
      }
    } else {
      return appContext
          .getWorkspaceRoot()
          .getFile(path)
          .then(
              (Function<com.google.common.base.Optional<File>, Optional<VirtualFile>>)
                  arg -> ofNullable(arg.orNull()));
    }
  }

