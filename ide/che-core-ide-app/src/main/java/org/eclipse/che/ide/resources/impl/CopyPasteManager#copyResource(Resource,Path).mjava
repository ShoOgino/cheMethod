  private Promise<Void> copyResource(final Resource resource, final Path destination) {
    // simple copy without overwriting
    return resource
        .copy(destination)
        .thenPromise((Function<Resource, Promise<Void>>) resource1 -> promises.resolve(null))
        .catchErrorPromise(
            error -> {

              // resource may already exists
              if (error.getMessage().contains("exists")) {

                // create dialog with overwriting option
                return createFromAsyncRequest(
                    (RequestCall<Void>)
                        callback -> {

                          // handle overwrite operation
                          final ConfirmCallback overwrite =
                              () -> {

                                // copy with overwriting
                                resource
                                    .copy(destination, true)
                                    .then(
                                        ignored -> {
                                          callback.onSuccess(null);
                                        })
                                    .catchError(
                                        error1 -> {
                                          callback.onFailure(error1.getCause());
                                        });
                              };

                          // skip this resource
                          final ConfirmCallback skip = () -> callback.onSuccess(null);

                          // change destination name
                          final ConfirmCallback rename =
                              () ->
                                  dialogFactory
                                      .createInputDialog(
                                          "Enter new name",
                                          "Enter new name",
                                          value -> {
                                            final Path newPath = destination.parent().append(value);

                                            copyResource(resource, newPath)
                                                .then(callback::onSuccess)
                                                .catchError(
                                                    error1 -> {
                                                      callback.onFailure(error1.getCause());
                                                    });
                                          },
                                          null)
                                      .show();

                          dialogFactory
                              .createChoiceDialog(
                                  "Error",
                                  error.getMessage(),
                                  "Overwrite",
                                  "Skip",
                                  "Change Name",
                                  overwrite,
                                  skip,
                                  rename)
                              .show();
                        });
              } else {
                // notify user about failed copying
                notificationManager.notify(
                    "Error copying resource", error.getMessage(), FAIL, FLOAT_MODE);

                return promises.resolve(null);
              }
            });
  }

