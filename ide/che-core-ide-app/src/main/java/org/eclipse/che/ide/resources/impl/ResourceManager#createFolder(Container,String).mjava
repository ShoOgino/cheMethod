    Promise<Folder> createFolder(final Container parent, final String name) {
        final Path path = Path.valueOf(name);

        return findResource(parent.getLocation().append(path), true).thenPromise(resource -> {
            checkState(!resource.isPresent(), "Resource already exists");
            checkArgument(!parent.getLocation().isRoot(), "Failed to create folder in workspace root");

            if (path.segmentCount() == 1) {
                checkArgument(checkFolderName(name), "Invalid folder name");
            }

            return ps.createFolder(parent.getLocation().append(name)).thenPromise(reference -> {
                final Resource createdFolder = newResourceFrom(reference);
                store.register(createdFolder);

                return promises.resolve(createdFolder.asFolder());
            });
        });
    }

