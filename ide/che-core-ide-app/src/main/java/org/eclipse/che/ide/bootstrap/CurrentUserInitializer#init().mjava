    Promise<Void> init() {
        final CurrentUserImpl user = new CurrentUserImpl();

        return loadProfile().thenPromise(profile -> {
            user.setId(profile.getUserId());

            return loadPreferences();
        }).then((Function<Map<String, String>, Void>)preferences -> {
            user.setPreferences(preferences);

            ((AppContextImpl)appContext).setCurrentUser(user);

            return null;
        });
    }

