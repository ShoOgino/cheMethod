  @Override
  public void setBreakpointMark(
      final Breakpoint breakpoint, final boolean active, final LineChangeAction action) {

    if (hasGutter != null) {
      int lineNumber = breakpoint.getLocation().getLineNumber() - 1;
      boolean hasCondition = !Strings.isNullOrEmpty(breakpoint.getCondition());

      Element newElement =
          active
              ? (hasCondition ? activeConditionBreakpointMark : activeBreakpointMark)
              : (hasCondition ? inactiveConditionBreakpointMark : inactiveBreakpointMark);
      if (hasCondition) {
        newElement.setTitle("Condition: " + breakpoint.getCondition());
      }

      Element existedElement = hasGutter.getGutterItem(lineNumber, BREAKPOINTS_GUTTER);

      if (existedElement != null) {
        hasGutter.setGutterItem(lineNumber, BREAKPOINTS_GUTTER, newElement);
      } else {
        hasGutter.addGutterItem(
            lineNumber,
            BREAKPOINTS_GUTTER,
            newElement,
            (fromLine, linesRemoved, linesAdded) ->
                action.onLineChange(document.getFile(), fromLine, linesAdded, linesRemoved));
      }
    }
  }

