  private Promise<Void> writeStateToPreferences(JsonObject state) {
    final String json = state.toJson();
    preferencesManager.setValue(PREFERENCE_PROPERTY_NAME, json);
    return preferencesManager
        .flushPreferences()
        .catchError(
            error -> {
              Log.error(
                  AppStateManager.class,
                  "Failed to store app's state to user's preferences: " + error.getMessage());
            });
  }

