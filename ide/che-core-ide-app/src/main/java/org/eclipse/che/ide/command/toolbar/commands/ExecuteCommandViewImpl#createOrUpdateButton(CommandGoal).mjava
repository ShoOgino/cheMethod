    /** Add button with commands of the given goal to panel. */
    private void createOrUpdateButton(CommandGoal goal) {
        final GoalButton button = buttonsCache.getOrDefault(goal, goalButtonFactory.newButton(goal, delegate));
        buttonsCache.put(goal, button);

        final List<CommandImpl> commandsOfGoal = commands.getOrDefault(goal, emptyList());
        final GoalButtonDataProvider dataProvider = button.getPopupItemDataProvider();

        dataProvider.setCommands(commandsOfGoal);

        button.updateTooltip();

        buttonsPanel.add(button);
    }

