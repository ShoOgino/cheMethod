    /** Adds button with the commands of the given goal to panel. */
    private void createOrUpdateButton(CommandGoal goal) {
        GoalButton button = buttonsCache.get(goal);

        if (button == null) {
            button = buttonFactory.newButton(goal, delegate, getKeyBinding(goal));
        }

        buttonsCache.put(goal, button);

        final List<CommandImpl> commandsOfGoal = commands.getOrDefault(goal, emptyList());
        final GoalButtonItemsProvider itemsProvider = button.getItemProvider();

        itemsProvider.setCommands(commandsOfGoal);

        button.updateTooltip();

        buttonsPanel.add(button);
    }

