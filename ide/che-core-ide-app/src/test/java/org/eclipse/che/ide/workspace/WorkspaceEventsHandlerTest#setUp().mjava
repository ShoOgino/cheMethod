    @Before
    public void setUp() {
        when(loaderFactory.newLoader(anyString())).thenReturn(snapshotLoader);
        workspaceEventsHandler = new WorkspaceEventsHandler(eventBus,
                                                            locale,
                                                            dialogFactory,
                                                            dtoUnmarshallerFactory,
                                                            notificationManager,
                                                            messageBusProvider,
                                                            machineManagerProvider,
                                                            machineServiceClient,
                                                            snapshotCreator,
                                                            workspaceServiceClient,
                                                            startWorkspaceNotification,
                                                            wsComponentProvider,
                                                            asyncRequestFactory,
															loader);
        when(wsComponentProvider.get()).thenReturn(workspaceComponent);
        when(workspace.getId()).thenReturn(WORKSPACE_ID);
        when(workspaceStatusEvent.getWorkspaceId()).thenReturn(WORKSPACE_ID);
        when(workspaceServiceClient.getWorkspace(WORKSPACE_ID)).thenReturn(workspacePromise);
        when(messageBusProvider.getMessageBus()).thenReturn(messageBus);
        when(workspace.getLink(anyString())).thenReturn(workspaceEventsLink);
        when(workspaceEventsLink.getParameter("channel")).thenReturn(linkParameter);
        when(linkParameter.getDefaultValue()).thenReturn(WORKSPACE_STATUS_CHANNEL);
    }

