    //    @Test disabled because of GWT timer usage
    public void onWorkspaceStartingTest() throws Exception {
        when(workspaceStatusEvent.getEventType()).thenReturn(STARTING);

        workspaceEventsHandler.trackWorkspaceEvents(workspace, callback);
        workspaceEventsHandler.workspaceStatusSubscriptionHandler.onMessageReceived(workspaceStatusEvent);

        verify(workspacePromise).then(workspaceCaptor.capture());
        workspaceCaptor.getValue().apply(workspace);

        verify(workspaceServiceClient).getWorkspace(WORKSPACE_ID);
        verify(workspaceComponent).setCurrentWorkspace(workspace);
        verify(machineManagerProvider).get();

        verify(loader).show(eq(LoaderPresenter.Phase.STARTING_WORKSPACE_RUNTIME));

        verify(eventBus).fireEvent(Matchers.<WorkspaceStartingEvent>anyObject());
    }

