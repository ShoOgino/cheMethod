  @Test
  public void shouldNotifyWhenNonDevMachineStateIsCreating() throws Exception {
    when(machine.isDev()).thenReturn(false);

    when(machineStatusChangedEvent.getEventType()).thenReturn(CREATING);
    statusNotifier.onMachineStatusChanged(machineStatusChangedEvent);

    verify(workspaceServiceClient.getWorkspace(WORKSPACE_ID)).then(workspaceCaptor.capture());
    workspaceCaptor.getValue().apply(workspace);

    verify(appContext).setWorkspace(workspace);
    verify(handler).onMachineCreating(any());
  }

