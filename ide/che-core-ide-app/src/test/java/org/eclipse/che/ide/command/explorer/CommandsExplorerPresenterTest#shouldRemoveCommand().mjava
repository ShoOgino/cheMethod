  @Test
  public void shouldRemoveCommand() throws Exception {
    // given
    ConfirmDialog confirmDialog = mock(ConfirmDialog.class);
    when(dialogFactory.createConfirmDialog(
            nullable(String.class),
            nullable(String.class),
            nullable(ConfirmCallback.class),
            nullable(CancelCallback.class)))
        .thenReturn(confirmDialog);
    ArgumentCaptor<ConfirmCallback> confirmCallbackCaptor =
        ArgumentCaptor.forClass(ConfirmCallback.class);

    CommandImpl command = mock(CommandImpl.class);
    String cmdName = "build";
    when(command.getName()).thenReturn(cmdName);
    when(commandManager.removeCommand(nullable(String.class))).thenReturn(voidPromise);

    // when
    presenter.onCommandRemove(command);

    // then
    verify(dialogFactory)
        .createConfirmDialog(
            nullable(String.class),
            nullable(String.class),
            confirmCallbackCaptor.capture(),
            isNull());
    confirmCallbackCaptor.getValue().accepted();
    verify(confirmDialog).show();
    verify(commandManager).removeCommand(cmdName);
  }

