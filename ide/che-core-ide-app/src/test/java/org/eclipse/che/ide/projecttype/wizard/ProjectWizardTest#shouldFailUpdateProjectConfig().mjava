    @Test
    public void shouldFailUpdateProjectConfig() throws Exception {
        prepareWizard(UPDATE);

        when(workspaceRoot.getContainer(any(Path.class))).thenReturn(optionalContainerPromise);
        when(projectToUpdate.getResourceType()).thenReturn(Resource.PROJECT);
        when(projectToUpdate.update()).thenReturn(createProjectRequest);
        when(createProjectRequest.withBody(any(ProjectConfig.class))).thenReturn(createProjectRequest);
        when(createProjectRequest.send()).thenReturn(createProjectPromise);
        when(createProjectPromise.then(any(Operation.class))).thenReturn(createProjectPromise);
        when(createProjectPromise.catchError(any(Operation.class))).thenReturn(createProjectPromise);
        when(promiseError.getCause()).thenReturn(exception);

        wizard.complete(completeCallback);

        verify(optionalContainerPromise).then(optionalContainerCaptor.capture());
        optionalContainerCaptor.getValue().apply(Optional.of((Container)projectToUpdate));

        verify(createProjectPromise).catchError(failedOperationCaptor.capture());
        failedOperationCaptor.getValue().apply(promiseError);

        verify(promiseError).getCause();
        verify(completeCallback).onFailure(eq(exception));
    }

