  @Test
  public void shouldSetUpDevModeForInternalCodeServer() throws Exception {
    mockInternalCodeServer();

    when(devModeScriptInjector.inject(anyString())).thenReturn(voidPromise);
    when(voidPromise.then(any(Operation.class))).thenReturn(voidPromise);

    devMode.setUp();

    verify(bookmarkletParams).setParams(INT_CODE_SERVER_URL, IDE_GWT_APP_SHORT_NAME);
    verify(devModeScriptInjector).inject(INT_CODE_SERVER_URL);
  }

