    @Test
    public void onWsAgentOutputEventReceivedTest() throws Exception {
        WorkspaceRuntimeDto runtime = mock(WorkspaceRuntimeDto.class);
        WorkspaceConfigDto workspaceConfig = mock(WorkspaceConfigDto.class);
        when(workspace.getRuntime()).thenReturn(runtime);
        MachineDto devMachine = mock(MachineDto.class);
        when(devMachine.getWorkspaceId()).thenReturn(WORKSPACE_ID);
        when(devMachine.getId()).thenReturn(MACHINE_NAME);
        when(runtime.getDevMachine()).thenReturn(devMachine);
        when(runtime.getActiveEnv()).thenReturn(ACTIVE_ENV);
        when(workspace.getConfig()).thenReturn(workspaceConfig);
        Map<String, EnvironmentDto> environments = new HashMap<>(3);
        EnvironmentDto environment = mock(EnvironmentDto.class);
        environments.put(ACTIVE_ENV, environment);
        when(workspaceConfig.getEnvironments()).thenReturn(environments);
        MachineConfigDto devMachineConfig = mock(MachineConfigDto.class);
        when(devMachineConfig.getName()).thenReturn(MACHINE_NAME);

        workspaceEventsHandler.trackWorkspaceEvents(workspace, callback);
        workspaceEventsHandler.wsAgentLogSubscriptionHandler.onMessageReceived("");

        verify(eventBus).fireEvent(Matchers.<EnvironmentOutputEvent> anyObject());
    }

