    @Test
    public void shouldCreateProject() throws Exception {
        prepareWizard(CREATE);

        when(workspaceRoot.newProject()).thenReturn(createProjectRequest);
        when(createProjectRequest.withBody(any(ProjectConfig.class))).thenReturn(createProjectRequest);
        when(createProjectRequest.send()).thenReturn(createProjectPromise);
        when(createProjectPromise.then(any(Operation.class))).thenReturn(createProjectPromise);
        when(createProjectPromise.catchError(any(Operation.class))).thenReturn(createProjectPromise);

        wizard.complete(completeCallback);

        verify(createProjectPromise).then(completeOperationCaptor.capture());
        completeOperationCaptor.getValue().apply(createdProject);

        verify(completeCallback).onCompleted();
    }

