    @Test
    public void onWorkspaceStartedTest() throws Exception {
        when(workspaceStatusEvent.getEventType()).thenReturn(RUNNING);

        workspaceEventsHandler.trackWorkspaceEvents(workspace, callback);
        workspaceEventsHandler.workspaceStatusSubscriptionHandler.onMessageReceived(workspaceStatusEvent);

        verify(workspacePromise).then(workspaceCaptor.capture());
        workspaceCaptor.getValue().apply(workspace);

        verify(workspaceServiceClient).getWorkspace(WORKSPACE_ID);
        verify(workspaceComponent).setCurrentWorkspace(workspace);

        verify(loader).setProgress(eq(LoaderPresenter.Phase.STARTING_WORKSPACE_RUNTIME), eq(LoaderPresenter.Status.SUCCESS));

        verify(eventBus).fireEvent(Matchers.<WorkspaceStartedEvent>anyObject());
        verify(notificationManager).notify(anyString(), eq(StatusNotification.Status.SUCCESS), eq(FLOAT_MODE));
    }

