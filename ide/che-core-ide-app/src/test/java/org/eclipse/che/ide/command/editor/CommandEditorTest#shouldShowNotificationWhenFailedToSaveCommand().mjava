    @Test(expected = OperationException.class)
    public void shouldShowNotificationWhenFailedToSaveCommand() throws Exception {
        when(commandManager.updateCommand(anyString(), eq(editor.editedCommand))).thenReturn(commandPromise);
        when(commandPromise.then(any(Operation.class))).thenReturn(commandPromise);

        editor.doSave();

        verify(commandPromise).catchError(errorOperationCaptor.capture());
        errorOperationCaptor.getValue().apply(mock(PromiseError.class));
        verify(editorMessages).editorMessageUnableToSave();
        verify(notificationManager).notify(anyString(), anyString(), WARNING, EMERGE_MODE);
    }

