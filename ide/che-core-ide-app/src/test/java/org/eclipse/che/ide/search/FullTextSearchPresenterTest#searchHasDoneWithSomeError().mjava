  @Test
  public void searchHasDoneWithSomeError() throws Exception {
    when(view.getPathToSearch()).thenReturn("/search");
    when(appContext.getWorkspaceRoot()).thenReturn(workspaceRoot);
    when(workspaceRoot.getContainer(any(Path.class))).thenReturn(optionalContainerPromise);

    fullTextSearchPresenter.search(SEARCHED_TEXT);

    verify(optionalContainerPromise).then(optionalContainerCaptor.capture());
    optionalContainerCaptor.getValue().apply(Optional.absent());

    verify(view).showErrorMessage(anyString());
    verify(view, never()).close();
    verify(findResultPresenter, never())
        .handleResponse(anyObject(), eq(queryExpression), anyString());
  }

