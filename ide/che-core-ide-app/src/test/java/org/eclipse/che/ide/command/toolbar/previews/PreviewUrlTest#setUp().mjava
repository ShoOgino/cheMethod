  @Before
  public void setUp() {
    ServerImpl server = mock(ServerImpl.class);
    when(server.getUrl()).thenReturn("http://preview.com");

    Map<String, ServerImpl> servers = new HashMap<>();
    servers.put(SERVER_PORT + "/tcp", server);

    MachineImpl devMachine = mock(MachineImpl.class);
    when(devMachine.getName()).thenReturn(MACHINE_NAME);
    when(devMachine.getServers()).thenReturn(servers);

    WorkspaceImpl workspace = mock(WorkspaceImpl.class);
    when(workspace.getDevMachine()).thenReturn(Optional.of(devMachine));
    when(appContext.getWorkspace()).thenReturn(workspace);

    previewUrl = new PreviewUrl(PREVIEW_URL, appContext);
  }

