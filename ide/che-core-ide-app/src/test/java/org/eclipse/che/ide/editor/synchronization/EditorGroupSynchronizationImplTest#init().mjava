    @Before
    public void init() {
        activeEditor = mock(EditorPartPresenter.class, withSettings().extraInterfaces(TextEditor.class));
        EditorPartPresenter openedEditor1 = mock(EditorPartPresenter.class, withSettings().extraInterfaces(TextEditor.class));
        EditorPartPresenter openedEditor2 = mock(EditorPartPresenter.class, withSettings().extraInterfaces(TextEditor.class));
        List<EditorPartPresenter> openedEditors = new ArrayList<>(2);
        openedEditors.add(openedEditor1);
        openedEditors.add(openedEditor2);

        when(editorAgent.getActiveEditor()).thenReturn(activeEditor);
        when(document.getDocumentHandle()).thenReturn(documentHandle);
        when(documentHandle.getDocEventBus()).thenReturn(documentEventBus);
        when(documentHandle.getDocument()).thenReturn(document);

        when(((TextEditor)activeEditor).getDocument()).thenReturn(document);
        when(((TextEditor)openedEditor1).getDocument()).thenReturn(document);
        when(((TextEditor)openedEditor2).getDocument()).thenReturn(document);

        when(documentEventBus.addHandler((Event.Type<Object>)anyObject(), anyObject())).thenReturn(handlerRegistration);

        editorGroupSynchronization = new EditorGroupSynchronizationImpl(editorAgent, openedEditors);
    }

