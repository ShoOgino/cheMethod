    @Test
    public void onWorkspaceStartingTest() throws Exception {
        when(workspaceStatusEvent.getEventType()).thenReturn(STARTING);

        workspaceEventsNotifier.trackWorkspaceEvents(workspace, callback);
        workspaceEventsNotifier.workspaceStatusSubscriptionHandler.onMessageReceived(workspaceStatusEvent);

        verify(workspacePromise).then(workspaceCaptor.capture());
        workspaceCaptor.getValue().apply(workspace);

        verify(workspaceServiceClient).getWorkspace(WORKSPACE_ID);
        verify(workspaceComponent).setCurrentWorkspace(workspace);
        verify(machineManagerProvider).get();
        verify(initialLoadingInfo).setOperationStatus(eq(WORKSPACE_BOOTING.getValue()), eq(IN_PROGRESS));
        verify(eventBus).fireEvent(Matchers.<WorkspaceStartingEvent>anyObject());
    }

