    @Test
    public void searchShouldBeSuccessfullyFinished() throws Exception {
        when(view.getPathToSearch()).thenReturn("/search");
        when(appContext.getWorkspaceRoot()).thenReturn(workspaceRoot);
        when(workspaceRoot.getContainer(any(Path.class))).thenReturn(optionalContainerPromise);
        when(searchContainer.search(anyString(), anyString())).thenReturn(searchResultPromise);

        fullTextSearchPresenter.search(SEARCHED_TEXT);

        verify(optionalContainerPromise).then(optionalContainerCaptor.capture());
        optionalContainerCaptor.getValue().apply(Optional.of(searchContainer));

        verify(searchResultPromise).then(searchResultCaptor.capture());
        searchResultCaptor.getValue().apply(new Resource[0]);

        verify(view, never()).showErrorMessage(anyString());
        verify(view).close();
        verify(findResultPresenter).handleResponse(eq(new Resource[0]), eq(SEARCHED_TEXT));
    }

