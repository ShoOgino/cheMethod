    @Test
    public void messageDialogShouldBeShownWhenProjectIsInImportingState() {
        MessageDialog messageDialog = mock(MessageDialog.class);
        when(dialogFactory.createMessageDialog(anyString(),
                                               anyString(),
                                               Matchers.<ConfirmCallback>anyObject())).thenReturn(messageDialog);

        List<String> importingProjects = Arrays.asList("/test");
        when(projectConfig.getPath()).thenReturn("/test");
        when(appContext.getImportingProjects()).thenReturn(importingProjects);

        listener.onBeforeExpand(event);

        verify(event).setCancelled(true);
        verify(dialogFactory).createMessageDialog(anyString(), anyString(), Matchers.<ConfirmCallback>anyObject());
        verify(messageDialog).show();

        verify(projectConfig, never()).getProblems();
    }

