  @SuppressWarnings("unchecked")
  @Test
  public void shouldSetDefaultGoalIfInitialIsNull() throws Exception {
    reset(goalRegistry);
    reset(view);

    String defaultGoalId = "Common";
    CommandGoal defaultGoal = mock(CommandGoal.class);
    when(goalRegistry.getDefaultGoal()).thenReturn(defaultGoal);
    when(defaultGoal.getId()).thenReturn(defaultGoalId);
    when(editedCommand.getGoal()).thenReturn(null);

    page.initialize();

    verify(goalRegistry).getAllGoals();
    verify(view).setAvailableGoals(anySet());
    verify(view).setGoal(defaultGoalId);
  }

