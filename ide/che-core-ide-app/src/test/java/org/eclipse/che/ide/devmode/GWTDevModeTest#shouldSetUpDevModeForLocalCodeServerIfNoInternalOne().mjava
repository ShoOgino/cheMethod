  @Test
  public void shouldSetUpDevModeForLocalCodeServerIfNoInternalOne() throws Exception {
    when(devModeScriptInjector.inject(anyString())).thenReturn(voidPromise);
    when(voidPromise.then(any(Operation.class))).thenReturn(voidPromise);

    devMode.setUp();

    verify(bookmarkletParams).setParams(LOCAL_CODE_SERVER_ADDRESS, IDE_GWT_APP_SHORT_NAME);
    verify(devModeScriptInjector).inject(LOCAL_CODE_SERVER_ADDRESS);
  }

