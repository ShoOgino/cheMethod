    @Test
    public void shouldCreateGoal() throws Exception {
        InputDialog inputDialog = mock(InputDialog.class);
        when(dialogFactory.createInputDialog(anyString(),
                                             anyString(),
                                             anyString(),
                                             eq(0),
                                             eq(0),
                                             anyString(),
                                             any(InputCallback.class),
                                             any(CancelCallback.class))).thenReturn(inputDialog);
        String newGoalId = "new goal";

        page.onCreateGoal();

        ArgumentCaptor<InputCallback> inputCaptor = ArgumentCaptor.forClass(InputCallback.class);
        verify(dialogFactory).createInputDialog(anyString(),
                                                anyString(),
                                                anyString(),
                                                eq(0),
                                                eq(0),
                                                anyString(),
                                                inputCaptor.capture(),
                                                isNull(CancelCallback.class));
        verify(inputDialog).show();
        inputCaptor.getValue().accepted(newGoalId);
        verify(view).setGoal(eq(newGoalId));
        verify(editedCommand).setGoal(eq(newGoalId));
        verify(dirtyStateListener, times(2)).onDirtyStateChanged();
    }

