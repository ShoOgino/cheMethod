  @Test
  public void shouldCreateGoal() throws Exception {
    // given
    InputDialog inputDialog = mock(InputDialog.class);
    when(dialogFactory.createInputDialog(
            nullable(String.class),
            nullable(String.class),
            nullable(String.class),
            eq(0),
            eq(0),
            nullable(String.class),
            nullable(InputCallback.class),
            nullable(CancelCallback.class)))
        .thenReturn(inputDialog);
    String newGoalId = "new goal";

    // when
    page.onCreateGoal();

    // then
    ArgumentCaptor<InputCallback> inputCaptor = ArgumentCaptor.forClass(InputCallback.class);
    verify(dialogFactory)
        .createInputDialog(
            nullable(String.class),
            nullable(String.class),
            nullable(String.class),
            eq(0),
            eq(0),
            nullable(String.class),
            inputCaptor.capture(),
            isNull());
    verify(inputDialog).show();
    inputCaptor.getValue().accepted(newGoalId);
    verify(view).setGoal(eq(newGoalId));
    verify(editedCommand).setGoal(eq(newGoalId));
    verify(dirtyStateListener, times(2)).onDirtyStateChanged();
  }

