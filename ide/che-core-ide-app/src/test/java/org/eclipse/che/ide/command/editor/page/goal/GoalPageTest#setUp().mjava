    @Before
    public void setUp() throws Exception {
        CommandGoal commandGoal = mock(CommandGoal.class);
        when(commandGoal.getId()).thenReturn(COMMAND_GOAL_ID);
        when(goalRegistry.getGoalForId(anyString())).thenReturn(commandGoal);

        when(editedCommand.getApplicableContext()).thenReturn(editedCommandApplicableContext);

        Map<String, String> attributes = new HashMap<>();
        attributes.put(COMMAND_GOAL_ATTRIBUTE_NAME, COMMAND_GOAL_ID);
        when(editedCommand.getAttributes()).thenReturn(attributes);

        page.setDirtyStateListener(dirtyStateListener);
        page.edit(editedCommand);
    }

