  /**
   * Returns an absolute path with the segments and device id of this path. Absolute paths start
   * with a path separator. If this path is absolute, it is simply returned.
   *
   * @return the new path
   * @since 4.0.0-RC5
   */
  public Path makeAbsolute() {
    if (isAbsolute()) {
      return this;
    }
    Path result = new Path(device, segments, separators | HAS_LEADING);
    //may need canonicalizing if it has leading ".." or "." segments
    if (result.segmentCount() > 0) {
      String first = result.segment(0);
      assert first != null;
      if (first.equals("..") || first.equals(".")) {
        result.canonicalize();
      }
    }
    return result;
  }

