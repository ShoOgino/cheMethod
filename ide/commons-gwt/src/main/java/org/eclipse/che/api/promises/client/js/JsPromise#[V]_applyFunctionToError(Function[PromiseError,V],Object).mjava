  private static <V> V applyFunctionToError(Function<PromiseError, V> onRejected, Object reason)
      throws FunctionException {
    final Throwable cause = getCause(reason);

    if (cause != null) {
      return onRejected.apply(JsPromiseError.create(cause));
    } else {
      return onRejected.apply(
          JsPromiseError.create(reason instanceof Throwable ? (Throwable) reason : null));
    }
  }

