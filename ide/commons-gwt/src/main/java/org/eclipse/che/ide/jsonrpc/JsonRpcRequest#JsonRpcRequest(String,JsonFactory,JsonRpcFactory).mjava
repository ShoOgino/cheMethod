    @AssistedInject
    public JsonRpcRequest(@Assisted("message") String message, JsonFactory jsonFactory, JsonRpcFactory jsonRpcFactory) {
        checkNotNull(message, "Message must not be null");
        checkArgument(!message.isEmpty(), "Message must not be empty");

        this.jsonFactory = jsonFactory;

        JsonObject jsonObject = jsonFactory.parse(message);

        if (jsonObject.hasKey("id")) {
            JsonValue jsonValue = jsonObject.get("id");
            if (jsonValue.getType().equals(JsonType.STRING)) {
                id = jsonValue.asString();
            } else {
                id = Double.toString(jsonValue.asNumber());
            }
        } else {
            id = null;
        }

        method = jsonObject.getString("method");

        if (jsonObject.hasKey("params")) {
            params = jsonRpcFactory.createParams(jsonObject.get("params").toJson());
        } else {
            params = null;
        }
    }

