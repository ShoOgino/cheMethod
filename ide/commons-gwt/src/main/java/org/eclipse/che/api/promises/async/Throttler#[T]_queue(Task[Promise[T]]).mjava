  @SuppressWarnings("unchecked")
  public <T> Promise<T> queue(final Task<Promise<T>> promiseFactory) {
    return current =
        current.thenPromise(
            new Function<Object, Promise>() {
              @Override
              public Promise apply(Object arg) throws FunctionException {
                return promiseFactory.run();
              }
            });
  }

