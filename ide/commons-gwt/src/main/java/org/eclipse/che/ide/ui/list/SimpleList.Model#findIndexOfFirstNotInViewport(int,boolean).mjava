    /**
     * Returns the index of the first item that is not fully in the viewport. If all items are, it
     * will return the last item in the given direction.
     */
    private int findIndexOfFirstNotInViewport(int beginIndex, boolean forward) {
      final int deltaIndex = forward ? 1 : -1;
      int i = beginIndex;
      for (; i >= 0 && i < size(); i += deltaIndex) {
        if (!DomUtils.isFullyInScrollViewport(container, listItems.get(i))) {
          return i;
        }
      }

      return i + -deltaIndex;
    }

