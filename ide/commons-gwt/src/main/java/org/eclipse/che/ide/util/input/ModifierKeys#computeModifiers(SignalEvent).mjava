  /**
   * Like {@link #computeExactModifiers(KeyboardEvent)} except computes the shift bit depending on
   * {@link KeyCodeMap#needsShift(int)}.
   */
  public static int computeModifiers(SignalEvent event) {
    int modifiers =
        computeModifiersExceptShift(event.getMetaKey(), event.getCtrlKey(), event.getAltKey());

    // Only add shift if it isn't changing the charCode (lower to upper case).
    int keyCode = KeyCodeMap.getKeyFromEvent(event);
    if (event.getShiftKey() && !KeyCodeMap.needsShift(keyCode)) {
      modifiers |= SHIFT;
    }

    return modifiers;
  }

