  /**
   * Depending on the supplied direction, it will call either findMatchAfterIndex or
   * findMatchBeforeIndex. Once the result is obtained it will return either the match index or the
   * appropriate bound column (text.length() or -1).
   */
  private static int directionalRegexp(boolean forward, RegExp regexp, String text, int column) {
    MatchResult result =
        forward
            ? RegExpUtils.findMatchAfterIndex(regexp, text, column)
            : RegExpUtils.findMatchBeforeIndex(regexp, text, column);
    int fallback = forward ? text.length() : -1;
    return result == null ? fallback : result.getIndex();
  }

