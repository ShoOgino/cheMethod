  public List<Match> fuzzyMatch(String word, String wordToMatch, boolean substringMatch) {

    RegExp regExp = regExpCache.get(word);
    if (regExp == null) {
      regExp = convertWordToRegExp(word);
      regExpCache.put(word, regExp);
    }

    MatchResult matchResult = regExp.exec(wordToMatch);
    if (matchResult != null) {
      return Collections.singletonList(
          new Match(
              matchResult.getIndex(), matchResult.getIndex() + matchResult.getGroup(0).length()));
    }

    if (substringMatch) {
      return FUZZY_SEPARATE.match(word, wordToMatch);
    } else {
      return FUZZY_CONTIGUOUS.match(word, wordToMatch);
    }
  }

