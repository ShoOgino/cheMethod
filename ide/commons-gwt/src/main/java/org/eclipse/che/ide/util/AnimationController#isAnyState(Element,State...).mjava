  /**
   * Check if the element is in any of the specified states.
   *
   * @param states the states to check, null is not allowed
   * @return true if in any one of the states
   */
  // Visible for testing.
  boolean isAnyState(Element element, State... states) {
    // Get the state ordinal from the attribute.
    String ordinalStr = element.getAttribute(ATTR_STATE);

    // NOTE: The following NULL check makes a dramatic performance impact!
    if (ordinalStr == null) {
      return false;
    }

    int ordinal = -1;
    try {
      ordinal = Integer.parseInt(ordinalStr);
    } catch (NumberFormatException e) {
      // The element's state has not been initialized yet.
      return false;
    }

    for (State state : states) {
      if (ordinal == state.ordinal()) {
        return true;
      }
    }
    return false;
  }

