  @Test
  public void shouldRunConnectionManagerInitializeConnectionOnInitialize()
      throws OperationException {
    initializer.initialize("id", "http://test.com");
    verify(promise).then(operation.capture());
    operation.getValue().apply("token");
    verify(securityTokenProvider).getSecurityToken();
    verify(connectionManager).initializeConnection("http://test.com?token=token");
  }

