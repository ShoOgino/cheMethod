  public PopupWidget(final PopupResources popupResources, String title) {
    this.popupResources = popupResources;

    popupElement = Elements.createDivElement(popupResources.popupStyle().popup());

    Element headerElement = Elements.createDivElement(popupResources.popupStyle().header());
    headerElement.setInnerText(title);
    popupElement.appendChild(headerElement);

    popupBodyElement = Elements.createDivElement(popupResources.popupStyle().body());
    popupElement.appendChild(popupBodyElement);

    listElement = Elements.createUListElement();
    popupBodyElement.appendChild(listElement);

    popupListener =
        new EventListener() {
          @Override
          public void handleEvent(final Event evt) {
            if (evt instanceof MouseEvent) {
              final MouseEvent mouseEvent = (MouseEvent) evt;
              final EventTarget target = mouseEvent.getTarget();
              if (target instanceof Element) {
                final Element elementTarget = (Element) target;
                if (!PopupWidget.this.popupElement.contains(elementTarget)) {
                  hide();
                  evt.preventDefault();
                }
              }
            }
            // else won't happen
          }
        };

    keyboardListener = new PopupKeyDownListener(this, this.listElement);
  }

