    /**
     * Creates new dropdown widget.
     * Uses the given {@code emptyStateWidget} for displaying an empty list's state.
     */
    public DropdownList(Widget emptyStateWidget) {
        itemListWidgets = new HashMap<>();
        itemHeaderWidgets = new HashMap<>();

        this.emptyStateWidget = emptyStateWidget;

        initWidget(UI_BINDER.createAndBindUi(this));

        dropButtonPanel.getElement().appendChild(RESOURCES.expansionImage().getSvg().getElement());

        dropdownContentPanel = new FlowPanel();
        dropdownContentPanel.ensureDebugId("dropdown-list-content-panel");

        dropdownPopupPanel = new PopupPanel(true);
        dropdownPopupPanel.removeStyleName("gwt-PopupPanel");
        dropdownPopupPanel.addStyleName(RESOURCES.dropdownListCss().itemsPanel());
        dropdownPopupPanel.setAnimationEnabled(true);
        dropdownPopupPanel.addAutoHidePartner(getElement());
        dropdownPopupPanel.setAnimationType(ROLL_DOWN);
        dropdownPopupPanel.add(new ScrollPanel(dropdownContentPanel));

        attachEventHandlers();
        setSelectedItem(null);

        setWidth(DEFAULT_WIDGET_WIDTH_PX + "px");
    }

