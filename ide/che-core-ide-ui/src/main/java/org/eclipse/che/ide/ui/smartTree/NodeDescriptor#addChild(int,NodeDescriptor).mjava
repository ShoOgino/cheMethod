    protected void addChild(int index, NodeDescriptor child) {
        final int actualIndex;

        if (nodeStorage.isSorted()) {
            int insertPos = Collections.binarySearch(children, child, nodeStorage.buildFullComparator());
            actualIndex = insertPos < 0 ? (-insertPos - 1) : insertPos;
        } else {
            actualIndex = index;
        }

        children.add(actualIndex, child);
        child.parent = this;
    }

