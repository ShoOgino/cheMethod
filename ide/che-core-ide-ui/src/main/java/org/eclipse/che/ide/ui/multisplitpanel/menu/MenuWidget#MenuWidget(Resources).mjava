    @Inject
    public MenuWidget(Resources resources) {
        this.resources = resources;
        resources.css().ensureInjected();

        initWidget(UI_BINDER.createAndBindUi(this));

        closeTime = System.currentTimeMillis();
        addDomHandler(new MouseDownHandler() {
            @Override
            public void onMouseDown(MouseDownEvent event) {
                long time = System.currentTimeMillis();
                if (time - closeTime < 100) {
                    return;
                }
                showList();
            }
        }, MouseDownEvent.getType());

        listPanel = new FlowPanel();
        listPanel.addStyleName(resources.css().listItemPanel());

        popupPanel = new PopupPanel();
        popupPanel.setAutoHideEnabled(true);
        popupPanel.removeStyleName(GWT_POPUP_STANDARD_STYLE);
        popupPanel.add(listPanel);

        popupPanel.addCloseHandler(new CloseHandler<PopupPanel>() {
            @Override
            public void onClose(CloseEvent<PopupPanel> event) {
                closeTime = System.currentTimeMillis();
            }
        });
    }

