    protected void doSingleSelect(Node node, boolean suppressEvent) {
        int index;
        index = nodeStorage.indexOf(node);
        if (index == -1 || isSelected(node)) {
            return;
        } else {
            if (!suppressEvent) {
                BeforeSelectionEvent<Node> evt = BeforeSelectionEvent.fire(this, node);
                if (evt != null && evt.isCanceled()) {
                    return;
                }
            }
        }

        boolean change = false;
        if (selectionStorage.size() > 0 && !isSelected(node)) {
            doDeselect(Collections.singletonList(lastSelectedNode), true);
            change = true;
        }

        if (selectionStorage.size() == 0) {
            change = true;
        }

        selectionStorage.add(node);
        lastSelectedNode = node;
        onSelectChange(node, true);
        setLastFocused(lastSelectedNode);

        if (!suppressEvent) {
            SelectionEvent.fire(this, node);
        }

        if (change && !suppressEvent) {
            fireSelectionChange();
        }
    }

