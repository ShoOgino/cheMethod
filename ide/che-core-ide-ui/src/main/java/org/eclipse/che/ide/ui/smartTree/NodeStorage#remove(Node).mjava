    public boolean remove(Node node) {
        NodeDescriptor nodeDescriptor = idToNodeMap.get(getKeyProvider().getKey(node));
        if (nodeDescriptor != null) {
            Node parent = getParent(node);
            List<Node> children = getAllChildren(node);
            int visibleIndex = nodeDescriptor.getParent().getChildren().indexOf(nodeDescriptor);
            nodeDescriptor.getParent().remove(nodeDescriptor);
            if (visibleIndex != -1) {
                fireEvent(new StoreRemoveEvent(visibleIndex, node, parent, children));
            } else {
                List<NodeDescriptor> descriptors = new LinkedList<>();
                descriptors.add(nodeDescriptor);
                for (int i = 0; i < descriptors.size(); i++) {
                    nodeDescriptor = descriptors.get(i);
                    descriptors.addAll(nodeDescriptor.getChildren());

                    idToNodeMap.remove(getKeyProvider().getKey(nodeDescriptor.getNode()));
                }
            }
            return true;
        }
        return false;
    }

