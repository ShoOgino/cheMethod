    private void select(Element elementToSelect) {
        if (elementToSelect == null) {
            return;
        }

        Element currentSelectedElement = getSelectedElement();
        if (currentSelectedElement == null) {
            elementToSelect.setAttribute("selected", "true");
            return;
        }

        if (currentSelectedElement.isEqualNode(elementToSelect)) {
            return;
        }

        currentSelectedElement.removeAttribute("selected");
        elementToSelect.setAttribute("selected", "true");
    }

