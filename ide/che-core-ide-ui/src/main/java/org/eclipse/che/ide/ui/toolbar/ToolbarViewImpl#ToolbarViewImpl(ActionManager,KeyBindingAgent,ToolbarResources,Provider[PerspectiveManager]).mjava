  /** Create view with given instance of resources. */
  @Inject
  public ToolbarViewImpl(
      ActionManager actionManager,
      KeyBindingAgent keyBindingAgent,
      ToolbarResources toolbarResources,
      Provider<PerspectiveManager> managerProvider) {
    this.actionManager = actionManager;
    this.keyBindingAgent = keyBindingAgent;
    this.managerProvider = managerProvider;
    this.toolbarResources = toolbarResources;

    toolbarResources.toolbar().ensureInjected();

    setStyleName(toolbarResources.toolbar().toolbarPanel());

    leftVisibleGroupActions = new ArrayList<>();
    centerVisibleGroupActions = new ArrayList<>();
    rightVisibleGroupActions = new ArrayList<>();
    presentationFactory = new PresentationFactory();
    leftToolbar = new FlowPanel();
    centerToolbar = new FlowPanel();
    rightToolbar = new FlowPanel();
    timer =
        new Timer() {
          @Override
          public void run() {
            updateActions();
            schedule(DELAY_MILLIS);
          }
        };

    leftToolbar.addStyleName(toolbarResources.toolbar().leftToolbarPart());
    add(leftToolbar);

    centerToolbar.addStyleName(toolbarResources.toolbar().centerToolbarPart());
    add(centerToolbar);

    rightToolbar.addStyleName(toolbarResources.toolbar().rightToolbarPart());
    add(rightToolbar);

    if (!timer.isRunning()) {
      timer.schedule(DELAY_MILLIS);
    }
  }

