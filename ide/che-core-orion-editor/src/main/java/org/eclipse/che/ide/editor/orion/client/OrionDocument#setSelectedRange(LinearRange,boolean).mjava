    /** {@inheritDoc} */
    @Override
    public void setSelectedRange(LinearRange range, boolean show) {
        int startOffset = range.getStartOffset();
        editorOverlay.setSelection(startOffset, startOffset + range.getLength(), show);

        TextPosition position = getPositionFromIndex(startOffset);
        if (show && position != null) {
            int lineNumber = position.getLine();
            int topIndex = lineNumber - MARGIN_TOP;
            editorOverlay.getTextView().setTopIndex(topIndex > 0 ? topIndex : 0);
        }
    }

