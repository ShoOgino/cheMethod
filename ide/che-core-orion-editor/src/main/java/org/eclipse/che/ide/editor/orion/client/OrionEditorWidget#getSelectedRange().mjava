  @Override
  public Region getSelectedRange() {
    final OrionSelectionOverlay selection = this.editorOverlay.getSelection();

    final int start = selection.getStart();
    final int end = selection.getEnd();

    if (start < 0 || end > this.editorOverlay.getModel().getCharCount() || start > end) {
      throw new RuntimeException("Invalid selection");
    }
    return new RegionImpl(start, end - start);
  }

