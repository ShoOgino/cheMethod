  private AsyncRequest diff(
      Path project,
      List<String> fileFilter,
      DiffType type,
      boolean noRenames,
      int renameLimit,
      String commitA,
      String commitB,
      boolean cached) {
    StringBuilder params =
        new StringBuilder()
            .append("?projectPath=")
            .append(encodePath(project))
            .append("&noRenames=")
            .append(noRenames)
            .append("&renameLimit=")
            .append(renameLimit)
            .append("&cached=")
            .append(cached);
    if (fileFilter != null) {
      fileFilter
          .stream()
          .filter(file -> !file.isEmpty())
          .forEach(file -> params.append("&fileFilter=").append(encodePath(valueOf(file))));
    }
    if (type != null) {
      params.append("&diffType=").append(type);
    }
    if (commitA != null) {
      params.append("&commitA=").append(commitA);
    }
    if (commitB != null) {
      params.append("&commitB=").append(commitB);
    }
    String url = getWsAgentBaseUrl() + DIFF + params;
    return asyncRequestFactory.createGetRequest(url).loader(loader);
  }

