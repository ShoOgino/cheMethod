  private String getShebang(final String content) {
    final MatchResult matchResult = SHEBANG_PATTERN.exec(content);

    if (matchResult == null
        || matchResult.getGroup(1) == null
        || matchResult.getGroup(1).isEmpty()) {
      return null;
    }
    Log.debug(FirstLineFileTypeIdentifier.class, "File may be a script with a shebang.");
    String loader = matchResult.getGroup(1);

    // special case for /usr/bin/env
    if ("/usr/bin/env".equals(loader)) {
      Log.debug(
          FirstLineFileTypeIdentifier.class,
          "Shebang points to /usr/bin/env. Looking at the parameter.");
      // we must use the first option as hint
      if (matchResult.getGroup(2) == null || matchResult.getGroup(2).isEmpty()) {
        return null;
      }
      loader = matchResult.getGroup(2);
      Log.debug(FirstLineFileTypeIdentifier.class, "Shebang parameter kept: " + loader);
    } else {
      Log.debug(FirstLineFileTypeIdentifier.class, "Shebang loader kept: " + loader);
    }
    return loader;
  }

