  private Iterator<Annotation> getRegionAnnotationIterator(
      int offset, int length, boolean canStartBefore, boolean canEndAfter) {

    cleanup(true);

    try {
      List<Position> positions =
          positionHolder.getPositions(offset, length, canStartBefore, canEndAfter);
      return new AnnotationsIterator(positions, this.positions);

    } catch (BadPositionCategoryException e) {
      // can happen if e.g. the document doesn't contain such a category, or when removed in a
      // different thread
      return Collections.<Annotation>emptyList().iterator();
    }
  }

