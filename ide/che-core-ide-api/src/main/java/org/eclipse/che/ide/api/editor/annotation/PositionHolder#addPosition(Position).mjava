  public void addPosition(Position position) throws BadLocationException {
    if ((0 > position.offset)
        || (0 > position.length)
        || (position.offset + position.length > document.getContentsCharCount()))
      throw new BadLocationException();

    positions.add(computeIndexInPositionList(positions, position.offset, true), position);
  }

