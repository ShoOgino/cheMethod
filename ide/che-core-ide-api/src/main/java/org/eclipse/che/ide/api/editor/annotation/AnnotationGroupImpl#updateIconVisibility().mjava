  private void updateIconVisibility() {
    int maxLayer = 0;
    final HTMLCollection children = asElemental().getChildren();
    for (int i = 0; i < children.length(); i++) {
      final Node child = (Node) children.at(i);
      if (child instanceof elemental.dom.Element) {
        final elemental.dom.Element element = (elemental.dom.Element) child;
        final Mappable dataset = element.getDataset();
        final int layer = getLayer(dataset);
        if (maxLayer < layer) {
          maxLayer = layer;
        }
      }
    }

    for (int i = 0; i < children.length(); i++) {
      final Node child = (Node) children.at(i);
      if (child instanceof elemental.dom.Element) {
        final elemental.dom.Element element = (elemental.dom.Element) child;
        final Mappable dataset = element.getDataset();
        final int layer = getLayer(dataset);
        if (layer >= maxLayer) {
          element.getStyle().removeProperty("display");
        } else {
          element.getStyle().setDisplay("none");
        }
      }
    }
  }

