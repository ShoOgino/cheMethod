    public DocReadyWrapper(final EventBus generalEventBus, final EditorHandle editor,
                           @Nullable final DocReadyInit<T> init, final T wrapped) {
        this.editorHandle = editor;
        this.docReadyInit = init;
        this.wrapped = wrapped;
        this.docReadyRegistration = generalEventBus.addHandler(DocumentReadyEvent.TYPE,
                                                               new DocumentReadyHandler() {

                                                                   public void onDocumentReady(final DocumentReadyEvent event) {
                                                                       if (event == null) {
                                                                           return;
                                                                       }
                                                                       if (event.getEditorHandle() == null) {
                                                                           return;
                                                                       }
                                                                       EditorHandle eventHandle = event.getEditorHandle();
                                                                       EditorHandle constantHandle = editorHandle;
                                                                       boolean equal = eventHandle.equals(constantHandle);
                                                                       if (!equal) {
                                                                           return;
                                                                       }
                                                                       // stop listening DocReady events
                                                                       if (docReadyRegistration != null) {
                                                                           docReadyRegistration.removeHandler();
                                                                       }
                       documentHandle = event.getDocument().getDocumentHandle();

                       final DocReadyInit<T> initializer = DocReadyWrapper.this.docReadyInit;
                       if (initializer != null) {
                           initializer.initialize(documentHandle, DocReadyWrapper.this.wrapped);
                       }
                   }
               });
    }

