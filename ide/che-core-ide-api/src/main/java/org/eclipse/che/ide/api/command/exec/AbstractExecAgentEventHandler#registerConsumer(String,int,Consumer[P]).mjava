    public void registerConsumer(String endpointId, int pid, Consumer<P> consumer) {
        String key = endpointId + '@' + pid;
        if (!operationRegistry.containsKey(key)) {
            operationRegistry.put(key, new HashSet<>());
        }

        operationRegistry.get(key).add(consumer);
    }

