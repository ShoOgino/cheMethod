  @Test(
    expectedExceptions = ServerException.class,
    expectedExceptionsMessageRegExp = "agent launcher test exception"
  )
  public void shouldThrowServerExceptionIfMachineExceptionIsThrownByAgentCheck() throws Exception {
    // given
    when(agentChecker.isLaunched(any(Agent.class), any(InstanceProcess.class), any(Instance.class)))
        .thenThrow(new MachineException("agent launcher test exception"));

    // when
    launcher.launch(machine, agent);
  }

