    /** Synchronously stops corresponding services. */
    private void doStopServices() {
        LOG.info("Preparing system to shutdown");
        eventService.publish(new SystemStatusChangedEvent(RUNNING, PREPARING_TO_SHUTDOWN));
        try {
            terminator.terminateAll();
            statusRef.set(READY_TO_SHUTDOWN);
            eventService.publish(new SystemStatusChangedEvent(PREPARING_TO_SHUTDOWN, READY_TO_SHUTDOWN));
            LOG.info("System is ready to shutdown");
        } catch (InterruptedException x) {
            LOG.error("Interrupted while waiting for system service to shutdown components");
            Thread.currentThread().interrupt();
        } finally {
            shutdownLatch.countDown();
        }
    }

