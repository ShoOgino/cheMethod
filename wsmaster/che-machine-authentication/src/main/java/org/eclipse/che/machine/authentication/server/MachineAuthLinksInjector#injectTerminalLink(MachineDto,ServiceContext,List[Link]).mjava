    @VisibleForTesting
    @Override
    protected void injectTerminalLink(MachineDto machine, ServiceContext serviceContext, List<Link> links) {
        if (machine.getRuntime() != null) {
            final String machineToken = getMachineToken(machine);
            final String scheme = serviceContext.getBaseUriBuilder().build().getScheme();
            final Collection<ServerDto> servers = machine.getRuntime().getServers().values();
            servers.stream()
                   .filter(server -> TERMINAL_REFERENCE.equals(server.getRef()))
                   .findAny()
                   .ifPresent(terminal -> links.add(createLink("GET",
                                                               UriBuilder.fromUri(terminal.getUrl())
                                                                         .scheme("https".equals(scheme) ? "wss"
                                                                                                        : "ws")
                                                                         .queryParam("token", machineToken)
                                                                         .path("/pty")
                                                                         .build()
                                                                         .toString(),
                                                               TERMINAL_REFERENCE)));
        }
    }

