    /**
     * Generates new machine security token for given user and workspace.
     *
     * @param userId
     *         id of user to generate token for
     * @param workspaceId
     *         id of workspace to generate token for
     * @return generated token value
     */
    public String generateToken(String userId, String workspaceId) {
        lock.writeLock().lock();
        try {
            final String token = generate("machine", 128);
            tokens.put(workspaceId, userId, token);
            return token;
        } finally {
            lock.writeLock().unlock();
        }
    }

