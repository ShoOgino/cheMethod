  @Override
  protected void injectExecAgentLink(
      MachineDto machine, ServiceContext serviceContext, List<Link> links) {
    final String scheme = serviceContext.getBaseUriBuilder().build().getScheme();
    if (machine.getRuntime() != null) {
      final String machineToken = getMachineToken(machine);
      final Collection<ServerDto> servers = machine.getRuntime().getServers().values();
      servers
          .stream()
          .filter(server -> EXEC_AGENT_REFERENCE.equals(server.getRef()))
          .findAny()
          .ifPresent(
              exec ->
                  links.add(
                      createLink(
                          "GET",
                          UriBuilder.fromUri(exec.getUrl())
                              .scheme("https".equals(scheme) ? "wss" : "ws")
                              .queryParam("token", machineToken)
                              .path("/connect")
                              .build()
                              .toString(),
                          EXEC_AGENT_REFERENCE)));
    }
  }

