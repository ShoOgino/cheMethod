    @DELETE
    @Path("token")
    @RolesAllowed({"user", "temp_user"})
    public void invalidate(@Required @QueryParam("oauth_provider") String oauthProvider)
            throws BadRequestException, NotFoundException, ServerException, ForbiddenException {

        OAuthAuthenticator oauth = getAuthenticator(oauthProvider);
        final Subject subject = EnvironmentContext.getCurrent().getSubject();
        try {
            if (!oauth.invalidateToken(subject.getUserId())) {
                throw new NotFoundException("OAuth token for user " + subject.getUserId() + " was not found");
            }
        } catch (IOException e) {
            throw new ServerException(e.getMessage());
        }
    }

