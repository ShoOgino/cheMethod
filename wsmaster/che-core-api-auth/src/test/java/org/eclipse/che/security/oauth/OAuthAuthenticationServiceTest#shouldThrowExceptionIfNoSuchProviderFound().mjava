  @Test
  public void shouldThrowExceptionIfNoSuchProviderFound() throws Exception {
    final Response response =
        given()
            .auth()
            .basic(ADMIN_USER_NAME, ADMIN_USER_PASSWORD)
            .contentType("application/json")
            .when()
            .queryParam("oauth_provider", "unknown")
            .get(SECURE_PATH + "/oauth/token");

    assertEquals(response.getStatusCode(), 400);
    assertEquals(
        DtoFactory.getInstance()
            .createDtoFromJson(response.getBody().asInputStream(), ServiceError.class)
            .getMessage(),
        "Unsupported OAuth provider unknown");
  }

