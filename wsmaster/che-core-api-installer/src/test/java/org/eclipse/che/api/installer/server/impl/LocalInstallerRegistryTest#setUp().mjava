  @BeforeMethod
  public void setUp() throws Exception {
    installerDao = new MapBasedInstallerDao();

    when(installer1v1.getId()).thenReturn("installer1");
    when(installer1v1.getVersion()).thenReturn("v1");

    when(installer1latest.getId()).thenReturn("installer1");
    when(installer1latest.getVersion()).thenReturn("latest");

    when(installer2latest.getId()).thenReturn("installer2");
    when(installer2latest.getVersion()).thenReturn(null); // Default version

    when(installer3latest.getId()).thenReturn("installer3");
    when(installer3latest.getVersion()).thenReturn("latest");

    registry =
        new LocalInstallerRegistry(
            ImmutableSet.of(installer1v1, installer1latest, installer2latest, installer3latest),
            installerDao);
  }

