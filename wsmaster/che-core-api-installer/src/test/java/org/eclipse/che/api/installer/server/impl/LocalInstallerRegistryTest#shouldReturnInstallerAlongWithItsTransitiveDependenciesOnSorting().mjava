  @Test
  public void shouldReturnInstallerAlongWithItsTransitiveDependenciesOnSorting() throws Exception {
    when(installer1v1.getDependencies()).thenReturn(singletonList("installer2:latest"));
    when(installer2latest.getDependencies()).thenReturn(singletonList("installer3"));

    installerDao.update(new InstallerImpl(installer1v1));
    installerDao.update(new InstallerImpl(installer2latest));

    List<Installer> sorted = registry.getOrderedInstallers(singletonList("installer1:v1"));

    assertEquals(sorted.size(), 3);
    assertEquals(InstallerFqn.of(sorted.get(0)).toString(), "installer3:latest");
    assertEquals(InstallerFqn.of(sorted.get(1)).toString(), "installer2:latest");
    assertEquals(InstallerFqn.of(sorted.get(2)).toString(), "installer1:v1");
  }

