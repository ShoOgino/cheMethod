  @Test
  public void sortInstallersRespectingDependencies() throws Exception {
    when(installer1v1.getDependencies()).thenReturn(asList("installer2", "installer3"));
    when(installer2v1.getDependencies()).thenReturn(singletonList("installer3"));

    installerDao.update(new InstallerImpl(installer1v1));
    installerDao.update(new InstallerImpl(installer2v1));

    List<Installer> sorted =
        registry.getOrderedInstallers(asList("installer1:1.0.0", "installer2", "installer3"));

    assertEquals(sorted.size(), 3);
    assertEquals(InstallerFqn.of(sorted.get(0)).toString(), "installer3:1.0.0");
    assertEquals(InstallerFqn.of(sorted.get(1)).toString(), "installer2:1.0.0");
    assertEquals(InstallerFqn.of(sorted.get(2)).toString(), "installer1:1.0.0");
  }

