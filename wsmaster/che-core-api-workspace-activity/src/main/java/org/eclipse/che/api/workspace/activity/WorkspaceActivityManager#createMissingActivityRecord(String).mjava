  private void createMissingActivityRecord(String workspaceId)
      throws ServerException, ConflictException, NotFoundException {
    Workspace workspace = workspaceManager.getWorkspace(workspaceId);
    long createdTime =
        Long.parseLong(workspace.getAttributes().get(Constants.CREATED_ATTRIBUTE_NAME));

    WorkspaceActivity activity = new WorkspaceActivity();
    activity.setWorkspaceId(workspaceId);
    activity.setCreated(createdTime);
    activity.setStatus(WorkspaceStatus.RUNNING);
    activity.setLastRunning(clock.millis());

    long idleTimeout = getIdleTimeout(workspaceId);
    if (idleTimeout > 0) {
      // only set the expiration if it is used
      activity.setExpiration(clock.millis() + idleTimeout);
    }

    activityDao.createActivity(activity);
  }

