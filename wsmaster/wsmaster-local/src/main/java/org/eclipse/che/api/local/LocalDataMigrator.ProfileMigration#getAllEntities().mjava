        @Override
        public List<ProfileImpl> getAllEntities() throws Exception {
            final Collection<OldProfile> profiles = storage.loadMap(new TypeToken<Map<String, OldProfile>>() {}).values();
            profiles.stream()
                    .filter(profile -> profile.id != null)
                    .forEach(profile -> profile.setUserId(profile.id));
            return new ArrayList<>(profiles);
        }

