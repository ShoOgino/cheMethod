    @PreDestroy
    @VisibleForTesting
    void saveSshPairs() throws IOException {
        lock.readLock().lock();
        try {
            final HashMap<String, List<SshPairImpl>> ownerToPairs = new HashMap<>();
            for (Map.Entry<String, SshPairImpl> entry : pairs.entries()) {
                ownerToPairs.computeIfAbsent(entry.getKey(), s -> new ArrayList<>());
                ownerToPairs.get(entry.getKey()).add(entry.getValue());
            }
            sshStorage.store(ownerToPairs);
        } finally {
            lock.readLock().unlock();
        }
    }

