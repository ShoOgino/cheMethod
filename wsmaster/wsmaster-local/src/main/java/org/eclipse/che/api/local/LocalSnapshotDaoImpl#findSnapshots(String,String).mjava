    @Override
    public synchronized List<SnapshotImpl> findSnapshots(String namespace, String workspaceId) throws SnapshotException {
        return snapshots.values()
                        .stream()
                        .filter(snapshot -> snapshot.getNamespace().equals(namespace) && snapshot.getWorkspaceId().equals(workspaceId))
                        .collect(toList());
    }

