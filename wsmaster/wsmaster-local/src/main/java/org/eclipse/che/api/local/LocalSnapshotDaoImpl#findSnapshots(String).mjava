    @Override
    public synchronized List<SnapshotImpl> findSnapshots(String workspaceId) throws SnapshotException {
        requireNonNull(workspaceId, "Required non-null workspace id");
        return snapshots.values()
                        .stream()
                        .filter(snapshot -> snapshot.getWorkspaceId().equals(workspaceId))
                        .collect(toList());
    }

