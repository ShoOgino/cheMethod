    @Override
    public StackImpl update(StackImpl update) throws NotFoundException, ServerException {
        requireNonNull(update, "Stack required");
        requireNonNull(update.getId(), "Stack id required");
        lock.writeLock().lock();
        try {
            String updateId = update.getId();
            if (!stacks.containsKey(updateId)) {
                throw new NotFoundException(format("Stack with id %s was not found", updateId));
            }
            stacks.replace(updateId, update);
            return new StackImpl(update);
        } finally {
            lock.writeLock().unlock();
        }
    }

