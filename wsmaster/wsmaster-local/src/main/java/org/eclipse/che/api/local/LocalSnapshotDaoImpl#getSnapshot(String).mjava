    @Override
    public synchronized SnapshotImpl getSnapshot(String snapshotId) throws NotFoundException, SnapshotException {
        requireNonNull(snapshotId, "Required non-null snapshot id");
        final SnapshotImpl snapshot = snapshots.get(snapshotId);
        if (snapshot == null) {
            throw new NotFoundException("Snapshot with id '" + snapshotId + "' doesn't exist");
        }
        return snapshot;
    }

