    @Override
    public synchronized void update(ProfileImpl profile) throws NotFoundException {
        requireNonNull(profile, "Required non-null profile");
        final Profile myProfile = profiles.get(profile.getUserId());
        if (myProfile == null) {
            throw new NotFoundException(format("Profile with id '%s' not found", profile.getUserId()));
        }
        myProfile.getAttributes().clear();
        myProfile.getAttributes().putAll(profile.getAttributes());
    }

