    @Override
    public synchronized void removeSnapshot(String snapshotId) throws NotFoundException, SnapshotException {
        requireNonNull(snapshotId, "Required non-null snapshot id");
        if (!snapshots.containsKey(snapshotId)) {
            throw new NotFoundException(format("Snapshot with id '%s' doesn't exist", snapshotId));
        }
        snapshots.remove(snapshotId);
    }

