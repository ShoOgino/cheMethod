    @Override
    public String authenticate(String aliasOrNameOrEmail, String password) throws UnauthorizedException, ServerException {
        requireNonNull(aliasOrNameOrEmail);
        requireNonNull(password);
        rwLock.readLock().lock();
        try {
            final Optional<UserImpl> userOpt = users.values()
                                                    .stream()
                                                    .filter(user -> user.getName().equals(aliasOrNameOrEmail)
                                                                    || user.getEmail().equals(aliasOrNameOrEmail)
                                                                    || user.getAliases().contains(aliasOrNameOrEmail))
                                                    .findAny();
            if (!userOpt.isPresent() || !userOpt.get().getPassword().equals(password)) {
                throw new UnauthorizedException(format("Authentication failed for user '%s'", aliasOrNameOrEmail));
            }
            return userOpt.get().getId();
        } finally {
            rwLock.readLock().unlock();
        }
    }

