    @Override
    public void create(ProfileImpl profile) throws ConflictException {
        requireNonNull(profile, "Required non-null profile");
        lock.writeLock().lock();
        try {
            if (profiles.containsKey(profile.getUserId())) {
                throw new ConflictException(format("Profile for user '%s' already exists", profile.getUserId()));
            }
            profiles.put(profile.getUserId(), new ProfileImpl(profile));
        } finally {
            lock.writeLock().unlock();
        }
    }

