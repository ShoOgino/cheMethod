    @Override
    protected void configure() {
        final String dbUrl = System.getProperty("jdbc.url");
        final String dbUser = System.getProperty("jdbc.user");
        final String dbPassword = System.getProperty("jdbc.password");

        waitConnectionIsEstablished(dbUrl, dbUser, dbPassword);

        // jpa
        install(new PersistTestModuleBuilder().setDriver(Driver.class)
                                              .setUrl(dbUrl)
                                              .setUser(dbUser)
                                              .setPassword(dbPassword)
                                              .setExceptionHandler(PostgreSqlExceptionHandler.class)
                                              .addEntityClasses(AccountImpl.class,
                                                                UserImpl.class,
                                                                ProfileImpl.class,
                                                                PreferenceEntity.class,
                                                                WorkspaceImpl.class,
                                                                WorkspaceConfigImpl.class,
                                                                ProjectConfigImpl.class,
                                                                EnvironmentImpl.class,
                                                                RecipeImpl.class,
                                                                MachineConfigImpl.class,
                                                                SourceStorageImpl.class,
                                                                ServerConfigImpl.class,
                                                                StackImpl.class,
                                                                CommandImpl.class,
                                                                SshPairImpl.class)
                                              .addEntityClass("org.eclipse.che.api.workspace.server.model.impl.ProjectConfigImpl$Attribute")
                                              .build());
        bind(TckResourcesCleaner.class).to(JpaCleaner.class);

        // db initialization
        bind(DBInitializer.class).asEagerSingleton();
        final PGSimpleDataSource dataSource = new PGSimpleDataSource();
        dataSource.setUser(dbUser);
        dataSource.setPassword(dbPassword);
        dataSource.setUrl(dbUrl);
        bind(SchemaInitializer.class).toInstance(new FlywaySchemaInitializer(dataSource, "che-schema"));

        // account
        bind(AccountDao.class).to(JpaAccountDao.class);
        bind(new TypeLiteral<TckRepository<AccountImpl>>() {}).toInstance(new JpaTckRepository<>(AccountImpl.class));

        // user
        bind(UserDao.class).to(JpaUserDao.class);
        bind(ProfileDao.class).to(JpaProfileDao.class);
        bind(PreferenceDao.class).to(JpaPreferenceDao.class);
        bind(new TypeLiteral<TckRepository<UserImpl>>() {}).to(UserRepo.class);
        bind(new TypeLiteral<TckRepository<Pair<String, Map<String, String>>>>() {}).to(PreferencesRepo.class);
        bind(new TypeLiteral<TckRepository<ProfileImpl>>() {}).toInstance(new JpaTckRepository<>(ProfileImpl.class));
        bind(PasswordEncryptor.class).to(SHA512PasswordEncryptor.class);

        // machine
        bind(RecipeDao.class).to(JpaRecipeDao.class);
        bind(new TypeLiteral<TckRepository<RecipeImpl>>() {}).toInstance(new JpaTckRepository<>(RecipeImpl.class));
        bind(new TypeLiteral<TckRepository<Workspace>>() {}).toInstance(new WorkspaceRepoForSnapshots());

        // ssh
        bind(SshDao.class).to(JpaSshDao.class);
        bind(new TypeLiteral<TckRepository<SshPairImpl>>() {}).toInstance(new JpaTckRepository<>(SshPairImpl.class));

        // workspace
        bind(WorkspaceDao.class).to(JpaWorkspaceDao.class);
        bind(StackDao.class).to(JpaStackDao.class);
        bind(new TypeLiteral<TckRepository<WorkspaceImpl>>() {}).toInstance(new WorkspaceRepository());
        bind(new TypeLiteral<TckRepository<StackImpl>>() {}).toInstance(new StackRepository());
    }

