  /**
   * Creates {@link WorkspaceConfigImpl} from given devfile with integrity validation
   *
   * @param devfile source devfile
   * @param fileContentProvider content provider for recipe-type component
   * @return created {@link WorkspaceConfigImpl} instance
   * @throws DevfileFormatException when devfile integrity validation fail
   * @throws DevfileRecipeFormatException when devfile recipe format is invalid
   * @throws DevfileException when any another devfile related error occurs
   */
  public WorkspaceConfigImpl createWorkspaceConfig(
      Devfile devfile, FileContentProvider fileContentProvider)
      throws DevfileFormatException, DevfileRecipeFormatException, DevfileException {
    checkArgument(devfile != null, "Devfile must not be null");
    checkArgument(fileContentProvider != null, "File content provider must not be null");

    FileContentProvider cachingProvider = FileContentProvider.cached(fileContentProvider);

    integrityValidator.validateDevfile(devfile);
    integrityValidator.validateContentReferences(devfile, cachingProvider);
    return devfileConverter.devFileToWorkspaceConfig(devfile, cachingProvider);
  }

