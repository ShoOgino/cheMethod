  private void fillInCommands(WorkspaceConfigImpl config, Devfile devfile)
      throws DevfileFormatException {
    Map<String, Tool> tools = devfile.getTools().stream().collect(toMap(Tool::getName, identity()));
    List<CommandImpl> commands = new ArrayList<>();

    for (Command devCommand : devfile.getCommands()) {
      if (devCommand.getActions().size() != 1) {
        throw new DevfileFormatException(
            format("Command `%s` MUST has one and only one action", devCommand.getName()));
      }
      Action commandAction = devCommand.getActions().get(0);

      Tool toolOfCommand = tools.get(commandAction.getTool());

      if (toolOfCommand == null) {
        throw new DevfileFormatException(
            String.format(
                "Action of the command '%s' references missing tool '%s'",
                devCommand.getName(), commandAction.getTool()));
      }

      commands.add(devCommandToCommandImpl(devCommand, commandAction, toolOfCommand));
    }

    config.setCommands(commands);
  }

