  @Test
  public void shouldProvisionPluginWorkspaceAttributeDuringCheEditorToolApplying()
      throws Exception {
    // given
    Tool superPluginTool = new Tool();
    superPluginTool.setName("super-plugin");
    superPluginTool.setId("org.eclipse.che.super-plugin:0.0.1");
    superPluginTool.setType(PLUGIN_TOOL_TYPE);

    Tool customPluginTool = new Tool();
    customPluginTool.setName("custom");
    customPluginTool.setId("custom-plugin:v1");
    customPluginTool.setType(PLUGIN_TOOL_TYPE);

    WorkspaceConfigImpl workspaceConfig = new WorkspaceConfigImpl();

    // when
    pluginToolApplier.apply(workspaceConfig, superPluginTool, null);
    pluginToolApplier.apply(workspaceConfig, customPluginTool, null);

    // then
    String workspaceTooling =
        workspaceConfig.getAttributes().get(WORKSPACE_TOOLING_PLUGINS_ATTRIBUTE);
    assertTrue(workspaceTooling.matches("(.+:.+),(.+:.+)"));
    assertTrue(workspaceTooling.contains("org.eclipse.che.super-plugin:0.0.1"));
    assertTrue(workspaceTooling.contains("custom-plugin:v1"));
    String toollingAliases =
        workspaceConfig.getAttributes().get(PLUGINS_TOOLS_ALIASES_WORKSPACE_ATTRIBUTE);
    assertTrue(toollingAliases.matches("(.+:.+=.+),(.+:.+=.+)"));
    assertTrue(toollingAliases.contains("org.eclipse.che.super-plugin:0.0.1=super-plugin"));
    assertTrue(toollingAliases.contains("custom-plugin:v1=custom"));
  }

