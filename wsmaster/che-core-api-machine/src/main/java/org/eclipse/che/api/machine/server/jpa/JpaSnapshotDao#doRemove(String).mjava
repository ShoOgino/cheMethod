  @Transactional
  protected void doRemove(String snapshotId) throws NotFoundException {
    final EntityManager manager = managerProvider.get();
    final SnapshotImpl snapshot = manager.find(SnapshotImpl.class, snapshotId);
    if (snapshot == null) {
      throw new NotFoundException(format("Snapshot with id '%s' doesn't exist", snapshotId));
    }
    manager.remove(snapshot);
  }

