    @Test
    public void shouldNotCopyHeadersFromRequestIfTheyAreIgnored() throws Exception {
        Map<String, List<String>> headers = new HashMap<>();
        headers.put("Host", Collections.singletonList("www.w3.org"));
        //ignored headers
        headers.put(null, Collections.singletonList("HTTP/1.1 200 OK"));
        headers.put("Connection", Collections.singletonList("close"));
        headers.put("Keep-Alive", Collections.singletonList("timeout=600"));
        headers.put("Proxy-Authentication", Collections.singletonList("value"));
        headers.put("Proxy-Authorization", Collections.singletonList("username:password"));
        headers.put("TE", Collections.singletonList("value"));
        headers.put("Trailers", Collections.singletonList("Expires"));
        headers.put("Transfer-Encoding", Collections.singletonList("chunked"));
        headers.put("Upgrade", Collections.singletonList("websocket"));

        Map<String, List<String>> requiredHeaders = new HashMap<>();
        requiredHeaders.put("Accept", Collections.singletonList("application/json"));
        requiredHeaders.put("X-Forwarded-Host", Collections.singletonList("www.w3.org"));
        requiredHeaders.put("User-Agent", Collections.singletonList("Java"));
        requiredHeaders.put("Connection", Collections.singletonList("keep-alive"));

        headers.putAll(requiredHeaders);

        MockHttpServletRequest mockRequest =
                new MockHttpServletRequest(DEFAULT_URL,
                                           new ByteArrayInputStream(new byte[0]),
                                           0,
                                           "GET",
                                           headers);

        final MockHttpServletResponse mockResponse = new MockHttpServletResponse();

        proxyServlet.service(mockRequest, mockResponse);

        assertEquals(mockResponse.getStatus(), 200);
        // should not be copied to headers of request to extension API
        extensionApiRequest.headers.remove("Host");

        assertEqualsHeaders(extensionApiRequest.headers, requiredHeaders);
    }

