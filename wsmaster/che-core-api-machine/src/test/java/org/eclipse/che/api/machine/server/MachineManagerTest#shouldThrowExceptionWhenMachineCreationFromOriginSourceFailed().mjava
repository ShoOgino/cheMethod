    @Test(expectedExceptions = MachineException.class)
    public void shouldThrowExceptionWhenMachineCreationFromOriginSourceFailed() throws Exception {
        final MachineConfigImpl config = createMachineConfig();
        when(manager.generateMachineId()).thenReturn(MACHINE_ID);

        when(instanceProvider.createInstance(any(MachineImpl.class),
                                             any(LineConsumer.class))).thenThrow(new MachineException(""));

        manager.recoverMachine(config, WS_ID, ENVIRONMENT_NAME, logConsumer);
    }

