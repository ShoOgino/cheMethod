    @BeforeMethod
    public void setUpMethod() throws Exception {
        String serverAddress = "localhost:" + jettyServer.getURI().getPort();
        Map<String, ServerImpl> machineServers = Collections.singletonMap(String.valueOf(EXTENSIONS_API_PORT),
                                                                          new ServerImpl(null,
                                                                                         "http",
                                                                                         serverAddress,
                                                                                         null,
                                                                                         "http://" + serverAddress));

        machineManager = mock(MachineManager.class);

        machine = mock(MachineImpl.class);

        machineRuntimeInfo = mock(MachineRuntimeInfoImpl.class);

        extensionApiResponse = spy(new ExtensionApiResponse());

        extensionApiRequest = new ExtensionApiRequest();

        proxyServlet = new MachineExtensionProxyServlet(EXTENSIONS_API_PORT, machineManager);

        when(machineManager.getDevMachine(WORKSPACE_ID)).thenReturn(machine);
        when(machine.getRuntime()).thenReturn(machineRuntimeInfo);
        when(machineRuntimeInfo.getServers()).thenReturn(machineServers);
    }

