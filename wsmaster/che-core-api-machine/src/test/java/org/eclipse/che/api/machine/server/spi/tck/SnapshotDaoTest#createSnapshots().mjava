  @BeforeMethod
  private void createSnapshots() throws TckRepositoryException {
    // one account for all the workspaces
    final AccountImpl account = new AccountImpl("account1", "name", "type");

    // workspaces
    workspaces = new TestWorkspace[SNAPSHOTS_SIZE / 3];
    for (int i = 0; i < workspaces.length; i++) {
      workspaces[i] = new TestWorkspace("workspace-" + i, account.getId());
    }

    // snapshots
    snapshots = new SnapshotImpl[SNAPSHOTS_SIZE];
    for (int i = 0; i < SNAPSHOTS_SIZE; i++) {
      snapshots[i] =
          createSnapshot(
              "snapshot-" + i,
              workspaces[i / 3].getId(), // 3 snapshot share the same workspace id
              "environment-" + i / 2, // 2 snapshots share the same env name
              "machine-" + i);
    }

    accountRepo.createAll(singletonList(account));
    workspaceRepo.createAll(asList(workspaces));
    snaphotRepo.createAll(asList(snapshots));
  }

