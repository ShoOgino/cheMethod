    @Test(expectedExceptions = BadRequestException.class, expectedExceptionsMessageRegExp = "Invalid machine name @name!")
    public void shouldThrowExceptionOnMachineCreationIfMachineNameIsInvalid() throws Exception {
        when(recipeDownloader.getRecipe(any(MachineConfig.class))).thenReturn(new RecipeImpl().withScript("script")
                                                                                              .withType("Dockerfile"));

        MachineConfig machineConfig = new MachineConfigImpl(false,
                                                            "@name!",
                                                            "machineType",
                                                            new MachineSourceImpl("Dockerfile", "location"),
                                                            new LimitsImpl(1024),
                                                            Arrays.asList(new ServerConfImpl("ref1",
                                                                                             "8080",
                                                                                             "https",
                                                                                             "some/path"),
                                                                          new ServerConfImpl("ref2",
                                                                                             "9090/udp",
                                                                                             "someprotocol",
                                                                                             "/some/path")),
                                                            Collections.singletonMap("key1", "value1"),
                                                            null);
        String workspaceId = "wsId";
        String environmentName = "env1";

        manager.createMachineSync(machineConfig, workspaceId, environmentName);
    }

