    @Test
    public void shouldThrowNotFoundExceptionWhenUpdatingNonExistingFactory() throws Exception {
        final Factory factory = createFactoryWithStorage(FACTORY_NAME,
                                                         "git",
                                                         "http://github.com/codenvy/platform-api.git");
        doThrow(new NotFoundException(format("Factory with id %s is not found.", FACTORY_ID))).when(factoryManager)
                                                                                              .getById(anyString());

        final Response response = given().auth().basic(ADMIN_USER_NAME, ADMIN_USER_PASSWORD)
                                         .contentType(APPLICATION_JSON)
                                         .body(JsonHelper.toJson(factory))
                                         .when()
                                         .put(SERVICE_PATH + "/" + FACTORY_ID);

        assertEquals(response.getStatusCode(), 404);
        assertEquals(DTO.createDtoFromJson(response.getBody().asString(), ServiceError.class).getMessage(),
                     format("Factory with id %s is not found.", FACTORY_ID));
    }

