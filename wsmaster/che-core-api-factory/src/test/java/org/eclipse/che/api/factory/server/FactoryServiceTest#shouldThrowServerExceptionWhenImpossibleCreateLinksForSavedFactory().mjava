    @Test
    public void shouldThrowServerExceptionWhenImpossibleCreateLinksForSavedFactory() throws Exception {
        // given
        Factory factory = prepareFactoryWithGivenStorage("git", "http://github.com/codenvy/che-core.git");
        factory.withCreator(dto.createDto(Author.class).withName("username"));
        doThrow(UnsupportedEncodingException.class).when(factoryStore).getFactory(anyString());

        // when, then
        Response response = given().auth()
                                   .basic(JettyHttpServer.ADMIN_USER_NAME, JettyHttpServer.ADMIN_USER_PASSWORD)
                                   .contentType(ContentType.JSON)
                                   .body("{}")
                                   .post("/private" + SERVICE_PATH);
        assertEquals(response.getStatusCode(), Status.INTERNAL_SERVER_ERROR.getStatusCode());
    }

