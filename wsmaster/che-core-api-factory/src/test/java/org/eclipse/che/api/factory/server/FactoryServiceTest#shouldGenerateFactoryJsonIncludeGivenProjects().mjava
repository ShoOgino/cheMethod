    @Test
    public void shouldGenerateFactoryJsonIncludeGivenProjects() throws Exception {
        // given
        final String wsId = "workspace123234";
        WorkspaceImpl.WorkspaceImplBuilder ws = WorkspaceImpl.builder();
        WorkspaceConfigImpl.WorkspaceConfigImplBuilder wsConfig = WorkspaceConfigImpl.builder();
        ws.setId(wsId);
        wsConfig.setProjects(Arrays.asList(dto.createDto(ProjectConfigDto.class)
                                        .withPath("/proj1")
                                        .withSource(dto.createDto(SourceStorageDto.class)
                                                       .withType("git")
                                                       .withLocation("location")),
                                     dto.createDto(ProjectConfigDto.class)
                                        .withPath("/proj2")
                                        .withSource(dto.createDto(SourceStorageDto.class)
                                                       .withType("git")
                                                       .withLocation("location"))));
        wsConfig.setName("wsname");
        ws.setNamespace("id-2314");
        wsConfig.setEnvironments(Collections.singletonList(dto.createDto(EnvironmentDto.class).withName("env1")));
        wsConfig.setDefaultEnv("env1");
        ws.setStatus(WorkspaceStatus.RUNNING);
        wsConfig.setCommands(Collections.singletonList(dto.createDto(CommandDto.class)
                                                    .withName("MCI")
                                                    .withType("mvn")
                                                    .withCommandLine("clean install")));
        ws.setConfig(wsConfig.build());
        WorkspaceImpl usersWorkspace = ws.build();
        when(workspaceManager.getWorkspace(eq(wsId))).thenReturn(usersWorkspace);

        // when
        Response response = given().auth()
                                   .basic(JettyHttpServer.ADMIN_USER_NAME, JettyHttpServer.ADMIN_USER_PASSWORD)
                                   .when()
                                   .get("/private" + SERVICE_PATH + "/workspace/" + wsId);

        // then
        assertEquals(response.getStatusCode(), 200);
        Factory result = dto.createDtoFromJson(response.getBody().asString(), Factory.class);
        assertEquals(result.getWorkspace().getProjects().size(), 2);
    }

