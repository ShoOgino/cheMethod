    @Test
    public void shouldThrowServerExceptionWhenProvidedFactoryDataInvalid() throws Exception {
        final String errMessage = "eof";
        doThrow(new IOException(errMessage)).when(factoryBuilderSpy).build(any(InputStream.class));
        final Response response = given().auth()
                                         .basic(ADMIN_USER_NAME, ADMIN_USER_PASSWORD)
                                         .multiPart("factory", "any content", FACTORY_IMAGE_MIME_TYPE)
                                         .expect()
                                         .statusCode(500)
                                         .when()
                                         .post(SERVICE_PATH);

        final ServiceError err = getFromResponse(response, ServiceError.class);
        assertEquals(err.getMessage(), errMessage);
    }

