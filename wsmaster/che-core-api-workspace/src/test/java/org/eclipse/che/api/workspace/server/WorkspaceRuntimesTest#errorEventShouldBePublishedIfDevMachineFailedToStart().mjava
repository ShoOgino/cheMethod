    @Test
    public void errorEventShouldBePublishedIfDevMachineFailedToStart() throws Exception {
        // given
        WorkspaceImpl workspace = createWorkspace();
        when(environmentEngine.start(anyString(),
                                     anyString(),
                                     any(Environment.class),
                                     anyBoolean(),
                                     any()))
                .thenReturn(singletonList(createMachine(false)));

        try {
            // when
            runtimes.start(workspace,
                           workspace.getConfig().getDefaultEnv(),
                           false);

        } catch (Exception e) {
            // then
            verify(runtimes).publishWorkspaceEvent(EventType.ERROR,
                                                   workspace.getId(),
                                                   e.getLocalizedMessage());
        }
    }

