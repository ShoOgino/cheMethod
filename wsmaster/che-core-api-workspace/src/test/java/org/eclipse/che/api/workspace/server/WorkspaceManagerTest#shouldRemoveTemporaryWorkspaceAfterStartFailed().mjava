    @Test
    public void shouldRemoveTemporaryWorkspaceAfterStartFailed() throws Exception {
        WorkspaceImpl workspace = createAndMockWorkspace();
        workspace.setTemporary(true);
        createAndMockDescriptor(workspace, RUNNING);
        doThrow(new ServerException("")).when(runtimes).stop(workspace.getId());

        workspaceManager.stopWorkspace(workspace.getId());

        captureAsyncTaskAndExecuteSynchronously();
        verify(workspaceDao).remove(workspace.getId());
    }

