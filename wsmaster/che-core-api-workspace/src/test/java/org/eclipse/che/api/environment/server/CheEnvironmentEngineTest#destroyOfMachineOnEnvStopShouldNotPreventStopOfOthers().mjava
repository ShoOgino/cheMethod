    @Test
    public void destroyOfMachineOnEnvStopShouldNotPreventStopOfOthers() throws Exception {
        // given
        List<Instance> instances = startEnv();
        Instance instance = instances.get(0);
        doThrow(new MachineException("test exception")).when(instance).destroy();
        assertTrue(instances.size() > 1, "This test requires at least 2 instances in environment");

        // when
        engine.stop(instance.getWorkspaceId());

        // then
        InOrder inOrder = inOrder(instances.toArray());
        for (Instance instance1 : instances) {
            inOrder.verify(instance1).destroy();
        }
    }

