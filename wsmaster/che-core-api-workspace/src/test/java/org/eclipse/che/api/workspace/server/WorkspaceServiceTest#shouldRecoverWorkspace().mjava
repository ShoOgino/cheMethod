    @Test
    public void shouldRecoverWorkspace() throws Exception {
        final WorkspaceImpl workspace = createWorkspace(createConfigDto());
        when(wsManager.recoverWorkspace(any(), any(), any())).thenReturn(workspace);
        when(wsManager.getWorkspace(workspace.getId())).thenReturn(workspace);

        final Response response = given().auth()
                                         .basic(ADMIN_USER_NAME, ADMIN_USER_PASSWORD)
                                         .when()
                                         .post(SECURE_PATH + "/workspace/" + workspace.getId() + "/runtime/snapshot" +
                                               "?environment=" + workspace.getConfig().getDefaultEnv());

        assertEquals(response.getStatusCode(), 200);
        assertEquals(new WorkspaceImpl(unwrapDto(response, WorkspaceDto.class)), workspace);
        verify(permissionManager).checkPermission(eq(Constants.START_WORKSPACE), any(), any());
        verify(wsManager).recoverWorkspace(workspace.getId(), workspace.getConfig().getDefaultEnv(), null);
    }

