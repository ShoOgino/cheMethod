    @Test
    public void removesTemporaryWorkspaceAfterStop() throws Exception {
        final WorkspaceImpl workspace = createAndMockWorkspace();
        workspace.setTemporary(true);
        mockRuntime(workspace, RUNNING);

        workspaceManager.stopWorkspace(workspace.getId(), emptyMap());

        captureRunAsyncCallsAndRunSynchronously();
        verify(runtimes).stop(workspace.getId(), emptyMap());
        verify(workspaceDao).remove(workspace.getId());
    }

