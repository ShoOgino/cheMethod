    @BeforeMethod
    public void prepare() throws Exception {
        environment = spy(createEnv());
        composeEnv = spy(createComposeEnv());
        when(machineInstanceProviders.hasProvider("docker")).thenReturn(true);
        when(machineInstanceProviders.getProviderTypes()).thenReturn(asList("docker", "ssh"));
        when(environmentParser.parse(any(Environment.class))).thenReturn(composeEnv);
        when(environmentParser.getEnvironmentTypes()).thenReturn(singletonList("compose"));
    }

