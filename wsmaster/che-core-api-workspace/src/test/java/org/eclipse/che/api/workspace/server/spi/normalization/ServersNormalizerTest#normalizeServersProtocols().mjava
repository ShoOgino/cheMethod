  @Test
  public void normalizeServersProtocols() throws InfrastructureException {
    ServerConfigImpl serverWithoutProtocol = new ServerConfigImpl("8080", "http", "/api");
    ServerConfigImpl udpServer = new ServerConfigImpl("8080/udp", "http", "/api");
    ServerConfigImpl normalizedServer = new ServerConfigImpl("8080/tcp", "http", "/api");
    HashMap<String, ServerConfig> machine1Servers = new HashMap<>();
    machine1Servers.put("serverWithoutProtocol", serverWithoutProtocol);
    when(machine1.getServers()).thenReturn(machine1Servers);

    HashMap<String, ServerConfig> machine2Servers = new HashMap<>();
    machine2Servers.put("serverWithoutProtocol", serverWithoutProtocol);
    machine2Servers.put("udpServer", udpServer);
    when(machine2.getServers()).thenReturn(machine2Servers);

    serversNormalizer.normalize(internalEnvironment);

    assertEquals(machine1Servers, ImmutableMap.of("serverWithoutProtocol", normalizedServer));
    assertEquals(
        machine2Servers,
        ImmutableMap.of("serverWithoutProtocol", normalizedServer, "udpServer", udpServer));
  }

