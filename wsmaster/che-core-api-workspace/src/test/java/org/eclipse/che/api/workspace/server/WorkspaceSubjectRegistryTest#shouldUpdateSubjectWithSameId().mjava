  @Test
  public void shouldUpdateSubjectWithSameId() throws Exception {
    final String workspaceId = "myWorkspaceId";
    when(event.getEventType()).thenReturn(WorkspaceStatusEvent.EventType.STARTING);
    when(event.getWorkspaceId()).thenReturn(workspaceId);
    Subject workspaceStarter = new SubjectImpl("user", "userId", "userToken", false);
    EnvironmentContext.getCurrent().setSubject(workspaceStarter);
    workspaceSubjectRegistry.onEvent(event);

    Subject updatedSubject = new SubjectImpl("newUserName", "userId", "newUserToken", false);
    workspaceSubjectRegistry.updateSubject(updatedSubject);
    assertTrue(workspaceSubjectRegistry.getWorkspaceStarter(workspaceId) == updatedSubject);
  }

