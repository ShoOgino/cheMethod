  @BeforeMethod
  public void setUp() throws Exception {
    agentConfigApplier = new AgentConfigApplier(sorter, agentRegistry);
    when(agentRegistry.getAgent(AgentKeyImpl.parse("agent1"))).thenReturn(agent1);
    when(agentRegistry.getAgent(AgentKeyImpl.parse("agent2"))).thenReturn(agent2);
    when(agentRegistry.getAgent(AgentKeyImpl.parse("agent3"))).thenReturn(agent3);

    when(agent1.getScript()).thenReturn("script1");
    when(agent1.getDependencies()).thenReturn(singletonList("fqn3"));

    when(agent2.getScript()).thenReturn("script2");
    when(agent2.getDependencies()).thenReturn(singletonList("fqn3"));

    when(agent3.getScript()).thenReturn("script3");
  }

