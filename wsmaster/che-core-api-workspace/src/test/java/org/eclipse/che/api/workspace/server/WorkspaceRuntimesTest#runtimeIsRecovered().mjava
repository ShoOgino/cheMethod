    @Test
    public void runtimeIsRecovered() throws Exception {
        RuntimeIdentity identity = new RuntimeIdentityImpl("workspace123", "my-env", "me");

        mockWorkspace(identity);
        RuntimeContext context = mockContext(identity);
        when(context.getRuntime()).thenReturn(new TestInternalRuntime(context));
        doReturn(context).when(infrastructure).prepare(eq(identity), anyObject());

        // try recover
        runtimes.recoverOne(infrastructure, identity);

        WorkspaceImpl workspace = new WorkspaceImpl(identity.getWorkspaceId(), null, null);
        runtimes.injectRuntime(workspace);
        assertNotNull(workspace.getRuntime());
    }

