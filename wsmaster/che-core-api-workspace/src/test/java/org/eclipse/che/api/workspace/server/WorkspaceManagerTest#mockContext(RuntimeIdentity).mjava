    private RuntimeContext mockContext(RuntimeIdentity identity) throws Exception {
        RuntimeContext context = mock(RuntimeContext.class);
        doReturn(context).when(infrastructure).prepare(eq(identity), anyObject());
        when(context.getInfrastructure()).thenReturn(infrastructure);
        when(context.getIdentity()).thenReturn(identity);
        return context;
    }

