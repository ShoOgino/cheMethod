    @Test
    public void shouldAddExposedPorts() throws Exception {
        when(sorter.sort(any()))
                .thenReturn(Arrays.asList(AgentKeyImpl.parse("agent1"), AgentKeyImpl.parse("agent2"), AgentKeyImpl.parse("agent3")));
        when(agent1.getProperties()).thenReturn(singletonMap("ports", "terminal:1111/udp,terminal:2222/tcp"));
        when(agent2.getProperties()).thenReturn(singletonMap("ports", "3333/udp"));
        ComposeServiceImpl composeService = new ComposeServiceImpl();

        agentConfigApplier.modify(composeService, Arrays.asList("agent1", "agent2", "agent3"));

        List<String> exposedPorts = composeService.getExpose();
        assertTrue(exposedPorts.contains("1111/udp"));
        assertTrue(exposedPorts.contains("2222/tcp"));
        assertTrue(exposedPorts.contains("3333/udp"));
    }

