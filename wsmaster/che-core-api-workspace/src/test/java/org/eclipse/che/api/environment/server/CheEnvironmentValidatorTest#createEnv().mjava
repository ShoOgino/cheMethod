    private static EnvironmentDto createEnv() {
        // singletonMap, asList are wrapped into modifiable collections to ease env modifying by tests
        EnvironmentImpl env = new EnvironmentImpl();
        Map<String, MachineConfigImpl> machines = new HashMap<>();
        Map<String, ServerConfigImpl> servers = new HashMap<>();

        servers.put("ref1", new ServerConfigImpl("8080/tcp",
                                                 "proto1",
                                                 "path1"));
        servers.put("ref2", new ServerConfigImpl("8080/udp", "proto1", null));
        servers.put("ref3", new ServerConfigImpl("9090", "proto1", null));
        machines.put("dev-machine", new MachineConfigImpl(asList("org.eclipse.che.ws-agent", "someAgent"),
                                                          servers,
                                                          singletonMap("memoryLimitBytes", "10000")));
        machines.put("machine2", new MachineConfigImpl(asList("someAgent2", "someAgent3"),
                                                       null,
                                                       singletonMap("memoryLimitBytes", "10000")));
        env.setRecipe(new RecipeImpl("compose",
                                     "application/x-yaml",
                                     "content",
                                     null));
        env.setMachines(machines);

        return DtoConverter.asDto(env);
    }

