    private RuntimeDescriptor createDescriptor(WorkspaceImpl workspace, WorkspaceStatus status) {
        final WorkspaceRuntimeImpl runtime = new WorkspaceRuntimeImpl(workspace.getConfig().getDefaultEnv());
        final String env = workspace.getConfig().getDefaultEnv();
        for (MachineConfigImpl machineConfig : workspace.getConfig()
                                                        .getEnvironment(workspace.getConfig().getDefaultEnv())
                                                        .get()
                                                        .getMachineConfigs()) {
            final MachineImpl machine = MachineImpl.builder()
                                                   .setConfig(machineConfig)
                                                   .setEnvName(env)
                                                   .setId(NameGenerator.generate("machine", 10))
                                                   .setOwner(workspace.getNamespace())
                                                   .setRuntime(new MachineRuntimeInfoImpl(emptyMap(), emptyMap(), emptyMap()))
                                                   .setWorkspaceId(workspace.getId())
                                                   .build();
            if (machineConfig.isDev()) {
                runtime.setDevMachine(machine);
            }
            runtime.getMachines().add(machine);
        }
        final RuntimeDescriptor descriptor = mock(RuntimeDescriptor.class);
        when(descriptor.getRuntimeStatus()).thenReturn(status);
        when(descriptor.getRuntime()).thenReturn(runtime);
        return descriptor;
    }

