  @Test
  public void shouldBeAbleToStopMachine() throws Exception {
    // given
    List<Instance> instances = startEnv();
    Optional<Instance> instanceOpt =
        instances.stream().filter(machine -> !machine.getConfig().isDev()).findAny();
    assertTrue(instanceOpt.isPresent(), "Required for test non-dev machine is not found");
    Instance instance = instanceOpt.get();

    // when
    engine.stopMachine(instance.getWorkspaceId(), instance.getId());

    // then
    verify(instance).destroy();
  }

