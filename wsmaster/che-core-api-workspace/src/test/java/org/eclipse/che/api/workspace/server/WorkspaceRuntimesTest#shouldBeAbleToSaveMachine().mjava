    @Test
    public void shouldBeAbleToSaveMachine() throws Exception {
        // when
        WorkspaceImpl workspace = createWorkspace();
        runtimes.start(workspace,
                       workspace.getConfig().getDefaultEnv(),
                       false);
        SnapshotImpl snapshot = mock(SnapshotImpl.class);
        when(runtimes.saveMachine(workspace.getNamespace(), workspace.getId(), "machineId")).thenReturn(snapshot);

        // when
        SnapshotImpl actualSnapshot = runtimes.saveMachine(workspace.getNamespace(), workspace.getId(), "machineId");

        // then
        assertEquals(actualSnapshot, snapshot);
        verify(environmentEngine).saveSnapshot(workspace.getNamespace(), workspace.getId(), "machineId");
    }

