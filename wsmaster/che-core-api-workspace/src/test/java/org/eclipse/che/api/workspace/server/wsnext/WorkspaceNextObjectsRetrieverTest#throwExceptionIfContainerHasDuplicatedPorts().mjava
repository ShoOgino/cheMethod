  @Test(
    expectedExceptions = InfrastructureException.class,
    expectedExceptionsMessageRegExp = "Containers contain duplicated exposed ports."
  )
  public void throwExceptionIfContainerHasDuplicatedPorts() throws Exception {
    ChePlugin plugin = testPlugin();
    List<CheContainerPort> containerPorts = plugin.getContainers().get(0).getPorts();
    CheContainerPort containerPort = new CheContainerPort().exposedPort(101010);
    containerPorts.add(containerPort);
    containerPorts.add(containerPort);
    doReturn(plugin).when(retriever).getBody(any(URI.class), eq(ChePlugin.class));
    CheFeature cheFeature = testFeature();
    doReturn(cheFeature).when(retriever).getBody(any(URI.class), eq(CheFeature.class));

    retriever.get(SINGLE_FEATURE_ATTRIBUTES);
  }

