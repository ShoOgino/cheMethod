    @Test
    public void workspaceShouldNotHaveRuntimeIfEnvStartFails() throws Exception {
        // given
        when(envEngine.start(anyString(),
                             anyString(),
                             any(Environment.class),
                             anyBoolean(),
                             any()))
                .thenThrow(new ServerException("Test env start error"));
        WorkspaceImpl workspaceMock = createWorkspace();

        try {
            // when
            runtimes.start(workspaceMock,
                           workspaceMock.getConfig().getDefaultEnv(),
                           false);
        } catch (Exception ex) {
            // then
            assertFalse(runtimes.hasRuntime(workspaceMock.getId()));
        }
    }

