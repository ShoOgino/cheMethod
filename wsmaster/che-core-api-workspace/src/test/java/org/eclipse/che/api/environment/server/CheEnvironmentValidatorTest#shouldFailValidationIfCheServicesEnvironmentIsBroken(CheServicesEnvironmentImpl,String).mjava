    @Test(dataProvider = "invalidServicesEnvironmentProvider")
    public void shouldFailValidationIfCheServicesEnvironmentIsBroken(CheServicesEnvironmentImpl cheServicesEnv,
                                                                     String expectedExceptionMessage)
            throws Exception {

        // given
        when(environmentParser.parse(any(Environment.class))).thenReturn(cheServicesEnv);

        try {
            // when
            environmentValidator.validate("env", environment);

            // then
            fail(format("Validation had to throw exception with message %s",
                        expectedExceptionMessage));
        } catch (IllegalArgumentException e) {
            // then
            assertEquals(e.getLocalizedMessage(), expectedExceptionMessage);
        }
    }

