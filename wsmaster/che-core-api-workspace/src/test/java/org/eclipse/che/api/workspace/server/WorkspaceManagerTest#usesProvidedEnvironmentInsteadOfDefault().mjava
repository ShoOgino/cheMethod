    @Test
    public void usesProvidedEnvironmentInsteadOfDefault() throws Exception {
        WorkspaceConfigImpl config = createConfig();
        config.getEnvironments().put("non-default-env", new EnvironmentImpl(null, null));
        WorkspaceImpl workspace = createAndMockWorkspace(config, NAMESPACE);
        mockStart(workspace);

        workspaceManager.startWorkspace(workspace.getId(), "non-default-env", false);

        verify(runtimes).startAsync(workspaceCaptor.capture(), eq("non-default-env"), eq(false));
        assertEquals(workspaceCaptor.getValue().getConfig(), config);
    }

