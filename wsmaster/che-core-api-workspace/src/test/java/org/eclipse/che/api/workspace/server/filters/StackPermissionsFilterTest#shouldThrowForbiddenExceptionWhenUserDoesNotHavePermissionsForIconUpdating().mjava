  @Test
  public void shouldThrowForbiddenExceptionWhenUserDoesNotHavePermissionsForIconUpdating() {
    when(subject.hasPermission("stack", "stack123", UPDATE)).thenReturn(false);

    final Response response =
        given()
            .auth()
            .basic(ADMIN_USER_NAME, ADMIN_USER_PASSWORD)
            .contentType("multipart/form-data")
            .multiPart("icon", "content", "image/png")
            .when()
            .post(SECURE_PATH + "/stack/stack123/icon");

    assertEquals(response.getStatusCode(), 403);
    Assert.assertEquals(
        unwrapError(response),
        "The user does not have permission to " + UPDATE + " stack with id 'stack123'");
    verifyZeroInteractions(service);
  }

