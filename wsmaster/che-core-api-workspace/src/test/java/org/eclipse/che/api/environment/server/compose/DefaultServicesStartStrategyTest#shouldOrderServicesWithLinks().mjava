  @Test
  public void shouldOrderServicesWithLinks() throws Exception {
    // given
    CheServicesEnvironmentImpl composeEnvironment = new CheServicesEnvironmentImpl();
    composeEnvironment
        .getServices()
        .put("second", new CheServiceImpl().withLinks(singletonList("first:alias")));
    composeEnvironment
        .getServices()
        .put("third", new CheServiceImpl().withLinks(asList("first", "second")));
    composeEnvironment.getServices().put("first", new CheServiceImpl().withLinks(emptyList()));
    composeEnvironment
        .getServices()
        .put("forth", new CheServiceImpl().withLinks(singletonList("third")));
    composeEnvironment
        .getServices()
        .put("fifth", new CheServiceImpl().withLinks(asList("forth:alias", "first:alias")));
    List<String> expected = asList("first", "second", "third", "forth", "fifth");

    // when
    List<String> actual = strategy.order(composeEnvironment);

    // then
    assertEquals(actual, expected);
  }

