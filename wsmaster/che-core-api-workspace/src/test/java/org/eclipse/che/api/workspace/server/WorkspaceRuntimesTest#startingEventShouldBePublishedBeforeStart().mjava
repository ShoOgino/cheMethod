    @Test
    public void startingEventShouldBePublishedBeforeStart() throws Exception {
        final WorkspaceImpl workspace = createWorkspace();
        runtimes = spy(new WorkspaceRuntimes(machineManagerMock, eventService));
        doNothing().when(runtimes).publishEvent(any(), any(), any());

        doAnswer(invocation -> {
            verify(runtimes).publishEvent(EventType.STARTING, workspace.getId(), null);
            return null;
        }).when(machineManagerMock).createMachineSync(any(), any(), any());

        runtimes.start(workspace, workspace.getConfig().getDefaultEnv());
    }

