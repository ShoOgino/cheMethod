  @Test
  public void testFeaturesWithParameter() throws Exception {
    CheFeature cheFeature =
        testFeature(
            TEST_PLUGIN, TEST_PLUGIN_VERSION, TEST_PLUGIN_PARAM_NAME, TEST_PLUGIN_PARAM_VALUE);
    ChePlugin plugin = testPluginWithEnv(TEST_PLUGIN_ENV_NAME, TEST_PLUGIN_PARAM_PLACEHOLDER);
    doReturn(cheFeature).when(retriever).getBody(any(URI.class), eq(CheFeature.class));
    doReturn(plugin).when(retriever).getBody(any(URI.class), eq(ChePlugin.class));

    Collection<ChePlugin> plugins = retriever.get(SINGLE_FEATURE_ATTRIBUTES);

    assertEquals(
        plugins,
        singletonList(expectedPluginWithEnv(TEST_PLUGIN_ENV_NAME, TEST_PLUGIN_PARAM_VALUE)));
  }

