  @Test
  public void shouldFindStacksWithSpecifiedTags() throws Exception {
    stacks.get(0).getTags().addAll(asList("search-tag1", "search-tag2"));
    stacks.get(1).getTags().addAll(asList("search-tag1", "non-search-tag"));
    stacks.get(2).getTags().addAll(asList("non-search-tag", "search-tag2"));
    stacks.get(3).getTags().addAll(asList("search-tag1", "search-tag2", "another-tag"));
    updateAll();

    final List<StackImpl> found =
        stackDao.searchStacks(null, asList("search-tag1", "search-tag2"), 0, 0);
    found.forEach(s -> Collections.sort(s.getTags()));
    for (StackImpl stack : stacks) {
      Collections.sort(stack.getTags());
    }

    assertEquals(new HashSet<>(found), new HashSet<>(asList(stacks.get(0), stacks.get(3))));
  }

