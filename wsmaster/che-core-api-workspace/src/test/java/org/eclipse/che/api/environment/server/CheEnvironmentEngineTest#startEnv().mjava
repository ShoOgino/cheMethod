    private List<Instance> startEnv() throws Exception {
        EnvironmentImpl env = createEnv();
        String envName = "env-1";
        String workspaceId = "wsId";
        when(composeProvider.startService(anyString(),
                                          eq(workspaceId),
                                          eq(envName),
                                          anyString(),
                                          anyString(),
                                          anyBoolean(),
                                          anyString(),
                                          any(ComposeServiceImpl.class),
                                          any(LineConsumer.class)))
                .thenAnswer(invocationOnMock -> {
                    Object[] arguments = invocationOnMock.getArguments();
                    String machineId = (String)arguments[3];
                    String machineName = (String)arguments[4];
                    boolean isDev = (boolean)arguments[5];
                    ComposeServiceImpl service = (ComposeServiceImpl)arguments[7];
                    Machine machine = createMachine(machineId,
                                                    workspaceId,
                                                    envName,
                                                    service,
                                                    machineName,
                                                    isDev);
                    return spy(new NoOpMachineInstance(machine));
                });

        // when
        return engine.start(workspaceId,
                            envName,
                            env,
                            false,
                            messageConsumer);
    }

