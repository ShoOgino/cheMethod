    @Test(expectedExceptions = ServerException.class, expectedExceptionsMessageRegExp = "Test exception")
    public void shouldThrowExceptionIfMachineManagerExecInDevMachineThrowsBadRequestException() throws Exception {
        when(machineProcessManager.exec(anyString(),
                                        anyString(),
                                        any(Command.class),
                                        anyString()))
                .thenThrow(new BadRequestException("Test exception"));

        wsAgentLauncher.launch(machine, agent);

        verify(machineProcessManager).exec(anyString(),
                                           anyString(),
                                           any(Command.class),
                                           anyString());
    }

