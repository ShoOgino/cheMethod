    @Test(dataProvider = "invalidComposeEnvironmentProvider")
    public void shouldFailValidationIfComposeEnvironmentIsBroken(ComposeEnvironmentImpl composeEnv,
                                                                 String expectedExceptionMessage)
            throws Exception {

        // given
        when(environmentParser.parse(any(Environment.class))).thenReturn(composeEnv);

        try {
            // when
            environmentValidator.validate("env", environment);

            // then
            fail(format("Validation had to throw exception with message %s",
                        expectedExceptionMessage));
        } catch (IllegalArgumentException e) {
            // then
            assertEquals(e.getLocalizedMessage(), expectedExceptionMessage);
        }
    }

