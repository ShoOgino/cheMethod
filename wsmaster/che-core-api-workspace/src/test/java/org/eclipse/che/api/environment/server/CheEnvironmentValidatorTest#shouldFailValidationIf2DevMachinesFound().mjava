    @Test(expectedExceptions = IllegalArgumentException.class,
          expectedExceptionsMessageRegExp = "Environment '.*' should contain exactly 1 dev machine, but contains '2'")
    public void shouldFailValidationIf2DevMachinesFound() throws Exception {
        EnvironmentDto config = createConfig();
        final Optional<MachineConfigDto> devMachine = config.getMachineConfigs()
                                                            .stream()
                                                            .filter(MachineConfigDto::isDev)
                                                            .findAny();
        config.getMachineConfigs()
              .add(devMachine.get().withName("other-name"));


        environmentValidator.validate(config);
    }

