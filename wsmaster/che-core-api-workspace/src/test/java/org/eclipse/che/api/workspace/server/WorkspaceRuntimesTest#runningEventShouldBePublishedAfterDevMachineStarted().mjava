    @Test
    public void runningEventShouldBePublishedAfterDevMachineStarted() throws Exception {
        final WorkspaceImpl workspace = createWorkspace();
        runtimes = spy(new WorkspaceRuntimes(machineManager, eventService));
        doNothing().when(runtimes).publishEvent(any(), any(), any());

        doAnswer(invocation -> {
            final MachineConfig cfg = (MachineConfig)invocation.getArguments()[0];
            if (!cfg.isDev()) {
                verify(runtimes).publishEvent(EventType.RUNNING, workspace.getId(), null);
            }
            return createMachine(cfg);
        }).when(machineManager).createMachineSync(any(), any(), any(), any(LineConsumer.class));

        runtimes.start(workspace, workspace.getConfig().getDefaultEnv());
    }

