  @Test(expectedExceptions = {IllegalStateException.class})
  public void shouldThrowWhenStartingWorkspaceAsAnonymous() throws Exception {
    final String workspaceId = "myWorkspaceId";
    when(event.getEventType()).thenReturn(WorkspaceStatusEvent.EventType.STARTING);
    when(event.getWorkspaceId()).thenReturn(workspaceId);
    EnvironmentContext.getCurrent().setSubject(Subject.ANONYMOUS);
    workspaceSubjectRegistry.onEvent(event);
  }

