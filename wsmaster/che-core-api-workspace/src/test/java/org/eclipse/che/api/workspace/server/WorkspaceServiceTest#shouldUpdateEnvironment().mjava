  @Test
  public void shouldUpdateEnvironment() throws Exception {
    final WorkspaceImpl workspace = createWorkspace(createConfigDto());
    when(wsManager.getWorkspace(workspace.getId())).thenReturn(workspace);
    when(wsManager.updateWorkspace(any(), any())).thenReturn(workspace);
    final EnvironmentDto envDto = createEnvDto();

    final Response response =
        given()
            .auth()
            .basic(ADMIN_USER_NAME, ADMIN_USER_PASSWORD)
            .contentType("application/json")
            .body(envDto)
            .when()
            .put(
                SECURE_PATH
                    + "/workspace/"
                    + workspace.getId()
                    + "/environment/"
                    + workspace.getConfig().getDefaultEnv());

    assertEquals(response.getStatusCode(), 200);
    assertEquals(workspace.getConfig().getEnvironments().size(), 1);
    verify(wsManager).updateWorkspace(any(), any());
  }

