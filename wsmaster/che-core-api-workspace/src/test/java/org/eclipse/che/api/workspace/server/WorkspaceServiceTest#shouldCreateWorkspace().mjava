    @Test
    public void shouldCreateWorkspace() throws Exception {
        final WorkspaceConfigDto configDto = createConfigDto();
        final WorkspaceImpl workspace = createWorkspace(configDto);
        when(wsManager.createWorkspace(any(), any(), any(), any())).thenReturn(workspace);

        final Response response = given().auth()
                                         .basic(ADMIN_USER_NAME, ADMIN_USER_PASSWORD)
                                         .contentType("application/json")
                                         .body(configDto)
                                         .when()
                                         .post(SECURE_PATH + "/workspace" +
                                               "?attribute=stackId:stack123" +
                                               "&attribute=factoryId:factory123" +
                                               "&attribute=custom:custom:value");

        assertEquals(response.getStatusCode(), 201);
        assertEquals(new WorkspaceImpl(unwrapDto(response, WorkspaceDto.class)), workspace);
        verify(validator).validateConfig(any());
        verify(validator).validateAttributes(any());
        verify(wsManager).createWorkspace(anyObject(),
                                          anyString(),
                                          eq(ImmutableMap.of("stackId", "stack123",
                                                             "factoryId", "factory123",
                                                             "custom", "custom:value")),
                                          eq(null));
    }

