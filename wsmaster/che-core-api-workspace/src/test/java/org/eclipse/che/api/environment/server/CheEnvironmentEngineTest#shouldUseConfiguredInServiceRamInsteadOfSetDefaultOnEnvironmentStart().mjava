    @Test
    public void shouldUseConfiguredInServiceRamInsteadOfSetDefaultOnEnvironmentStart() throws Exception {
        // given
        EnvironmentImpl env = createEnv();
        String machineName = "machineWithoutRam";
        String additionalServiceComposeFilePart = "\n  " + machineName + ":\n    image: codenvy/ubuntu_jdk8\n    mem_limit: 42943433";
        env.getRecipe().setContent(env.getRecipe().getContent() + additionalServiceComposeFilePart);

        // when
        startEnv(env);

        // then
        ArgumentCaptor<CheServiceImpl> captor = ArgumentCaptor.forClass(CheServiceImpl.class);
        verify(machineProvider).startService(anyString(),
                                             anyString(),
                                             anyString(),
                                             eq(machineName),
                                             eq(false),
                                             anyString(),
                                             captor.capture(),
                                             any(LineConsumer.class));
        CheServiceImpl actualService = captor.getValue();
        assertEquals((long)actualService.getMemLimit(), 42943433L);
    }

