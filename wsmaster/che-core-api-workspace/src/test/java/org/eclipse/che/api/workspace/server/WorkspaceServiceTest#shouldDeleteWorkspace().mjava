    @Test
    public void shouldDeleteWorkspace() throws Exception {
        final WorkspaceImpl workspace = createWorkspace(createConfigDto());

        when(wsManager.getWorkspace(workspace.getId())).thenReturn(workspace);
        when(wsManager.getSnapshot(anyString())).thenReturn(ImmutableList.of(mock(SnapshotImpl.class)));

        final Response response = given().auth()
                                         .basic(ADMIN_USER_NAME, ADMIN_USER_PASSWORD)
                                         .when()
                                         .delete(SECURE_PATH + "/workspace/" + workspace.getId());

        assertEquals(response.getStatusCode(), 204);
        verify(machineManager).removeSnapshots(NAMESPACE, workspace.getId());
        verify(wsManager).removeWorkspace(workspace.getId());
    }

