    @Test(expectedExceptions = IllegalArgumentException.class,
          expectedExceptionsMessageRegExp = "Dependency 'fifth' in machine 'second' points to not known machine.")
    public void shouldFailIfLinksFieldContainsNonExistingService() throws Exception {
        // given
        CheServicesEnvironmentImpl composeEnvironment = new CheServicesEnvironmentImpl();
        composeEnvironment.getServices().put("second", new CheServiceImpl().withLinks(singletonList("fifth")));
        composeEnvironment.getServices().put("third", new CheServiceImpl());
        composeEnvironment.getServices().put("first", new CheServiceImpl());

        // when
        strategy.order(composeEnvironment);
    }

