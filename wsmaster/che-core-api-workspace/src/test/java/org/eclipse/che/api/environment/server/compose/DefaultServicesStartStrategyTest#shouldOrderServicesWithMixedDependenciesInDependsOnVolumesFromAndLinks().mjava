  @Test
  public void shouldOrderServicesWithMixedDependenciesInDependsOnVolumesFromAndLinks()
      throws Exception {
    // given
    CheServicesEnvironmentImpl composeEnvironment = new CheServicesEnvironmentImpl();
    composeEnvironment
        .getServices()
        .put("second", new CheServiceImpl().withDependsOn(singletonList("first")));
    composeEnvironment
        .getServices()
        .put("third", new CheServiceImpl().withVolumesFrom(asList("first", "second")));
    composeEnvironment.getServices().put("first", new CheServiceImpl().withLinks(emptyList()));
    composeEnvironment
        .getServices()
        .put("forth", new CheServiceImpl().withLinks(singletonList("third")));
    composeEnvironment
        .getServices()
        .put("fifth", new CheServiceImpl().withDependsOn(asList("forth", "first")));
    List<String> expected = asList("first", "second", "third", "forth", "fifth");

    // when
    List<String> actual = strategy.order(composeEnvironment);

    // then
    assertEquals(actual, expected);
  }

