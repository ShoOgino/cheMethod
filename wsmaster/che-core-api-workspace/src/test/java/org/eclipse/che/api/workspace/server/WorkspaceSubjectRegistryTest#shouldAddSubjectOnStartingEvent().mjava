  @Test
  public void shouldAddSubjectOnStartingEvent() throws Exception {
    final String workspaceId = "myWorkspaceId";
    when(event.getEventType()).thenReturn(WorkspaceStatusEvent.EventType.STARTING);
    when(event.getWorkspaceId()).thenReturn(workspaceId);
    Subject workspaceStarter = new SubjectImpl("userName", "userId", "userToken", false);
    EnvironmentContext.getCurrent().setSubject(workspaceStarter);
    workspaceSubjectRegistry.onEvent(event);
    assertTrue(workspaceSubjectRegistry.getWorkspaceStarter(workspaceId) == workspaceStarter);
  }

