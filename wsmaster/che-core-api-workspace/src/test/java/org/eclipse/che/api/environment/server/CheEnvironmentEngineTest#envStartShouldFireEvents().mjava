    @Test
    public void envStartShouldFireEvents() throws Exception {
        // when
        List<Instance> instances = startEnv();
        assertTrue(instances.size() > 1, "This test requires at least 2 instances in environment");

        // then
        for (Instance instance : instances) {
            verify(eventService).publish(newDto(MachineStatusEvent.class)
                                                 .withEventType(MachineStatusEvent.EventType.CREATING)
                                                 .withDev(instance.getConfig().isDev())
                                                 .withMachineName(instance.getConfig().getName())
                                                 .withMachineId(instance.getId())
                                                 .withWorkspaceId(instance.getWorkspaceId()));
            verify(eventService).publish(newDto(MachineStatusEvent.class)
                                                 .withEventType(MachineStatusEvent.EventType.RUNNING)
                                                 .withDev(instance.getConfig().isDev())
                                                 .withMachineName(instance.getConfig().getName())
                                                 .withMachineId(instance.getId())
                                                 .withWorkspaceId(instance.getWorkspaceId()));
        }
    }

