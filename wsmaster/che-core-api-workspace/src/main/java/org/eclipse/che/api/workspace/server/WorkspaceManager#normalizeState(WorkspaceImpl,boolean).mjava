    private WorkspaceImpl normalizeState(WorkspaceImpl workspace, boolean includeRuntimes) throws ServerException {
        WorkspaceStatus status = states.get(workspace.getId());
        if (status != null) {
            if(status.equals(WorkspaceStatus.RUNNING) && includeRuntimes) {
                try {
                    workspace.setRuntime(runtimes.get(workspace.getId()));
                } catch (NotFoundException e) {
                    LOG.error("Workspace " + workspace.getId() + " has RUNNING state but no runtime!");
                }
            }
            workspace.setStatus(status);
        } else {
            workspace.setStatus(WorkspaceStatus.STOPPED);
        }

        return workspace;
    }

