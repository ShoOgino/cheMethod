  @Override
  public void check(String user, String domain, String instance) throws ForbiddenException {
    if (!"*".equals(user)
        || !EnvironmentContext.getCurrent()
            .getSubject()
            .hasPermission(DOMAIN_ID, null, MANAGE_SYSTEM_ACTION)) {
      defaultChecker.check(user, domain, instance);
      return;
    }
    final Set<String> actions = new HashSet<>();
    try {
      actions.addAll(permissionsManager.get(user, domain, instance).getActions());
    } catch (ApiException ignored) {
    }

    // perform default check if no search action found or its not admin user
    if (!actions.contains(StackDomain.SEARCH) && !actions.contains(RecipeDomain.SEARCH)) {
      defaultChecker.check(user, domain, instance);
    }
  }

