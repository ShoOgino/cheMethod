    /** Removes machine from the workspace runtime. */
    @VisibleForTesting
    void removeMachine(String machineId, String machineName, String workspaceId) {
        acquireWriteLock(workspaceId);
        try {
            final RuntimeDescriptor descriptor = descriptors.get(workspaceId);

            // Machine can be removed only from existing runtime with 'RUNNING' status
            if (descriptor == null || descriptor.getRuntimeStatus() != WorkspaceStatus.RUNNING) {
                return;
            }

            // Try to remove non-dev machine from the runtime machines list
            // It is unusual but still possible to get the state when such machine
            // doesn't exist, in this case an appropriate warning will be logged
            if (!descriptor.getRuntime()
                           .getMachines()
                           .removeIf(m -> m.getConfig().getName().equals(machineName))) {
                LOG.warn("An attempt to remove the machine '{}' from the workspace runtime '{}' failed. " +
                         "Workspace doesn't contain machine with name '{}'",
                         machineId,
                         workspaceId,
                         machineName);
            }
        } finally {
            releaseWriteLock(workspaceId);
        }
    }

