  public EnvironmentImpl(
      EnvironmentRecipe recipe, Map<String, ? extends ExtendedMachine> machines) {
    if (recipe != null) {
      this.recipe = new EnvironmentRecipeImpl(recipe);
    }
    if (machines != null) {
      this.machines =
          machines
              .entrySet()
              .stream()
              .collect(
                  Collectors.toMap(
                      Map.Entry::getKey, entry -> new ExtendedMachineImpl(entry.getValue())));
    }
  }

