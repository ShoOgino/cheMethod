  private Collection<ChePlugin> getPlugins(Collection<CheFeature> features)
      throws InfrastructureException {
    Map<String, ChePlugin> plugins = new HashMap<>();
    for (CheFeature feature : features) {
      for (ChePluginReference pluginReference : feature.getSpec().getServices()) {
        String pluginName = pluginReference.getName();
        String pluginVersion = pluginReference.getVersion();
        String key = pluginName + '/' + pluginVersion;
        if (!plugins.containsKey(key)) {
          ChePlugin plugin = getPlugin(pluginName, pluginVersion);
          plugins.put(key, plugin);
        }
      }
    }
    return plugins.values();
  }

