    @Override
    public Map<String, ? extends Machine> getMachines() {

        if(cachedExternalMachines == null) {
            cachedExternalMachines = new HashMap<>();
            for(Map.Entry<String, ? extends Machine> entry : getInternalMachines().entrySet()) {
                String key = entry.getKey();
                Machine machine = entry.getValue();
                Map<String, Server> newServers = rewriteExternalServers(machine.getServers());
                MachineImpl newMachine = new MachineImpl(machine.getProperties(), newServers);
                cachedExternalMachines.put(key, newMachine);
            }

        }
        return cachedExternalMachines;

    }

