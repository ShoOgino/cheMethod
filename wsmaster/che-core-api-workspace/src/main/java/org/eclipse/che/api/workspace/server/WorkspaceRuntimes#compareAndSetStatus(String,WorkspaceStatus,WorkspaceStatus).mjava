    /**
     * Safely compares current status of given workspace
     * with {@code from} and if they are equal sets the status to {@code to}.
     * Returns true if the status of workspace was updated with {@code to} value.
     */
    private boolean compareAndSetStatus(String id, WorkspaceStatus from, WorkspaceStatus to) {
        try (@SuppressWarnings("unused") CloseableLock l = locks.acquireWriteLock(id)) {
            WorkspaceState state = workspaces.get(id);
            if (state != null && state.getStatus() == from) {
                state.status = to;
                return true;
            }
        }
        return false;
    }

