    public final Result rewrite(RuntimeIdentity identity, Map<String, ? extends Server> incoming) {

        Map <String, Server> outgoing = new HashMap<>();
        List<Warning> warnings = new ArrayList<>();

        for(Map.Entry<String, ? extends Server> entry : incoming.entrySet()) {
            String name = entry.getKey();
            String strUrl = entry.getValue().getUrl();
            try {
                URL url = new URL(strUrl);
                ServerImpl server = new ServerImpl(rewriteURL(identity, name, url).toString());
                outgoing.put(name, server);
            } catch (MalformedURLException e) {
                warnings.add(new Warning() {
                    @Override
                    public int getCode() {
                        return 101;
                    }

                    @Override
                    public String getMessage() {
                        return "Malformed URL for " + name + " : " + e.getMessage();
                    }
                });
            }

        }

        return new Result(outgoing, warnings);

    }

