    /**
     * Synchronously creates snapshot of the workspace.
     *
     * @return true if snapshot of dev-machine was successfully created
     * otherwise returns false.
     */
    @VisibleForTesting
    boolean createSnapshotSync(WorkspaceRuntimeImpl runtime, String namespace, String workspaceId) {
        eventService.publish(newDto(WorkspaceStatusEvent.class)
                                     .withEventType(SNAPSHOT_CREATING)
                                     .withWorkspaceId(workspaceId));
        String devMachineSnapshotFailMessage = null;
        for (MachineImpl machine : runtime.getMachines()) {
            String error = replaceSnapshot(machine, namespace);
            if (error != null && machine.getConfig().isDev()) {
                devMachineSnapshotFailMessage = error;
            }
        }
        if (devMachineSnapshotFailMessage != null) {
            eventService.publish(newDto(WorkspaceStatusEvent.class)
                                         .withEventType(SNAPSHOT_CREATION_ERROR)
                                         .withWorkspaceId(workspaceId)
                                         .withError(devMachineSnapshotFailMessage));
        } else {
            eventService.publish(newDto(WorkspaceStatusEvent.class)
                                         .withEventType(SNAPSHOT_CREATED)
                                         .withWorkspaceId(workspaceId));
        }
        return devMachineSnapshotFailMessage == null;
    }

