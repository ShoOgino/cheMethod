  private void initInstallers(List<String> installersKeys, InstallerRegistry installerRegistry)
      throws InfrastructureException {
    try {
      List<Installer> sortedInstallers = installerRegistry.getOrderedInstallers(installersKeys);
      for (Installer installer : sortedInstallers) {
        this.installers.add(new InstallerImpl(installer));
        for (Map.Entry<String, ? extends ServerConfig> serverEntry :
            installer.getServers().entrySet()) {
          if (servers.putIfAbsent(serverEntry.getKey(), serverEntry.getValue()) != null
              && servers.get(serverEntry.getKey()).equals(serverEntry.getValue())) {
            throw new InfrastructureException(
                format(
                    "Installer '%s' contains server '%s' conflicting with machine configuration",
                    installer.getId(), serverEntry.getKey()));
          }
        }
      }
    } catch (InstallerException e) {
      // TODO installers has circular dependency or missing, what should we throw in that case?
      throw new InfrastructureException(e.getLocalizedMessage(), e);
    }
  }

