  private void applyInstaller(Installer installer) throws InfrastructureException {
    this.installers.add(new InstallerImpl(installer));
    for (Map.Entry<String, ? extends ServerConfig> serverEntry :
        installer.getServers().entrySet()) {
      if (servers.putIfAbsent(serverEntry.getKey(), serverEntry.getValue()) != null
          && !servers.get(serverEntry.getKey()).equals(serverEntry.getValue())) {
        throw new InfrastructureException(
            format(
                "Installer '%s' contains server '%s' conflicting with machine configuration",
                installer.getId(), serverEntry.getKey()));
      }
    }
    addEnvVars(installer);
  }

