  private void checkDependency(
      String dependency,
      String serviceName,
      Map<String, CheServiceImpl> services,
      String errorMessage) {
    if (serviceName.equals(dependency)) {
      throw new IllegalArgumentException(errorMessage + ": " + serviceName);
    }
    if (!services.containsKey(dependency)) {
      throw new IllegalArgumentException(
          format(
              "Dependency '%s' in machine '%s' points to unknown machine.",
              dependency, serviceName));
    }
  }

