        @Override
        public WorkspaceRuntimeImpl call() throws Exception {
            if (!markAsUsed()) {
                throw new CancellationException(format("Start of the workspace '%s' was cancelled", workspaceId));
            }
            allowStartLatch.await();
            try {
                startEnvironmentAndPublishEvents(environment, workspaceId, envName, recover);
                WorkspaceRuntimeImpl runtime = getRuntime(workspaceId);
                cmpFuture.complete(runtime);
                return runtime;
            } catch (IllegalStateException illegalStateEx) {
                if (isShutdown.get()) {
                    exception = new EnvironmentStartInterruptedException(workspaceId, envName);
                } else {
                    exception = new ServerException(illegalStateEx.getMessage(), illegalStateEx);
                }
                cmpFuture.completeExceptionally(exception);
                throw exception;
            } catch (Exception occurred) {
                cmpFuture.completeExceptionally(exception = occurred);
                throw occurred;
            } finally {
                completionLatch.countDown();
            }
        }

