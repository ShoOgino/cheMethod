  /**
   * Get {@link WorkspaceProbes} for a whole workspace runtime
   *
   * @throws InfrastructureException when the operation fails
   */
  public WorkspaceProbes getProbes(String workspaceId, Runtime runtime)
      throws InfrastructureException {
    List<ProbeFactory> factories = new ArrayList<>();
    try {
      for (Entry<String, ? extends Machine> entry : runtime.getMachines().entrySet()) {
        fillProbes(workspaceId, entry.getKey(), factories, entry.getValue().getServers());
      }
    } catch (MalformedURLException e) {
      throw new InternalInfrastructureException(
          "Server liveness probes creation failed. Error: " + e.getMessage());
    }

    return new WorkspaceProbes(workspaceId, factories);
  }

