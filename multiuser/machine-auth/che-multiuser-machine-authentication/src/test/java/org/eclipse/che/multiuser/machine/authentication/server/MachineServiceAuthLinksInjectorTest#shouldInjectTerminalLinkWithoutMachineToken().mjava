  @Test
  public void shouldInjectTerminalLinkWithoutMachineToken() throws Exception {
    when(requestMock.request()).thenThrow(new IOException("ioEx"));
    final MachineDto machineDto =
        DtoFactory.newDto(MachineDto.class)
            .withId("id")
            .withWorkspaceId("wsId")
            .withRuntime(machineRuntimeInfoDtoMock);
    final List<Link> links = new ArrayList<>();
    machineLinksInjector.injectTerminalLink(machineDto, serviceContextMock, links);

    final Link resultTerminalLink = links.get(0);
    assertEquals(1, links.size());
    assertEquals(resultTerminalLink.getRel(), TERMINAL_REFERENCE);
  }

