  @Test
  public void testLoadSignatureKeys() throws Exception {
    final SignatureKeyPairImpl kp = newKeyPair("id_" + 1);
    when(signatureKeyDao.getAll(anyInt(), anyLong()))
        .thenReturn(new Page<>(singleton(kp), 0, 1, 1));

    signatureKeyManager.loadKeyPair();

    final KeyPair cachedPair = signatureKeyManager.getKeyPair();
    assertNotNull(cachedPair);
    assertKeys(cachedPair.getPublic(), kp.getPublicKey());
    assertKeys(cachedPair.getPrivate(), kp.getPrivateKey());
  }

