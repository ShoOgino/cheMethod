  @Test
  public void testGeneratesNewKeyPairWhenNoExistingKeyPairFound() throws Exception {
    doThrow(NotFoundException.class).when(signatureKeyDao).get(anyString());
    when(signatureKeyDao.create(any(SignatureKeyPairImpl.class)))
        .thenAnswer((Answer<SignatureKeyPairImpl>) invoke -> invoke.getArgument(0));

    final KeyPair cachedPair = signatureKeyManager.getKeyPair("ws1");

    verify(signatureKeyDao).get(anyString());
    verify(signatureKeyDao).create(any(SignatureKeyPairImpl.class));
    assertNotNull(cachedPair);
  }

