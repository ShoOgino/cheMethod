  @Test
  public void testGeneratesNewKeyPairWhenNoExistingKeyPairFound() throws Exception {
    doReturn(new Page<>(emptyList(), 0, 1, 0)).when(signatureKeyDao).getAll(anyInt(), anyLong());
    when(signatureKeyDao.create(any(SignatureKeyPairImpl.class)))
        .thenAnswer((Answer<SignatureKeyPairImpl>) invoke -> invoke.getArgument(0));

    final KeyPair cachedPair = signatureKeyManager.getKeyPair();

    verify(signatureKeyDao).getAll(anyInt(), anyLong());
    verify(signatureKeyDao).create(any(SignatureKeyPairImpl.class));
    assertNotNull(cachedPair);
  }

