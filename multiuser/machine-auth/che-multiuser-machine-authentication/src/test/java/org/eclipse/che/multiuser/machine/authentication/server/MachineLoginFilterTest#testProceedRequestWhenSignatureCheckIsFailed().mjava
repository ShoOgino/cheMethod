  @Test
  public void testProceedRequestWhenSignatureCheckIsFailed() throws Exception {
    final String tokenWithInvalidSignature = "keycloak_token";
    final HttpServletRequest requestMock = getRequestMock();
    when(tokenExtractorMock.getToken(any(HttpServletRequest.class)))
        .thenReturn(tokenWithInvalidSignature);

    machineLoginFilter.doFilter(requestMock, responseMock, chainMock);

    verify(tokenExtractorMock).getToken(any(HttpServletRequest.class));
    verify(keyManagerMock).getKeyPair();
    verify(chainMock).doFilter(requestMock, responseMock);
    verifyZeroInteractions(userManagerMock);
    verifyZeroInteractions(responseMock);
  }

