  @Override
  public Object invoke(MethodInvocation invocation) throws Throwable {
    final Object result = invocation.proceed();

    if (result instanceof Workspace) {
      final Workspace workspace = ((Workspace) result);
      // generate machine token for user who start the workspace
      tokenRegistry.generateToken(
          EnvironmentContext.getCurrent().getSubject().getUserId(), workspace.getId());
    }
    return result;
  }

