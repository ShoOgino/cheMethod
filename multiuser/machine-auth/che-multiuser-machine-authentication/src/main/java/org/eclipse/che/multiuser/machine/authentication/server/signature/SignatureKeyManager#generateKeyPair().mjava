  @VisibleForTesting
  SignatureKeyPairImpl generateKeyPair() throws ServerException {
    final KeyPairGenerator kpg;
    try {
      kpg = KeyPairGenerator.getInstance(algorithm);
    } catch (NoSuchAlgorithmException ex) {
      throw new ServerException(ex.getMessage(), ex);
    }
    kpg.initialize(keySize);
    final KeyPair pair = kpg.generateKeyPair();
    final SignatureKeyPairImpl kp =
        new SignatureKeyPairImpl(generate("signatureKey", 16), pair.getPublic(), pair.getPrivate());
    LOG.info("Generated signature key pair with id {} and algorithm {}.", kp.getId(), algorithm);
    return kp;
  }

