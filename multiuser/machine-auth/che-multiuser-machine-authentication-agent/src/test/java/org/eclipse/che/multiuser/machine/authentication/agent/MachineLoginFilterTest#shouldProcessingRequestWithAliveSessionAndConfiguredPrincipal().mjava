  @Test
  public void shouldProcessingRequestWithAliveSessionAndConfiguredPrincipal() throws Exception {
    // mocking of session principal
    final Subject subject = new SubjectImpl(USERNAME, USER_ID, MACHINE_TOKEN, false);
    when(sessionMock.getAttribute("principal")).thenReturn(subject);
    final HttpServletRequest requestMock = getRequestMock(sessionMock, MACHINE_TOKEN);
    machineLoginFilter.doFilter(requestMock, servletResponseMock, chainMock);

    verify(chainMock).doFilter(requestMock, servletResponseMock);
  }

