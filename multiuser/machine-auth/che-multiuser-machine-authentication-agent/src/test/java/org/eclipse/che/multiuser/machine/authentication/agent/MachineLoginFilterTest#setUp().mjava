  @BeforeMethod
  public void setUp() throws Exception {
    final KeyPairGenerator kpg = KeyPairGenerator.getInstance(SIGNATURE_ALGORITHM);
    kpg.initialize(KEY_SIZE);
    keyPair = kpg.generateKeyPair();
    machineToken =
        Jwts.builder()
            .setClaims(CLAIMS)
            .setHeader(HEADER)
            .signWith(RS512, keyPair.getPrivate())
            .compact();
    machineLoginFilter =
        spy(new MachineLoginFilter(WORKSPACE_ID, keyPair.getPublic(), tokenExtractorMock));

    subject = new SubjectImpl(USER_NAME, USER_ID, machineToken, false);
    when(tokenExtractorMock.getToken(any(HttpServletRequest.class))).thenReturn(machineToken);
  }

