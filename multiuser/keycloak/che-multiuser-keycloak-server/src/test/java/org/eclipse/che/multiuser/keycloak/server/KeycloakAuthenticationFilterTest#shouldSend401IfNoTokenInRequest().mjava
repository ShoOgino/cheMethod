  @Test
  public void shouldSend401IfNoTokenInRequest() throws Exception {
    when(tokenExtractor.getToken(any(HttpServletRequest.class))).thenReturn(null);

    authenticationFilter.doFilter(request, response, chain);

    verify(response).setStatus(401);
    verify(servletOutputStream).write(eq("Authorization token is missed".getBytes()));
    verifyNoMoreInteractions(chain);
  }

