  /** when a request came from a machine with valid token then auth is not required */
  boolean shouldSkipAuthentication(HttpServletRequest request, String token) {
    if (token == null) {
      return request.getRequestURI() != null
          && request.getRequestURI().endsWith("api/keycloak/OIDCKeycloak.js");
    }
    try {
      jwtParser.parse(token);
      return false;
    } catch (MachineTokenJwtException e) {
      return true;
    }
  }

