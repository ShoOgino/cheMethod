  private synchronized PublicKey getJwtPublicKey(JwsHeader<?> header) throws JwkException {
    String kid = header.getKeyId();
    if (kid == null) {
      LOG.warn(
          "'kid' is missing in the JWT token header. This is not possible to validate the token with OIDC provider keys");
      return null;
    }
    String alg = header.getAlgorithm();
    if (alg == null) {
      LOG.warn(
          "'alg' is missing in the JWT token header. This is not possible to validate the token with OIDC provider keys");
      return null;
    }

    if (jwkProvider == null) {
      LOG.warn(
          "JWK provider is not available: This is not possible to validate the token with OIDC provider keys.\n"
              + "Please look into the startup logs to find out the root cause");
      return null;
    }
    Jwk jwk = jwkProvider.get(kid);
    return jwk.getPublicKey();
  }

