  @Test
  public void shouldCalculateRamOfEnvironmentWithMultipleMachines() throws Exception {
    Map<String, CheServiceImpl> services = new HashMap<>();
    services.put(
        "service1", new CheServiceImpl().withMemLimit(1024 * MEGABYTES_TO_BYTES_MULTIPLIER));
    services.put(
        "service2", new CheServiceImpl().withMemLimit(512 * MEGABYTES_TO_BYTES_MULTIPLIER));

    when(environmentParser.parse(anyObject()))
        .thenReturn(new CheServicesEnvironmentImpl().withServices(services));

    long ram = environmentRamCalculator.calculate(environment);

    assertEquals(ram, 1536L);
  }

