  @Override
  protected void filter(GenericResourceMethod genericMethodResource, Object[] arguments)
      throws ApiException {
    String accountId;
    switch (genericMethodResource.getMethod().getName()) {
      case GET_LICENSE_METHOD:
        accountId = ((String) arguments[0]);
        break;

      default:
        throw new ForbiddenException("The user does not have permission to perform this operation");
    }

    final Account account = accountManager.getById(accountId);
    final AccountPermissionsChecker permissionsChecker = permissionsCheckers.get(account.getType());
    if (permissionsChecker != null) {
      permissionsChecker.checkPermissions(accountId, AccountOperation.SEE_RESOURCE_INFORMATION);
    } else {
      throw new ForbiddenException("User is not authorized to perform given operation");
    }
  }

