  @Test
  public void shouldReturnForbiddenWhenUserIsNotCreatorOnUpdatingFactory() throws Exception {
    doReturn("user321").when(subject).getUserId();

    Factory factory = mock(Factory.class);
    doReturn(new AuthorImpl("user123", 12345L)).when(factory).getCreator();
    when(factoryManager.getById("factory123")).thenReturn(factory);

    final Response response =
        given()
            .auth()
            .basic(ADMIN_USER_NAME, ADMIN_USER_PASSWORD)
            .contentType("application/json")
            .body(DtoFactory.newDto(FactoryDto.class))
            .when()
            .put(SECURE_PATH + "/factory/factory123");

    assertEquals(response.getStatusCode(), 403);
    verify(service, never()).updateFactory(any(), any());
  }

