  @Test(
    expectedExceptions = ForbiddenException.class,
    expectedExceptionsMessageRegExp = "Following actions are not supported for setting as public:.*"
  )
  public void throwsForbiddenExceptionWhenSetPublicPermissionsWithUnsupportedActionByNonAdminUser()
      throws Exception {
    final Permissions permissions =
        new RecipePermissionsImpl("*", "recipe99", singletonList(DELETE));
    when(subj.hasPermission(DOMAIN_ID, null, MANAGE_SYSTEM_ACTION)).thenReturn(false);
    doNothing().when(defaultChecker).check(permissions);

    recipeSetPermChecker.check(permissions);

    verify(subj, times(1)).hasPermission(DOMAIN_ID, null, MANAGE_SYSTEM_ACTION);
    verify(defaultChecker, times(1)).check(permissions);
  }

