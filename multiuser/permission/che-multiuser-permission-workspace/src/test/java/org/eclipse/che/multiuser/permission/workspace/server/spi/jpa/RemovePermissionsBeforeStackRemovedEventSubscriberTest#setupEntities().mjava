  @BeforeClass
  public void setupEntities() throws Exception {
    stack = StackImpl.builder().setId("stack123").setName("defaultStack").build();
    users = new UserImpl[3];
    for (int i = 0; i < 3; i++) {
      users[i] = new UserImpl("user" + i, "user" + i + "@test.com", "username" + i);
    }
    stackPermissions = new StackPermissionsImpl[3];
    for (int i = 0; i < 3; i++) {
      stackPermissions[i] =
          new StackPermissionsImpl(users[i].getId(), stack.getId(), asList("read", "update"));
    }

    Injector injector = Guice.createInjector(new JpaTckModule());

    manager = injector.getInstance(EntityManager.class);
    stackDao = injector.getInstance(JpaStackDao.class);
    stackPermissionsDao = injector.getInstance(JpaStackPermissionsDao.class);

    subscriber = injector.getInstance(RemovePermissionsBeforeStackRemovedEventSubscriber.class);
    subscriber.subscribe();
  }

