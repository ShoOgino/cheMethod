  @Test(
      expectedExceptions = ForbiddenException.class,
      expectedExceptionsMessageRegExp =
          "Following actions are not supported for setting as public:.*")
  public void throwsForbiddenExceptionWhenSetPublicPermissionsWithUnsupportedActionByAdmin()
      throws Exception {
    final Permissions permissions =
        new StackPermissionsImpl("*", "stack73", ImmutableList.of(SEARCH, DELETE));
    when(subj.hasPermission(SystemDomain.DOMAIN_ID, null, MANAGE_SYSTEM_ACTION)).thenReturn(true);

    stackSetPermChecker.check(permissions);

    verify(subj).hasPermission(SystemDomain.DOMAIN_ID, null, MANAGE_SYSTEM_ACTION);
    verify(defaultChecker, never()).check(permissions);
  }

