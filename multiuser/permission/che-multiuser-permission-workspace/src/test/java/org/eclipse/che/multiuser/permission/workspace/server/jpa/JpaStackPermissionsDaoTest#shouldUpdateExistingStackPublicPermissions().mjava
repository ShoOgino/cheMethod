  @Test
  public void shouldUpdateExistingStackPublicPermissions() throws Exception {
    final StackPermissionsImpl publicPermission =
        new StackPermissionsImpl("*", "stack1", asList("read", "use", "run"));
    dao.store(publicPermission);
    dao.store(publicPermission);

    final Page<StackPermissionsImpl> permissions =
        dao.getByInstance(publicPermission.getInstanceId(), 30, 0);
    assertTrue(permissions.getItems().contains(new StackPermissionsImpl(publicPermission)));
    assertTrue(permissions.getItems().stream().filter(p -> "*".equals(p.getUserId())).count() == 1);
  }

