  @Test(dataProvider = "coveredPaths")
  public void shouldAllowToAdminPerformAnyActionWithPredefinedStack(
      String path, String method, String action) throws Exception {
    doReturn(false)
        .when(subject)
        .hasPermission(eq(DOMAIN_ID), nullable(String.class), nullable(String.class));
    doReturn(true)
        .when(subject)
        .hasPermission(eq(SystemDomain.DOMAIN_ID), nullable(String.class), nullable(String.class));
    doReturn(true).when(permissionsFilter).isStackPredefined(nullable(String.class));

    Response response =
        request(
            given().auth().basic(ADMIN_USER_NAME, ADMIN_USER_PASSWORD).when(),
            SECURE_PATH + path,
            method);

    assertEquals(response.getStatusCode() / 100, 2);
    verify(subject).hasPermission(eq(SystemDomain.DOMAIN_ID), eq(null), eq(MANAGE_SYSTEM_ACTION));
  }

