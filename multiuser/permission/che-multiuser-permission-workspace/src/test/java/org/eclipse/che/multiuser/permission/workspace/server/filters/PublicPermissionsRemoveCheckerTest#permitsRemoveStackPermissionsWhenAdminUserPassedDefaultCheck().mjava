  @Test
  public void permitsRemoveStackPermissionsWhenAdminUserPassedDefaultCheck() throws Exception {
    when(manager.get("*", StackDomain.DOMAIN_ID, INSTANCE))
        .thenReturn(new StackPermissionsImpl("*", INSTANCE, singletonList(StackDomain.SEARCH)));
    when(subj.hasPermission(SystemDomain.DOMAIN_ID, null, MANAGE_SYSTEM_ACTION)).thenReturn(true);

    publicPermissionsRemoveChecker.check("*", StackDomain.DOMAIN_ID, INSTANCE);

    verify(manager, times(1)).get("*", StackDomain.DOMAIN_ID, INSTANCE);
    verify(subj, times(1)).hasPermission(SystemDomain.DOMAIN_ID, null, MANAGE_SYSTEM_ACTION);
    verify(defaultChecker, never()).check("*", StackDomain.DOMAIN_ID, INSTANCE);
  }

