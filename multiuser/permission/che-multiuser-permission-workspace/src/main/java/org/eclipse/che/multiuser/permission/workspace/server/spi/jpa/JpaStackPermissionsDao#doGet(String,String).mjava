  @Transactional
  protected StackPermissionsImpl doGet(String userId, String instanceId) {
    if (userId == null) {
      return managerProvider
          .get()
          .createNamedQuery("StackPermissions.getByStackIdPublic", StackPermissionsImpl.class)
          .setParameter("stackId", instanceId)
          .getSingleResult();
    } else {
      return managerProvider
          .get()
          .createNamedQuery("StackPermissions.getByUserAndStackId", StackPermissionsImpl.class)
          .setParameter("stackId", instanceId)
          .setParameter("userId", userId)
          .getSingleResult();
    }
  }

