  @Test
  public void shouldUpdateExistingRecipePublicPermissions() throws Exception {
    final RecipePermissionsImpl publicPermission =
        new RecipePermissionsImpl("*", "recipe1", asList("read", "use", "run"));
    dao.store(publicPermission);
    dao.store(publicPermission);

    final List<RecipePermissionsImpl> storedPermissions =
        dao.getByInstance(publicPermission.getInstanceId(), 30, 0).getItems();
    assertTrue(storedPermissions.contains(new RecipePermissionsImpl(publicPermission)));
    assertTrue(storedPermissions.stream().filter(p -> "*".equals(p.getUserId())).count() == 1);
  }

