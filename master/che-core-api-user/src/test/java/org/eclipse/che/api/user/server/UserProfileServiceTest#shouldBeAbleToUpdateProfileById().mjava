    @Test
    public void shouldBeAbleToUpdateProfileById() throws Exception {
        final Profile profile = new Profile().withId(testUser.getId())
                                             .withUserId(testUser.getId())
                                             .withAttributes(new HashMap<>(singletonMap("existed", "old")));
        when(profileDao.getById(testUser.getId())).thenReturn(profile);
        final Map<String, String> attributes = new HashMap<>(4);
        attributes.put("existed", "new");
        attributes.put("new", "value");

        final ContainerResponse response = makeRequest(HttpMethod.POST, SERVICE_PATH + "/" + profile.getId(), attributes);

        assertEquals(response.getStatus(), OK.getStatusCode());
        assertEquals(((ProfileDescriptor)response.getEntity()).getAttributes(), attributes);
        verify(profileDao, times(1)).update(profile);
    }

