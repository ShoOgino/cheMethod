    @Test
    public void foreignStackShouldNotBeReturnedIfUserHasNotPermission() throws ServerException, NotFoundException {
        when(stackDao.getById(anyString())).thenReturn(foreignStack);
        when(checker.hasAccess(any(StackImpl.class), eq(USER_ID), eq("read"))).thenReturn(false);

        Response response = given().auth()
                                   .basic(ADMIN_USER_NAME, ADMIN_USER_PASSWORD)
                                   .when()
                                   .get(SECURE_PATH + "/stack/" + STACK_ID);

        assertEquals(response.getStatusCode(), 403);
        String expectedMessage = format("User '%s' doesn't has access to stack '%s'", USER_ID, stackImpl.getId());
        assertEquals(unwrapDto(response, ServiceError.class).getMessage(), expectedMessage);
    }

