    @Test
    public void shouldRespondInternalServerErrorIfNoDevMachineFoundForWorkspace() throws Exception {
        when(machineManager.getDevMachine(WORKSPACE_ID))
                .thenThrow(new NotFoundException("No running dev machine found in workspace " + WORKSPACE_ID));

        MockHttpServletRequest mockRequest =
                new MockHttpServletRequest(DEFAULT_URL,
                                           new ByteArrayInputStream(new byte[0]),
                                           0,
                                           "GET",
                                           defaultHeaders);

        MockHttpServletResponse mockResponse = new MockHttpServletResponse();

        proxyServlet.service(mockRequest, mockResponse);

        assertEquals(mockResponse.getStatus(), SC_SERVICE_UNAVAILABLE, mockResponse.getOutputContent());
    }

