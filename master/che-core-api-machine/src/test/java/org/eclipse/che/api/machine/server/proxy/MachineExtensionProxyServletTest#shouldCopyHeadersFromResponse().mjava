    @Test
    public void shouldCopyHeadersFromResponse() throws Exception {
        Map<String, List<String>> headers = new HashMap<>();
        headers.put("Accept-Ranges", Collections.singletonList("bytes"));
        headers.put("Allow", Collections.singletonList("GET, HEAD, PUT"));
        headers.put("ETag", Collections.singletonList("xyzzy"));
        headers.put("Expires", Collections.singletonList("Thu, 01 Dec 2020 16:00:00 GMT"));
        headers.put("Last-Modified", Collections.singletonList("Tue, 15 Nov 1994 12:45:26 GMT"));
        headers.put("Retry-After", Collections.singletonList("120"));

        when(extensionApiResponse.getHeaders()).thenReturn(headers);

        MockHttpServletRequest mockRequest =
                new MockHttpServletRequest(DEFAULT_URL,
                                           new ByteArrayInputStream(new byte[0]),
                                           0,
                                           "POST",
                                           defaultHeaders);

        MockHttpServletResponse mockResponse = new MockHttpServletResponse();

        proxyServlet.service(mockRequest, mockResponse);

        assertEquals(mockResponse.getStatus(), 200);

        final Map<String, List<String>> actualHeaders = getHeaders(mockResponse);
        actualHeaders.remove("content-length");
        actualHeaders.remove("server");
        actualHeaders.remove("date");

        assertEqualsHeaders(actualHeaders, headers);
    }

