    private void setHeaders(HttpURLConnection conn, HttpServletRequest request) {
        // copy headers from request
        final Enumeration<String> headerNames = request.getHeaderNames();
        while (headerNames.hasMoreElements()) {
            final String headerName = headerNames.nextElement();

            if (!skipHeader(headerName)) {
                final Enumeration<String> headerValues = request.getHeaders(headerName);
                while (headerValues.hasMoreElements()) {
                    conn.setRequestProperty(headerName, headerValues.nextElement());
                }
            }
        }

        // add forwarded host header. See http://tools.ietf.org/html/rfc7239#section-5.3
        conn.setRequestProperty("X-Forwarded-Host", request.getHeader("Host"));
    }

